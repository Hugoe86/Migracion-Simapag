INSERT INTO
Motivos_Cambios_Medidor(Motivo,Estatus,Fecha_Creo,Usuario_Creo)
VALUES 
	('ADELANTADO'	,'ACTIVO'	,GETDATE()		,'SERGIO'),
	('ATRASADO'		,'ACTIVO'	,GETDATE()		,'SERGIO'),
	('NO REGISTRADO','ACTIVO'	,GETDATE()		,'SERGIO'),
	('VIDRIO ROTO'	,'ACTIVO'	,GETDATE()		,'SERGIO'),
	('EMPOTRADO'	,'ACTIVO'	,GETDATE()		,'SERGIO'),
	('INVERTIDO'	,'ACTIVO'	,GETDATE()		,'SERGIO'),
	('FUGA'			,'ACTIVO'	,GETDATE()		,'SERGIO'),
	('MANIPULADO'	,'ACTIVO'	,GETDATE()		,'SERGIO'),
	('DESTRUIDO'	,'ACTIVO'	,GETDATE()		,'SERGIO'),
	('MICA EMPAÑDA'	,'ACTIVO'	,GETDATE()		,'SERGIO'),
	('OBSOLETO'		,'ACTIVO'	,GETDATE()		,'SERGIO'),
	('INSTALACION POR RECONEXION','ACTIVO',GETDATE(),'SERGIO'),
	('FUERA DE RANGO','ACTIVO'	,GETDATE()		,'SERGIO')





--------------------------------------------------------------------------------------
--                        MAPEO DE DATOS TABLA: ZONAS                               --
--------------------------------------------------------------------------------------
--	NO SCRIPT A EJEC:	01
--	REGISTROS MIGRADOS:	44
--	TIEMPO DE EJEC:		00.00.00

INSERT INTO	Simapag_20161015.dbo.CAT_COR_ZONAS
			(ZONA_ID, NUMERO_ZONA, DESCRIPCION, USUARIO_CREO, FECHA_CREO)
			
			VALUES
			
			( '00001', '1', 'AGUA ZARCA',  'MIGRACION', GETDATE()),
			( '00002', '2', 'CAJONES',  'MIGRACION', GETDATE()),
			( '00003', '3', 'CAÑADA DE  BUSTOS',  'MIGRACION', GETDATE()),
			( '00004', '4', 'CARBONERA',  'MIGRACION', GETDATE()),
			( '00005', '5', 'CARRIZO',  'MIGRACION', GETDATE()),
			( '00006', '6', 'CATA',  'MIGRACION', GETDATE()),
			( '00007', '7', 'CERRITO DEL ORO',  'MIGRACION', GETDATE()),
			( '00008', '8', 'CERRO DE LOS LEONES',  'MIGRACION', GETDATE()),
			( '00009', '9', 'CERRO DEL CUARTO',  'MIGRACION', GETDATE()),
			( '00010', '10', 'CERVERA',  'MIGRACION', GETDATE()),
			( '00011', '11', 'CIENEGA DEL PREDEGAL',  'MIGRACION', GETDATE()),
			( '00012', '12', 'CUEVAS',  'MIGRACION', GETDATE()),
			( '00013', '13', 'EL HORMIGUERO',  'MIGRACION', GETDATE()),
			( '00014', '14', 'EL MICROBIO',  'MIGRACION', GETDATE()),
			( '00015', '15', 'INSURGENTES',  'MIGRACION', GETDATE()),
			( '00016', '16', 'LA POZA',  'MIGRACION', GETDATE()),
			( '00017', '17', 'MARFIL',  'MIGRACION', GETDATE()),
			( '00018', '18', 'MELLADO',  'MIGRACION', GETDATE()),
			( '00019', '19', 'MUNICIPIO LIBRE',  'MIGRACION', GETDATE()),
			( '00020', '20', 'NORIA ALTA',  'MIGRACION', GETDATE()),
			( '00021', '21', 'PASO DE PERULES',  'MIGRACION', GETDATE()),
			( '00022', '22', 'PASTITA',  'MIGRACION', GETDATE()),
			( '00023', '23', 'PIPILA',  'MIGRACION', GETDATE()),
			( '00024', '24', 'PUEBLITO DE ROCHA',  'MIGRACION', GETDATE()),
			( '00025', '25', 'PUENTECILLAS',  'MIGRACION', GETDATE()),
			( '00026', '26', 'SAN FRANCISCO DEL CHAPIN',  'MIGRACION', GETDATE()),
			( '00027', '27', 'SAN ISIDRO',  'MIGRACION', GETDATE()),
			( '00028', '28', 'SAN JOSE DEL CHAPIN',  'MIGRACION', GETDATE()),
			( '00029', '29', 'SAN JOSE DEL RODEO',  'MIGRACION', GETDATE()),
			( '00030', '30', 'SAN JOSE GRACIA',  'MIGRACION', GETDATE()),
			( '00031', '31', 'SAN JUAN DEL RODEO',  'MIGRACION', GETDATE()),
			( '00032', '32', 'SAN NICOLAS DEL CHAPIN',  'MIGRACION', GETDATE()),
			( '00033', '33', 'SAN VICENTE DE LA CRUZ',  'MIGRACION', GETDATE()),
			( '00034', '34', 'SANTA ANA',  'MIGRACION', GETDATE()),
			( '00035', '35', 'SANTA TERESA',  'MIGRACION', GETDATE()),
			( '00036', '36', 'SANTIAGUILLO',  'MIGRACION', GETDATE()),
			( '00037', '37', 'TEJABAN',  'MIGRACION', GETDATE()),
			( '00038', '38', 'TRINIDAD',  'MIGRACION', GETDATE()),
			( '00039', '39', 'VALENCIANA',  'MIGRACION', GETDATE()),
			( '00040', '40', 'YERBABUENA',  'MIGRACION', GETDATE()),
			( '00041', '41', 'ZANGARRO',  'MIGRACION', GETDATE()),
			( '00042', '42', 'ZONA CENTRO',  'MIGRACION', GETDATE()),
			( '00043', '43', 'ZONA DEL CARRIZO',  'MIGRACION', GETDATE()),
			( '00050', '43', 'SN',  'MIGRACION', GETDATE())

-- ==========================================	
-- ===========  TIPOS_COLONIAS  ============= Listo
-- ==========================================

INSERT INTO Cat_Cor_Tipos_Colonias (TIPO_COLONIA_ID,DESCRIPCION,ESTATUS,USUARIO_CREO,FECHA_CREO)
VALUES 
	('00000','COLONIA DESCONOCIDA','ACTIVO','MIGRACION',GETDATE()),
	('00001','BARRIO','ACTIVO','MIGRACION',GETDATE()),
	('00002','BOULEVARD','ACTIVO','MIGRACION',GETDATE()),
	('00003','CARRETERA','ACTIVO','MIGRACION',GETDATE()),
	('00004','CERRO','ACTIVO','MIGRACION',GETDATE()),
	('00005','CONJUNTO HABITACIONAL','ACTIVO','MIGRACION',GETDATE()),
	('00006','COLONIA','ACTIVO','MIGRACION',GETDATE()),
	('00007','COMUNIDAD','ACTIVO','MIGRACION',GETDATE()),
	('00008','EJIDO','ACTIVO','MIGRACION',GETDATE()),
	('00009','EX HACIENDA','ACTIVO','MIGRACION',GETDATE()),
	('00010','FRACCIONAMIENTO','ACTIVO','MIGRACION',GETDATE()),
	('00011','GRANJAS','ACTIVO','MIGRACION',GETDATE()),
	('00012','CONDOMINIO','ACTIVO','MIGRACION',GETDATE())
	
	--------------------------------------------------------------------------------------
--             MAPEO DE DATOS TABLA: TIPO DE VIVIENDA (ADECUAIONES)                 --
--------------------------------------------------------------------------------------
--	NO SCRIPT AJEC:		01
--	REGISTROS MIGRADOS:	04
--	TIEMPO DE EJEC:		00.00.00
  
INSERT INTO	Simapag_20161015.dbo.CAT_COR_TIPOS_VIVIENDAS
			(TIPO_VIVIENDA_ID, TIPO, DESCRIPCION, USUARIO_CREO, FECHA_CREO)
			VALUES
			('00001','Popular','Popular','MIGRACION',GETDATE()),
			('00002','Interés social','Interés social','MIGRACION',GETDATE()),
			('00003','Residencial','Residencial','MIGRACION',GETDATE()),
			('00004','Campestre','Campestre','MIGRACION',GETDATE());

--------------------------------------------------------------------------------------
--                 MAPEO DE DATOS TABLA: VIALIDADES (ADECUACIONES)                  --
--------------------------------------------------------------------------------------
--	NO SCRIPT AJEC:			01
--	TIEMPO EJECUCION:		00:00:00
--	REGISTROS MIGRADOS:		23

INSERT INTO	Simapag_20161015.dbo.Cat_Cor_Vialidades
			(VIALIDAD_ID, NOMBRE, DESCRIPCION, USUARIO_CREO, FECHA_CREO)
			VALUES
			('00001', 'AMPLIACIÓN', 'AMPLIACIÓN', 'MIGRACION', GETDATE() ),
			('00002', 'ANDADOR', 'ANDADOR', 'MIGRACION', GETDATE() ),
			('00003', 'AVENIDA', 'AVENIDA', 'MIGRACION', GETDATE() ),
			('00004', 'BOULEVARD', 'BOULEVARD', 'MIGRACION', GETDATE() ),
			('00005', 'CALLE', 'CALLE', 'MIGRACION', GETDATE() ),
			('00006', 'CALLEJÓN', 'CALLEJÓN', 'MIGRACION', GETDATE() ),
			('00007', 'CALZADA', 'CALZADA', 'MIGRACION', GETDATE() ),
			('00008', 'CAMINO', 'CAMINO', 'MIGRACION', GETDATE() ),
			('00009', 'CARRETERA', 'CARRETERA', 'MIGRACION', GETDATE() ),
			('00010', 'CERRADA', 'CERRADA', 'MIGRACION', GETDATE() ),
			('00011', 'CIRCUITO', 'CIRCUITO', 'MIGRACION', GETDATE() ),
			('00012', 'CIRCUNVALACIÓN', 'CIRCUNVALACIÓN', 'MIGRACION', GETDATE() ),
			('00013', 'CONTINUACIÓN', 'CONTINUACIÓN', 'MIGRACION', GETDATE() ),
			('00014', 'CORREDOR', 'CORREDOR', 'MIGRACION', GETDATE() ),
			('00015', 'DIAGONAL', 'DIAGONAL', 'MIGRACION', GETDATE() ),
			('00016', 'EJE VIAL', 'EJE VIAL', 'MIGRACION', GETDATE() ),
			('00017', 'PASAJE', 'PASAJE', 'MIGRACION', GETDATE() ),
			('00018', 'PEATONAL', 'PEATONAL', 'MIGRACION', GETDATE() ),
			('00019', 'PERIFÉRICO', 'PERIFÉRICO', 'MIGRACION', GETDATE() ),
			('00020', 'PRIVADA', 'PRIVADA', 'MIGRACION', GETDATE() ),
			('00021', 'PROLONGACIÓN', 'PROLONGACIÓN', 'MIGRACION', GETDATE() ),
			('00022', 'RETORNO', 'RETORNO', 'MIGRACION', GETDATE() ),
			('00023', 'VIADUCTO', 'VIADUCTO', 'MIGRACION', GETDATE() );
-- ===========================================
-- ==============  LOCALIDADES  ============== Listo
-- ===========================================

INSERT INTO Cat_Cor_Localidades 
SELECT * FROM Simapag.dbo.Cat_Cor_Localidades
-- ARCHIVO: Tablas a Exportar SQL
			
			
--------------------------------------------------------------------------------------
--               MAPEO DE DATOS TABLA: MATERIAL BANQUETA  (ADECUACIONES)            --
--------------------------------------------------------------------------------------
--	NO SCRIPT AJEC:			01
--	TIEMPO EJECUCION:		00:00:00
--	REGISTROS MIGRADOS:		02

INSERT INTO Simapag_20161015.dbo.Cat_Cor_Materiales_Predios
			(Material_ID, Nombre, Descripcion, Usuario_Creo, Fecha_Creo)
			VALUES
			('00001', 'Terraceria', 'Material Banqueta', 'MIGRACION', GETDATE()),
			('00002', 'Pavimento', 'Material Banqueta', 'MIGRACION', GETDATE());
			
-- ===========================================	
-- ==========  GRUPOS_DEPENDENCIA  =========== Listo 
-- ===========================================

INSERT INTO CAT_GRUPOS_DEPENDENCIAS (GRUPO_DEPENDENCIA_ID,CLAVE,NOMBRE,USUARIO_CREO,FECHA_CREO)
VALUES 
	('00001','1','DIRECCION GENERAL','MIGRACION',GETDATE()),
	('00002','2','DIR. ADMINISTRATIVA','MIGRACION',GETDATE()),
	('00003','3','DIR. ASUNTOS JURID.','MIGRACION',GETDATE()),
	('00004','4','DIR.SNMTO. Y CONSTR.','MIGRACION',GETDATE()),
	('00005','5','DIRECCION COMERCIAL','MIGRACION',GETDATE()),
	('00006','6','DIR. DE AGUA POTABLE','MIGRACION',GETDATE())
	

-- ============================================
-- =======  CATEGORIA_CONCEPTOS_COBRO  ======== Listo
-- ============================================

INSERT INTO cat_cor_categoria_conceptos_cobros (concepto_categoria_id,nombre_categoria,usuario_creo,fecha_creo)
VALUES 
	('00001','DIVERSOS'		,'MIGRACION',GETDATE()),
	('00002','FACTURACION'	,'MIGRACION',GETDATE()),
	('00003','SANCIONES'	,'MIGRACION',GETDATE()),
	('00004','AMPLIACION'	,'MIGRACION',GETDATE()),
	('00005','DERECHOSINCORP','MIGRACION',GETDATE()),
	('00006','PIPAS'		,'MIGRACION',GETDATE())
	

-- ============================================
-- ===============  IMPUESTOS  ================ Listo
-- ============================================

--select * from CAT_COM_IMPUESTOS;
INSERT INTO CAT_COM_IMPUESTOS (IMPUESTO_ID,NOMBRE,PORCENTAJE_IMPUESTO,COMENTARIOS,USUARIO_CREO,FECHA_CREO)
VALUES 
	('00001','TASA 0',0,'IMPUESTO TASA CERO','MIGRACION',GETDATE()),
	('00002','IVA',16,'IVA 16%','MIGRACION',GETDATE())
	

-- ============================================
-- ==============  TIPOS_CUOTAS  ============== Listo
-- ============================================

INSERT INTO CAT_COR_TIPOS_CUOTAS (CUOTA_ID,DESCRIPCION,CLAVE,USUARIO_CREO,FECHA_CREO)
VALUES 
	('00001','CUOTA FIJA','CF','MIGRACION',GETDATE()),
	('00002','SERVICIO MEDIDO','SM','MIGRACION',GETDATE())


-- ===========================================
-- =================  MARCAS  ================ Listo
-- ===========================================


INSERT INTO CAT_COM_MARCAS (MARCA_ID,COMENTARIOS,NOMBRE,ESTATUS,USUARIO_CREO,FECHA_CREO)
VALUES 
	('00001','01',	'AZTECA    ','ACTIVO','MIGRACION',GETDATE()),
('00002','02',	'DELAUNET  ','ACTIVO','MIGRACION',GETDATE()),
('00003','03',	'KENT      ','ACTIVO','MIGRACION',GETDATE()),
('00004','04',	'PACIFIC   ','ACTIVO','MIGRACION',GETDATE()),
('00005','05',	'SCHULEMBER','ACTIVO','MIGRACION',GETDATE()),
('00006','06',	'UNET      ','ACTIVO','MIGRACION',GETDATE()),
('00007','07',	'ELSTER    ','ACTIVO','MIGRACION',GETDATE()),
('00008','08',	'DOROT     ','ACTIVO','MIGRACION',GETDATE()),
('00009','09',	'BAR METERS','ACTIVO','MIGRACION',GETDATE()),
('00010','10',	'SENSUS    ','ACTIVO','MIGRACION',GETDATE()),
('00011','11',	'AQUILA    ','ACTIVO','MIGRACION',GETDATE()),
('00012','12',	'SAPPEL    ','ACTIVO','MIGRACION',GETDATE()),
('00013','13',	'ABB       ','ACTIVO','MIGRACION',GETDATE()),
('00014','14',	'ZENNER    ','ACTIVO','MIGRACION',GETDATE()),
('00015','15',	'TURBOBRMAN','ACTIVO','MIGRACION',GETDATE()),
('00016','16',	'BERMATDN50','ACTIVO','MIGRACION',GETDATE()),
('00017','17',	'ITRON     ','ACTIVO','MIGRACION',GETDATE()),
('00018','18',	'IPERL     ','ACTIVO','MIGRACION',GETDATE()),
('00019','19',	'CICASA    ','ACTIVO','MIGRACION',GETDATE()),
('00020','20',	'LUCAS CICA','ACTIVO','MIGRACION',GETDATE()),
('00021','21',	'NAANDANJAN','ACTIVO','MIGRACION',GETDATE()),
('00022','22',	'ADCCOM    ','ACTIVO','MIGRACION',GETDATE()),
('00023','23',	'SENSUS IPR','ACTIVO','MIGRACION',GETDATE()),
('00024','24',	'VEAGN     ','ACTIVO','MIGRACION',GETDATE()),
('00025','25','BADGER METERS','ACTIVO','MIGRACION',GETDATE())
	




-- ============================================
-- ===========  MOTIVOS_NO_LECTURA  =========== Listo
-- ============================================

INSERT INTO Cat_Cor_Motivos_No_Lectura (MOTIVO_NO_LECTURA_ID,NOMBRE_MOTIVO,CLAVE,COMENTARIOS,USUARIO_CREO,FECHA_CREO)
SELECT RIGHT('00000'+LTRIM(RTRIM(STR(ROW_NUMBER() OVER (ORDER by A.codanomalia)))),5),
	anomalia,codanomalia,cobrar,'MIGRACION',GETDATE() FROM Simapag_09_01_2016.dbo.anomalias A 
WHERE A.anomalia <> ''
	

-- ============================================
-- ================  ESTADOS  ================= Listo
-- ============================================

INSERT INTO CAT_COR_ESTADOS (ESTADO_ID,CLAVE,ESTATUS,NOMBRE,USUARIO_CREO,FECHA_CREO)
VALUES ('00001','11','ACTIVO','GUANAJUATO','MIGRACION',GETDATE())
	

-- ============================================
-- ================  CIUDADES  ================ Listo
-- ============================================

INSERT INTO CAT_COR_CIUDADES (CIUDAD_ID,ESTADO_ID,CLAVE,ESTATUS,NOMBRE,USUARIO_CREO,FECHA_CREO)
VALUES ('00001','00001','15','ACTIVO','GUANAJUATO','MIGRACION',GETDATE())
	

-- ============================================
-- ============  ESTABLECIMIENTOS  ============ Listo
-- ============================================

INSERT INTO Cat_Cor_Establecimientos (Establecimiento_ID,Nombre,Razon_Social,Representante,RFC,Estatus,Usuario_Creo,Fecha_Creo,Codigo,Cuenta)
SELECT RIGHT('00000'+LTRIM(RTRIM(STR(ROW_NUMBER()OVER(ORDER BY codsucursal)))),5),
	sucursal,sucursal,'SIN DATOS','SIN DATOS','ACTIVO','MIGRACION',GETDATE(),codsucursal,cuenta
FROM Simapag_09_01_2016.dbo.sucursales
WHERE codsucursal <> '' AND codsucursal NOT LIKE 'C%' AND codsucursal NOT LIKE 'D%'
--------------------------------------------------------------------------------------
--                 MAPEO DE DATOS TABLA: BANCOS (ADECUACIONES)                      --
--------------------------------------------------------------------------------------
-- NOTA: BASANDOSE EN LA INFROMACION PRESENTADA EN LA BASE DE DATOS VS LAYOUT DE BANCOS, 
--       HACE FALTA INFROMACION REFERENTE A LA CUENTA CONTABLE.

--	NO SCRIPT AJEC:			01
--	TIEMPO EJECUCION:		00:00:00
--	REGISTROS MANIPULADOS:	34
--	REGISTROS MIGRADOS:		34

INSERT INTO Simapag_20161015.dbo.Cat_Cor_Bancos
			(BANCO_ID, NOMBRE, USUARIO_CREO, FECHA_CREO)

			SELECT	DISTINCT
						'00' + codbanco
					AS ID,
						UPPER(RTRIM(banco))
					AS NOMBRE,
						'MIGRACION'
					AS U_CREO,
						GETDATE()
					AS F_CREO
					
			FROM	Simapag_09_01_2016.dbo.bancos
--------------------------------------------------------------------------------------
--               MAPEO DE DATOS TABLA: REGION (ADECUACIONES)                        --
--------------------------------------------------------------------------------------
--	NO SCRIPT AJEC:			01
--	TIEMPO EJECUCION:		00:00:00
--	REGISTROS MANIPULADOS:	21
--	REGISTROS MIGRADOS:		19

-- NOTA: LA INFROMACION PARA LA MIGRACION DE ESTA TABLA FUE OBTENIDA DE LA TABLA "SECTOR"
--		 MANEJADA POR SIMAPAG.	
--       - EL # DE REGIOS = codsector 
--       - NO SE TOMARON AQUELLOS REGISTROS QUE PRESENTAVAN EL VALOR '' COMO CODIGO DE SECTOR
--		 - NO SE REALIZÓ LA MIGRACION DEL VALOR "DISTRITRO"



INSERT INTO	Simapag_20161015.dbo.Cat_Cor_Regiones 
			(Region_ID, Numero_Region, DESCRIPCION, COMENTARIOS, 
			 USUARIO_CREO, FECHA_CREO)
			
			SELECT 
						RIGHT('00000'+ LTRIM(RTRIM(STR(ROW_NUMBER() OVER(ORDER BY C1.codsector ASC)))), 5)
					AS ID,
						C1.codsector
					AS NUMERO_REGION,
						C1.sector
					AS DESCRIPCION, 
						C1.codsector
					AS	COMENTARIOS, 
						'MIGRACION'
					AS	U_CREO,
						GETDATE()
					AS F_CREO
			FROM	Simapag_09_01_2016.dbo.sector
			AS		C1 
			WHERE	C1.codsector NOT LIKE ''
			
--------------------------------------------------------------------------------------
--               MAPEO DE DATOS TABLA: POBLACION (ADECUACIONES)                     --
--------------------------------------------------------------------------------------
--	NO SCRIPT AJEC:			01
--	TIEMPO EJECUCION:		00:00:00
--	REGISTROS MANIPULADOS:	
--	REGISTROS MIGRADOS:		20

-- NOATA:	LOS DATOS PARA ESTA MIGRACION FUERON TOMADOS DE LA TABLA "PADRON"
--			EXISTEN SÓLO 2 REGISTROS QUE NO CUENTAN CON ESE DATOS, POR LO QUE SE MIGRA 
--			CON EL VALOR "NULO"



INSERT INTO Simapag_20161015.dbo.Cat_cor_Poblacion
			(clave_poblacion,descripcion_poblacion,usuario_creo,fecha_creo) 

			SELECT	DISTINCT
						poblacion
					AS CVE_POBLACION,
						'POBLACION'+ SPACE(1) + poblacion
					AS DESCIPCCION,
						'MIGRACION'
					AS U_CREO,
						GETDATE() 
					AS F_CREO
			FROM	Simapag_09_01_2016.dbo.padron
			WHERE	poblacion NOT LIKE ''
			ORDER 
			BY		CVE_POBLACION 

--USE		Simapag_20161015
--DBCC	CHECKIDENT (Cat_cor_Poblacion, RESEED, 0)
--USE		master
--DELETE SIAC_SIMAPAG.dbo.Cat_cor_Poblacion

--------------------------------------------------------------------------------------
--				     MAPEO DE DATOS TABLA: GIROS (ADECUACIONES)                     --
--------------------------------------------------------------------------------------
--	NO SCRIPT AJEC:			01
--	TIEMPO EJECUCION:		00:00:00
--	REGISTROS MIGRADOS:		09

INSERT INTO Simapag_20161015.dbo.Cat_Cor_Giros
			(GIRO_ID, Clave, Nombre_Giro, Descripcion, Comentarios, Usuario_Creo, Fecha_Creo)
			VALUES
			
			('0000000001', 'CO', 'COMERCIAL', 'COMERCIAL', 'CO', 'MIGRACION', GETDATE()),
			('0000000002', 'DO', 'DOMESTICO', 'DOMESTICO', 'DO', 'MIGRACION', GETDATE()),
			('0000000003', 'IN', 'INDUSTRIAL', 'INDUSTRIAL', 'IN', 'MIGRACION', GETDATE()),
			('0000000004', 'MX', 'MIXTO', 'MIXTO', 'MX', 'MIGRACION', GETDATE()),
			('0000000005', 'PU', 'PUBLICO', 'PUBLICO', 'PU', 'MIGRACION', GETDATE()),
			('0000000006', 'SE', 'SERVICIOS', 'SERVICIOS', 'SE', 'MIGRACION', GETDATE()),
			('0000000007', 'AC', 'CONSTRUCCION', 'CONSTRUCCION', 'AC', 'MIGRACION', GETDATE()),
			('0000000008', 'FP', 'FUERA DEL PADRON', 'FUERA DEL PADRON', 'FP', 'MIGRACION', GETDATE()),
			('0000000009', 'FC', 'FRACCIONAMIENTO', 'FRACCIONAMIENTO', 'FC', 'MIGRACION', GETDATE());
			
-----------------------------------------------------------------------------------------------------
--                              MAPEO DE DATOS TABLA: PRODUCTOS                                    --
-----------------------------------------------------------------------------------------------------
-- NOTA: SE DEBE DE CORROBORAR CON HECTOR SI ESTOS SON LOS UNICOS DATOS A MIGRAR.

-- SE UTILIZÓ LA SIGUIENTE INTRUCCION POR MEDIO DE EXCEL
-- =CONCATENAR("('",B1,"','",C1,"','",B1,"','",D1,"',0,'",D1,"','ACTIVO','PRODUCTO','MIGRACION','2016-05-10'),")

--	NO SCRIPT AJEC:		01
--	REGISTROS MIGRADOS: 85
--	TIEMPO DE EJEC:		00.00.00



INSERT INTO Simapag_20161015.dbo.CAT_COM_PRODUCTOS
	   (PRODUCTO_ID,UNIDAD,CLAVE,NOMBRE,COSTO,DESCRIPCION,ESTATUS,TIPO,USUARIO_CREO,FECHA_CREO)
	   VALUES
       ('0000000001','pza','0000000001','ABRAZADERA    2"  A   1/2"              SISTEMA INGLES',0,'ABRAZADERA    2"  A   1/2"              SISTEMA INGLES','ACTIVO','PRODUCTO','MIGRACION','2016-05-10'),
       ('0000000002','pza','0000000002','ABRAZADERA    3"  A   1/2"              SISTEMA INGLES',0,'ABRAZADERA    3"  A   1/2"              SISTEMA INGLES','ACTIVO','PRODUCTO','MIGRACION','2016-05-10'),
       ('0000000003','pza','0000000003','ABRAZADERA    4"  A   1/2"              SISTEMA INGLES',0,'ABRAZADERA    4"  A   1/2"              SISTEMA INGLES','ACTIVO','PRODUCTO','MIGRACION','2016-05-10'),
       ('0000000004','pza','0000000004','CODO  HEMBRA PVC 1/2"',0,'CODO  HEMBRA PVC 1/2"','ACTIVO','PRODUCTO','MIGRACION','2016-05-10'),
       ('0000000005','mts','0000000005','TUBERIA RUPEX BIVE UV SHIELD COLOR AZUL 1/2"',0,'TUBERIA RUPEX BIVE UV SHIELD COLOR AZUL 1/2"','ACTIVO','PRODUCTO','MIGRACION','2016-05-10'),
       ('0000000006','pza','0000000006','CODO 1/2" x  45°  COBRE',0,'CODO 1/2" x  45°  COBRE','ACTIVO','PRODUCTO','MIGRACION','2016-05-10'),
       ('0000000007','pza','0000000007','CODO DE 1/2" x 90°  COBRE A COBRE',0,'CODO DE 1/2" x 90°  COBRE A COBRE','ACTIVO','PRODUCTO','MIGRACION','2016-05-10'),
       ('0000000008','pza','0000000008','CODO DE COBRE A FIERRO DE 1/2" X 90° CUERDA INTERIOR',0,'CODO DE COBRE A FIERRO DE 1/2" X 90° CUERDA INTERIOR','ACTIVO','PRODUCTO','MIGRACION','2016-05-10'),
       ('0000000009','pza','0000000009','CODO DE COBRE A FIERRO DE 1/2" X 90° CUERDA EXTERIOR',0,'CODO DE COBRE A FIERRO DE 1/2" X 90° CUERDA EXTERIOR','ACTIVO','PRODUCTO','MIGRACION','2016-05-10'),
       ('0000000010','pza','0000000010','CODO GALVANIZADO DE 1/2" x  45°',0,'CODO GALVANIZADO DE 1/2" x  45°','ACTIVO','PRODUCTO','MIGRACION','2016-05-10'),
       ('0000000011','pza','0000000011','CODO GALVANIZADO DE 1/2" x  90°',0,'CODO GALVANIZADO DE 1/2" x  90°','ACTIVO','PRODUCTO','MIGRACION','2016-05-10'),
       ('0000000012','pza','0000000012','CONECTOR DE 1/2"  CUERDA EXTERIOR COBRE A FIERRO',0,'CONECTOR DE 1/2"  CUERDA EXTERIOR COBRE A FIERRO','ACTIVO','PRODUCTO','MIGRACION','2016-05-10'),
       ('0000000013','pza','0000000013','CONECTOR DE 1/2"  CUERDA INTERIOR COBRE A FIERRO',0,'CONECTOR DE 1/2"  CUERDA INTERIOR COBRE A FIERRO','ACTIVO','PRODUCTO','MIGRACION','2016-05-10'),
       ('0000000014','pza','0000000014','ADAPTADOR MACHO DE PVC DE 1/2" PARA TUBO RAMAL',0,'ADAPTADOR MACHO DE PVC DE 1/2" PARA TUBO RAMAL','ACTIVO','PRODUCTO','MIGRACION','2016-05-10'),
       ('0000000015','pza','0000000015','COPLE DE COBRE DE 1/2"',0,'COPLE DE COBRE DE 1/2"','ACTIVO','PRODUCTO','MIGRACION','2016-05-10'),
       ('0000000016','pza','0000000016','COPLE GALVANIZADO DE 1/2"',0,'COPLE GALVANIZADO DE 1/2"','ACTIVO','PRODUCTO','MIGRACION','2016-05-10'),
       ('0000000017','mts','0000000017','FRANELA',0,'FRANELA','ACTIVO','PRODUCTO','MIGRACION','2016-05-10'),
       ('0000000018','mts','0000000018','LIJA ',0,'LIJA ','ACTIVO','PRODUCTO','MIGRACION','2016-05-10'),
       ('0000000019','pza','0000000019','LLAVE DE CHORRO DE 1/2"',0,'LLAVE DE CHORRO DE 1/2"','ACTIVO','PRODUCTO','MIGRACION','2016-05-10'),
       ('0000000020','pza','0000000020','LUBRICANTE PARA PVC    (300 gms)',0,'LUBRICANTE PARA PVC    (300 gms)','ACTIVO','PRODUCTO','MIGRACION','2016-05-10'),
       ('0000000021','mts','0000000021','MANGUERA PVC DE 1/2"',0,'MANGUERA PVC DE 1/2"','ACTIVO','PRODUCTO','MIGRACION','2016-05-10'),
       ('0000000022','pza','0000000022','NIPLE GALVANIZADO DE 1/2" x  CC"',0,'NIPLE GALVANIZADO DE 1/2" x  CC"','ACTIVO','PRODUCTO','MIGRACION','2016-05-10'),
       ('0000000023','pza','0000000023','NIPLE GALVANIZADO DE 1/2" x  2"',0,'NIPLE GALVANIZADO DE 1/2" x  2"','ACTIVO','PRODUCTO','MIGRACION','2016-05-10'),
       ('0000000024','pza','0000000024','NIPLE GALVANIZADO DE 1/2" x  2 1/2"',0,'NIPLE GALVANIZADO DE 1/2" x  2 1/2"','ACTIVO','PRODUCTO','MIGRACION','2016-05-10'),
       ('0000000025','pza','0000000025','NIPLE GALVANIZADO DE 1/2" x  3"',0,'NIPLE GALVANIZADO DE 1/2" x  3"','ACTIVO','PRODUCTO','MIGRACION','2016-05-10'),
       ('0000000026','pza','0000000026','NIPLE GALVANIZADO DE 1/2" x  3 1/2"',0,'NIPLE GALVANIZADO DE 1/2" x  3 1/2"','ACTIVO','PRODUCTO','MIGRACION','2016-05-10'),
       ('0000000027','pza','0000000027','NIPLE GALVANIZADO DE 1/2" x  4"',0,'NIPLE GALVANIZADO DE 1/2" x  4"','ACTIVO','PRODUCTO','MIGRACION','2016-05-10'),
       ('0000000028','pza','0000000028','NIPLE GALVANIZADO DE 1/2" x  4 1/2"',0,'NIPLE GALVANIZADO DE 1/2" x  4 1/2"','ACTIVO','PRODUCTO','MIGRACION','2016-05-10'),
       ('0000000029','pza','0000000029','NIPLE GALVANIZADO DE 1/2" x  5"',0,'NIPLE GALVANIZADO DE 1/2" x  5"','ACTIVO','PRODUCTO','MIGRACION','2016-05-10'),
       ('0000000030','pza','0000000030','NIPLE GALVANIZADO DE 1/2" x  6"',0,'NIPLE GALVANIZADO DE 1/2" x  6"','ACTIVO','PRODUCTO','MIGRACION','2016-05-10'),
       ('0000000031','pza','0000000031','NIPLE GALVANIZADO DE 1/2" x  8"',0,'NIPLE GALVANIZADO DE 1/2" x  8"','ACTIVO','PRODUCTO','MIGRACION','2016-05-10'),
       ('0000000032','pza','0000000032','NIPLE GALVANIZADO DE 1/2" x  10"',0,'NIPLE GALVANIZADO DE 1/2" x  10"','ACTIVO','PRODUCTO','MIGRACION','2016-05-10'),
       ('0000000033','pza','0000000033','PASTA PARA SOLDAR DE 75 g',0,'PASTA PARA SOLDAR DE 75 g','ACTIVO','PRODUCTO','MIGRACION','2016-05-10'),
       ('0000000034','pza','0000000034','REDUCCION BUSHING GALVANIZADA DE 3/4" A 1/2"',0,'REDUCCION BUSHING GALVANIZADA DE 3/4" A 1/2"','ACTIVO','PRODUCTO','MIGRACION','2016-05-10'),
       ('0000000035','pza','0000000035','REDUCCION CAMPANA   3/4" A  1/2"    GALVANIZADA',0,'REDUCCION CAMPANA   3/4" A  1/2"    GALVANIZADA','ACTIVO','PRODUCTO','MIGRACION','2016-05-10'),
       ('0000000036','pza','0000000036','REDUCCION CAMPANA   3/4" A  1/2"   COBRE',0,'REDUCCION CAMPANA   3/4" A  1/2"   COBRE','ACTIVO','PRODUCTO','MIGRACION','2016-05-10'),
       ('0000000037','pza','0000000037','REDUCCION BUSHING DE COBRE  DE 3/4" A 1/2"',0,'REDUCCION BUSHING DE COBRE  DE 3/4" A 1/2"','ACTIVO','PRODUCTO','MIGRACION','2016-05-10'),
       ('0000000038','pza','0000000038','SELLADOR PARA TUBERIA PERMATEX DE 120 GR',0,'SELLADOR PARA TUBERIA PERMATEX DE 120 GR','ACTIVO','PRODUCTO','MIGRACION','2016-05-10'),
       ('0000000039','pza','0000000039','SOLDADURA  50 - 50 DE 450 GR',0,'SOLDADURA  50 - 50 DE 450 GR','ACTIVO','PRODUCTO','MIGRACION','2016-05-10'),
       ('0000000040','pza','0000000040','TANQUE GAS DESECHABLE  240 GRS',0,'TANQUE GAS DESECHABLE  240 GRS','ACTIVO','PRODUCTO','MIGRACION','2016-05-10'),
       ('0000000041','pza','0000000041','TAPON  KAPA GALVANIZADO DE 1/2"',0,'TAPON  KAPA GALVANIZADO DE 1/2"','ACTIVO','PRODUCTO','MIGRACION','2016-05-10'),
       ('0000000042','pza','0000000042','TAPON KAPA  1/2"   COBRE',0,'TAPON KAPA  1/2"   COBRE','ACTIVO','PRODUCTO','MIGRACION','2016-05-10'),
       ('0000000043','pza','0000000043','TAPON MACHO GALVANIZADO DE 1/2"',0,'TAPON MACHO GALVANIZADO DE 1/2"','ACTIVO','PRODUCTO','MIGRACION','2016-05-10'),
       ('0000000044','pza','0000000044','TEE DE COBRE DE 1/2"',0,'TEE DE COBRE DE 1/2"','ACTIVO','PRODUCTO','MIGRACION','2016-05-10'),
       ('0000000045','pza','0000000045','TEE GALVANIZADA DE 1/2"',0,'TEE GALVANIZADA DE 1/2"','ACTIVO','PRODUCTO','MIGRACION','2016-05-10'),
       ('0000000046','mts','0000000046','TUBO  GALVANIZADO 1/2" ',0,'TUBO  GALVANIZADO 1/2" ','ACTIVO','PRODUCTO','MIGRACION','2016-05-10'),
       ('0000000047','mts','0000000047','TUBO DE COBRE DE 1/2"',0,'TUBO DE COBRE DE 1/2"','ACTIVO','PRODUCTO','MIGRACION','2016-05-10'),
       ('0000000048','mts','0000000048','TUBO DE COBRE FLEXIBLE DE 5/8   (75cms)',0,'TUBO DE COBRE FLEXIBLE DE 5/8   (75cms)','ACTIVO','PRODUCTO','MIGRACION','2016-05-10'),
       ('0000000049','pza','0000000049','TUERCA UNION DE COBRE A COBRE DE 1/2"',0,'TUERCA UNION DE COBRE A COBRE DE 1/2"','ACTIVO','PRODUCTO','MIGRACION','2016-05-10'),
       ('0000000050','pza','0000000050','TUERCA UNION DE COBRE A FIERRO 1/2"  C / INTERIOR',0,'TUERCA UNION DE COBRE A FIERRO 1/2"  C / INTERIOR','ACTIVO','PRODUCTO','MIGRACION','2016-05-10'),
       ('0000000051','pza','0000000051','TUERCA UNION GALVANIZADA DE 1/2"',0,'TUERCA UNION GALVANIZADA DE 1/2"','ACTIVO','PRODUCTO','MIGRACION','2016-05-10'),
       ('0000000052','pza','0000000052','VALVULA ANGULAR DE BARRIL',0,'VALVULA ANGULAR DE BARRIL','ACTIVO','PRODUCTO','MIGRACION','2016-05-10'),
       ('0000000053','pza','0000000053','VALVULA  MACHO DE 1/2"',0,'VALVULA  MACHO DE 1/2"','ACTIVO','PRODUCTO','MIGRACION','2016-05-10'),
       ('0000000054','pza','0000000054','VALVULA DE COMPUERTA ROSCABLE DE BRONCE 1/2"',0,'VALVULA DE COMPUERTA ROSCABLE DE BRONCE 1/2"','ACTIVO','PRODUCTO','MIGRACION','2016-05-10'),
       ('0000000055','pza','0000000055','VALVULA DE INSERCION DE 1/2"',0,'VALVULA DE INSERCION DE 1/2"','ACTIVO','PRODUCTO','MIGRACION','2016-05-10'),
       ('0000000056','pza','0000000056','VALVULA ESFERA ROSCABLE DE PVC DE 1/2"',0,'VALVULA ESFERA ROSCABLE DE PVC DE 1/2"','ACTIVO','PRODUCTO','MIGRACION','2016-05-10'),
       ('0000000057','pza','0000000057','VALVULA EXPULSORA DE AIRE DE 1/2"',0,'VALVULA EXPULSORA DE AIRE DE 1/2"','ACTIVO','PRODUCTO','MIGRACION','2016-05-10'),
       ('0000000058','pza','0000000058','VALVULA COMPUERTA SOLDABLE BRONCE DE 1/2"',0,'VALVULA COMPUERTA SOLDABLE BRONCE DE 1/2"','ACTIVO','PRODUCTO','MIGRACION','2016-05-10'),
       ('0000000059','pza','0000000059','CODO GALVANIZADO DE 3/4" x  45°',0,'CODO GALVANIZADO DE 3/4" x  45°','ACTIVO','PRODUCTO','MIGRACION','2016-05-10'),
       ('0000000060','pza','0000000060','CODO GALVANIZADO DE 3/4" x  90°',0,'CODO GALVANIZADO DE 3/4" x  90°','ACTIVO','PRODUCTO','MIGRACION','2016-05-10'),
       ('0000000061','pza','0000000061','NIPLE GALVANIZADO DE 3/4" x  C/C"',0,'NIPLE GALVANIZADO DE 3/4" x  C/C"','ACTIVO','PRODUCTO','MIGRACION','2016-05-10'),
       ('0000000062','pza','0000000062','NIPLE GALVANIZADO DE 3/4" x  3"',0,'NIPLE GALVANIZADO DE 3/4" x  3"','ACTIVO','PRODUCTO','MIGRACION','2016-05-10'),
       ('0000000063','pza','0000000063','NIPLE GALVANIZADO DE 3/4" x  5"',0,'NIPLE GALVANIZADO DE 3/4" x  5"','ACTIVO','PRODUCTO','MIGRACION','2016-05-10'),
       ('0000000064','pza','0000000064','REDUCCION BUSHING GALVANIZADA  DE 3/4" A 1/2"',0,'REDUCCION BUSHING GALVANIZADA  DE 3/4" A 1/2"','ACTIVO','PRODUCTO','MIGRACION','2016-05-10'),
       ('0000000065','pza','0000000065','COPLE GALVANIZADO DE 1"',0,'COPLE GALVANIZADO DE 1"','ACTIVO','PRODUCTO','MIGRACION','2016-05-10'),
       ('0000000066','pza','0000000066','CODO GALVANIZADO DE 1" x  45°',0,'CODO GALVANIZADO DE 1" x  45°','ACTIVO','PRODUCTO','MIGRACION','2016-05-10'),
       ('0000000067','pza','0000000067','CODO GALVANIZADO DE 1" x  90°',0,'CODO GALVANIZADO DE 1" x  90°','ACTIVO','PRODUCTO','MIGRACION','2016-05-10'),
       ('0000000068','pza','0000000068','NIPLE GALVANIZADO DE 1" x  CC"',0,'NIPLE GALVANIZADO DE 1" x  CC"','ACTIVO','PRODUCTO','MIGRACION','2016-05-10'),
       ('0000000069','pza','0000000069','NIPLE GALVANIZADO DE 1" x  4"',0,'NIPLE GALVANIZADO DE 1" x  4"','ACTIVO','PRODUCTO','MIGRACION','2016-05-10'),
       ('0000000070','pza','0000000070','NIPLE GALVANIZADO DE 1" x  5"',0,'NIPLE GALVANIZADO DE 1" x  5"','ACTIVO','PRODUCTO','MIGRACION','2016-05-10'),
       ('0000000071','pza','0000000071','NIPLE GALVANIZADO DE 1" x  6"',0,'NIPLE GALVANIZADO DE 1" x  6"','ACTIVO','PRODUCTO','MIGRACION','2016-05-10'),
       ('0000000072','pza','0000000072','NIPLE GALVANIZADO DE 1" x  8"',0,'NIPLE GALVANIZADO DE 1" x  8"','ACTIVO','PRODUCTO','MIGRACION','2016-05-10'),
       ('0000000073','pza','0000000073','NIPLE GALVANIZADO DE 1" x  CUERDA CORRIDA',0,'NIPLE GALVANIZADO DE 1" x  CUERDA CORRIDA','ACTIVO','PRODUCTO','MIGRACION','2016-05-10'),
       ('0000000074','pza','0000000074','REDUCCION BUSHING GALVANIZADA  DE 3/4" A 1/2"',0,'REDUCCION BUSHING GALVANIZADA  DE 3/4" A 1/2"','ACTIVO','PRODUCTO','MIGRACION','2016-05-10'),
       ('0000000075','pza','0000000075','REDUCCION CAMPANA GALVANIZADA  DE  1" A 1/2"',0,'REDUCCION CAMPANA GALVANIZADA  DE  1" A 1/2"','ACTIVO','PRODUCTO','MIGRACION','2016-05-10'),
       ('0000000076','pza','0000000076','REDUCCION CAMPANA GALVANIZADA  DE  1" A 3/4"',0,'REDUCCION CAMPANA GALVANIZADA  DE  1" A 3/4"','ACTIVO','PRODUCTO','MIGRACION','2016-05-10'),
       ('0000000077','pza','0000000077','REDUCCION BUSHING GALVANIZADA  DE 1" A 1/2"',0,'REDUCCION BUSHING GALVANIZADA  DE 1" A 1/2"','ACTIVO','PRODUCTO','MIGRACION','2016-05-10'),
       ('0000000078','pza','0000000078','REDUCCION CAMPANA  DE  3/4" A 1/2" DE COBRE',0,'REDUCCION CAMPANA  DE  3/4" A 1/2" DE COBRE','ACTIVO','PRODUCTO','MIGRACION','2016-05-10'),
       ('0000000079','pza','0000000079','NIPLE GALVANIZADO DE 1 1/2" x  C.C.',0,'NIPLE GALVANIZADO DE 1 1/2" x  C.C.','ACTIVO','PRODUCTO','MIGRACION','2016-05-10'),
       ('0000000080','pza','0000000080','TEE GALVANIZADA DE 1"',0,'TEE GALVANIZADA DE 1"','ACTIVO','PRODUCTO','MIGRACION','2016-05-10'),
       ('0000000081','pza','0000000081','VALVULA  MACHO DE 3/4"',0,'VALVULA  MACHO DE 3/4"','ACTIVO','PRODUCTO','MIGRACION','2016-05-10'),
       ('0000000082','pza','0000000082','REDUCCION BUSHING DE COBRE DE 1" A 1/2"',0,'REDUCCION BUSHING DE COBRE DE 1" A 1/2"','ACTIVO','PRODUCTO','MIGRACION','2016-05-10'),
       ('0000000083','pza','0000000083','VALVULA DE COMPUERTA TIPO GLOBO 1/2"',0,'VALVULA DE COMPUERTA TIPO GLOBO 1/2"','ACTIVO','PRODUCTO','MIGRACION','2016-05-10'),
       ('0000000084','pza','0000000084','REDUCCION CAMPANA GALVANIZADA DE 2" A 1"',0,'REDUCCION CAMPANA GALVANIZADA DE 2" A 1"','ACTIVO','PRODUCTO','MIGRACION','2016-05-10'),
       ('0000000085','pza','0000000085','VALVULA  MACHO DE 1"',0,'VALVULA  MACHO DE 1"','ACTIVO','PRODUCTO','MIGRACION','2016-05-10')

-- ===========================================
-- ===============  MEDIDORES  =============== Listo
-- ===========================================

INSERT INTO Cat_Cor_Medidores (MEDIDOR_ID,MARCA_ID,NO_MEDIDOR,DIAMETRO,USUARIO_CREO,FECHA_CREO,LIMITE_MEDIDOR,ESTATUS)
SELECT
	RIGHT('0000000000'+CAST(ROW_NUMBER()OVER (ORDER by nummedidor)AS VARCHAR),10)AS MEDIDOR_ID,
	(SELECT MARCA_ID from CAT_COM_MARCAS where COMENTARIOS=marcamed)AS MARCA_ID,LTRIM(RTRIM(nummedidor))AS NUMMEDIDOR,
	(SELECT top 1 REPLACE(diametro,'"','') from Simapag_09_01_2016.dbo.diammedidor where coddiammed = diammedidor)AS DIAMETRO,
	'MIGRACION' AS U_CREO,GETDATE() AS F_CREO,99999 AS LIMITE,'ACTIVO' AS ESTATUS
FROM --Simapag_09_01_2016.dbo.padron where nummedidor<>''
	(SELECT DISTINCT marcamed,LTRIM(nummedidor)nummedidor,diammedidor FROM Simapag_09_01_2016.dbo.padron WHERE nummedidor <> '') AS C1
	
-- ===========================================
-- =============  DEPENDENCIAS  ============== Listo
-- ===========================================

INSERT INTO CAT_DEPENDENCIAS (DEPENDENCIA_ID,NOMBRE,ESTATUS,USUARIO_CREO,FECHA_CREO,CLAVE,GRUPO_DEPENDENCIA_ID)
VALUES 
	('00001','DES. INSTITUCIONAL',		'ACTIVO','MIGRACION',GETDATE(),'1',	'00002'),
	('00002','DEPTO.MEDICION',			'ACTIVO','MIGRACION',GETDATE(),'2',	'00005'),
	('00003','MEDIDORES',				'ACTIVO','MIGRACION',GETDATE(),'3',	'00005'),
	('00004','ATTN.PUB.',				'ACTIVO','MIGRACION',GETDATE(),'4',	'00005'),
	('00005','SIST.COMERCIAL',			'ACTIVO','MIGRACION',GETDATE(),'5',	'00005'),
	('00006','RECURSOS MATERIALES',		'ACTIVO','MIGRACION',GETDATE(),'6',	'00002'),
	('00007','RECURSOS HUMANOS',		'ACTIVO','MIGRACION',GETDATE(),'7',	'00002'),
	('00008','COMERCIAL',				'ACTIVO','MIGRACION',GETDATE(),'8',	'00005'),
	('00009','USUARIOS EN TRAMITE',		'ACTIVO','MIGRACION',GETDATE(),'9',	'00002'),
	('00010','COORD.SIST.COMERCIAL',	'ACTIVO','MIGRACION',GETDATE(),'10','00005'),
	('00011','DEPTO. INFORMATICA',		'ACTIVO','MIGRACION',GETDATE(),'11','00002'),
	('00012','D.CARTERA VENCIDA',		'ACTIVO','MIGRACION',GETDATE(),'12','00005'),
	('00013','DEPTO. OBRA HID.',		'ACTIVO','MIGRACION',GETDATE(),'13','00006'),
	('00014','SEGUIMIENTO',				'ACTIVO','MIGRACION',GETDATE(),'14','00005'),
	('00015','RECEPCION',				'ACTIVO','MIGRACION',GETDATE(),'15','00005'),
	('00016','AFOROS',					'ACTIVO','MIGRACION',GETDATE(),'16','00005'),
	('00017','SEPTIMO CONSEJO DIRECTIVO','ACTIVO','MIGRACION',GETDATE(),'17','00002'),
	('00018','DIRECCION COMERCIAL',		'ACTIVO','MIGRACION',GETDATE(),'18','00001'),
	('00019','CONSEJO',					'ACTIVO','MIGRACION',GETDATE(),'19','00001'),
	('00020','DIRECTOR GENERAL',		'ACTIVO','MIGRACION',GETDATE(),'20','00001')

--------------------------------------------------------------------------------------
--                 MAPEO DE DATOS TABLA: CALLES (ADECUACIONES)                      --
--------------------------------------------------------------------------------------
--	NO SCRIPT AJEC:			02
--	TIEMPO EJECUCION:		00:00:00
--	REGISTROS MANIPULADOS:	2830
--	REGISTROS MIGRADOS:		2825

INSERT INTO	Simapag_20161015.dbo.Cat_Cor_Calles
			(CALLE_ID, NOMBRE, COMENTARIOS, USUARIO_CREO, USUARIO_MODIFICO, VIALIDAD_ID)
						
			SELECT	DISTINCT	
						RIGHT('00000'+ LTRIM(RTRIM(STR(ROW_NUMBER() OVER(ORDER BY C1.codcalle ASC)))), 5)
					AS ID,
					C1.calle,
						C1.codcalle
					AS COMENTARIOS,
						'MIGRACION'
					AS U_CREO,
						GETDATE()
					AS F_CREO,
						CASE 
							WHEN	C1.calle LIKE 'AMPLIACIÓN%'
							OR		C1.calle LIKE 'AMPLIACION%'
							THEN	'00001'
							
							WHEN	C1.calle LIKE 'AND%' 
							OR		C1.calle LIKE 'ANDADOR%'
							THEN	'00002'
							
							WHEN	C1.calle LIKE 'AVENIDA%' 
							OR		C1.calle LIKE 'AV%'
							OR		C1.calle LIKE 'AV.%'
							THEN	'00003'
							
							 WHEN	C1.calle LIKE 'BOULEVAR%' 
							 OR		C1.calle LIKE 'BLVD%'  
							 OR		C1.calle LIKE 'BO%' 
							 THEN	'00004'				 
							 
							WHEN	C1.calle LIKE 'CALLEJON%' 
							OR		C1.calle LIKE 'CALLEJÓN%'
							OR		C1.calle LIKE 'CJON%'  
							OR		C1.calle LIKE 'CJON.%' 
							OR		C1.calle LIKE 'SEGUNDO C%'
							THEN	'00006'
			                
							WHEN	C1.calle LIKE 'CALZADA%' 
							OR		C1.calle LIKE 'PRIMERA C%'
							OR		C1.calle LIKE 'SEGUNDA C%'
							OR		C1.calle LIKE 'CALZ%'
							OR		C1.calle LIKE 'CDA%' 
							THEN	'00007'
			                
							WHEN	C1.calle LIKE 'CAMINO%' 
							OR		C1.calle LIKE 'CAM%' 
							THEN	'00008'
			                
							WHEN	C1.calle LIKE 'CARRETERA%' 
							OR		C1.calle LIKE 'CARR%' 
							OR		C1.calle LIKE 'CARR.PAN%' 
							OR		C1.calle LIKE 'CARRET%' 
							OR		C1.calle LIKE 'CARRT%' 
							THEN	'00009'
							
							WHEN	C1.calle LIKE 'CERRADA%'
							OR		C1.calle LIKE '4TA%'
							OR		C1.calle LIKE '1RA C%'
							OR		C1.calle LIKE 'TERCERA C%'
							THEN	'00010'
											
							WHEN	C1.calle LIKE 'CIRCUITO%' 
							OR		C1.calle LIKE 'CTO%' 
							THEN	'00011'
							
							WHEN	C1.calle LIKE 'CIRCUNVALACIÓN%'
							OR		C1.calle LIKE 'CIRCUNVALACION%'
							THEN	'00012'
							
							WHEN	C1.calle LIKE 'CONTINUACIÓN%'
							OR		C1.calle LIKE 'CONTINUACION%'
							THEN	'00013'
							
							WHEN	C1.calle LIKE 'CORREDOR%'
							THEN	'00014'
							
							WHEN	C1.calle LIKE 'DIAGONAL%'
							THEN	'00015'
							
							WHEN	C1.calle LIKE 'EJE VIAL%'
							THEN	'00016'
							
							WHEN	C1.calle LIKE 'PASAJE%'
							THEN	'00017'
							
							WHEN	C1.calle LIKE 'PEATONAL%'
							THEN	'00018'
							
							WHEN	C1.calle LIKE 'PERIFÉRICO%'
							OR		C1.calle LIKE 'PERIFERICO%'
							THEN	'00019'
							
							WHEN	C1.calle LIKE 'PRIVADA%'
							OR		C1.calle LIKE 'PRIV%'
							OR		C1.calle LIKE '1RA P%'
							OR		C1.calle LIKE '2DA P%'
							THEN	'00020'
							
							WHEN	C1.calle LIKE 'PROLONGACIÓN%'
							OR		C1.calle LIKE 'PROF%' 
							OR		C1.calle LIKE 'PROL%' 
							OR		C1.calle LIKE 'PROLG.%'
							OR		C1.calle LIKE 'PROLONG%'
							OR		C1.calle LIKE 'PROLONGACION%'
							THEN	'00021'
							
							WHEN	C1.calle LIKE 'RETORNO%'
							THEN	'00022'
							
							WHEN	C1.calle LIKE 'PEATONAL%'
							THEN	'00023'
							
							ELSE	'00005'
						END
					AS VIALIDAD		
			FROM
					(SELECT	DISTINCT 
								CASE	
									WHEN	SBC.codcalle = '2479'
									THEN	'0284'
									WHEN	SBC.codcalle = '0439'
									THEN	'0438'
									WHEN	SBC.codcalle = 2564
									THEN	'2537'
									WHEN	SBC.codcalle = 2770
									THEN	'2765'
									WHEN	SBC.codcalle = 2081
									THEN	'2080'
									
									WHEN	SBC.codcalle = 2131	
									AND		SBC.calle = 'CJON DEL CHIRIMOYO ESQ CJON DEL ROBLE   '
									THEN	'3901'
									WHEN	SBC.codcalle = 2277	
									AND		SBC.calle = 'PRIVADA EUCALIPTO                       '
									THEN	'3902'
									WHEN	SBC.codcalle = 2644	
									AND		SBC.calle = '1RA CERRADA JACARANDA                   '
									THEN	'3903'
									WHEN	SBC.codcalle = 2715	
									AND		SBC.calle = 'CALLE POST A DEP ARNULFO VAZQUEZ NIETO  '
									THEN	'3904'		
									WHEN	SBC.codcalle = 2304
									AND		SBC.calle = 'FRACC CARTOGRAFOS                       '
									THEN	'3905'
									WHEN	SBC.codcalle = 2729
									AND		SBC.calle = 'CIRCUITO AMEALCO                        '
									THEN	'3906'
																	
									ELSE	SBC.codcalle
								END
							AS CODCALLE,
								CASE																	
									WHEN	SBC.codcalle = 1642	
									THEN	 'CJON CONTRA PRESA DEL VENADO            '
									ELSE	SBC.calle
								END
							AS CALLE					
					 FROM	Simapag_09_01_2016.dbo.calle
					 AS		SBC
					 WHERE	SBC.calle <> '')
			AS		C1
			
			
UPDATE Simapag_20161015.dbo.Cat_Cor_Calles SET NOMBRE = dbo.fELIMINAR_VIALIDAD(NOMBRE)

--------------------------------------------------------------------------------------
--		      MAPEO DE DATOS TABLA: GIROS-ACTIVIDADES (ADECUACIONES)                --
--------------------------------------------------------------------------------------
--	NO SCRIPT AJEC:			02
--	TIEMPO EJECUCION:		00:00:00
--	REGISTROS MANIPULADOS:	
--	REGISTROS MIGRADOS:		265
---ejecutar en master

INSERT INTO Simapag_20161015.dbo.Cat_Cor_Giros_Actividades
			(Actividad_Giro_ID, Giro_ID, Clave, Nombre, Descripcion,
			 Usuario_Creo, Fecha_Creo)

			SELECT		
						RIGHT('0000000000'+ LTRIM(RTRIM(STR(ROW_NUMBER() OVER(ORDER BY SBC1.actividad, SBC2.actividad, SBC1.GIRO ASC)))), 10)
					AS ID,
						(SELECT	SBCA.GIRO_ID
						 FROM	Simapag_20161015.dbo.Cat_Cor_Giros
						 AS		SBCA
						 WHERE	SBCA.Clave = SBC1.GIRO)
					AS GIRO_ID,
						SBC2.codactividad
					AS CLAVE,
						CASE
							WHEN	SBC1.GIRO = 'AC'
							AND		SBC2.actividad IN('CASA HABITACION')
							THEN	'CASA HABITACION EN CONSTRUCCION'
							ELSE	RTRIM(SBC2.actividad) + SPACE(1) + RTRIM((SELECT	SBCA.Nombre_Giro
																			  FROM		Simapag_20161015.dbo.Cat_Cor_Giros
																			  AS		SBCA
																			  WHERE		SBCA.Comentarios = SBC1.GIRO))
						END
					AS ACTIVIDAD,
						SBC1.GIRO
					AS DESCRIPCION,
						'MIGRACION'
					AS U_CREO,
						GETDATE()
					AS F_CREO
					
			FROM
					(SELECT	DISTINCT 
							SBCA.actividad,
								dbo.fCAMBIAR_TARIFA(	SBCA.tarifa, 'G')
							AS	GIRO 
					 FROM	Simapag_09_01_2016.dbo.recibos
					 AS		SBCA)
			AS		SBC1

			INNER JOIN

					(SELECT	*
					 FROM	Simapag_09_01_2016.dbo.actividad
					 AS		SBCA)
			AS		SBC2
			ON		SBC1.actividad = SBC2.codactividad			

-- ===========================================
-- ===========  CONCEPTOS_COBRO  ============= Listo
-- ===========================================

INSERT INTO Cat_Cor_Conceptos_Cobros SELECT * FROM Simapag.dbo.Cat_Cor_Conceptos_Cobros
-- OR
-- ARCHIVO: Tablas Para Exportar a SQL.xlsx

UPDATE Cat_Cor_Conceptos_Cobros SET Nombre = REPLACE(Nombre,'"','')

-----------------------------------------------------------------------------------------------------
--                   MAPEO DE DATOS TABLA: GRUPOS CONCEPTOS (ADECUACIONES)                         --
-----------------------------------------------------------------------------------------------------
--	NO SCRIPT AJEC:		02
--	REGISTROS MIGRADOS:
--	TIEMPO DE EJEC:		00.00.00

INSERT INTO Simapag_20161015.dbo.Cat_Cor_Grupos_Conceptos 
			(GRUPO_CONCEPTO_ID, NOMBRE, USUARIO_CREO, FECHA_CREO, Giro_Concepto, giro_id)
			VALUES
			
			('00001','Agua, Drenaje, Sanamiento','Migración',GETDATE(),'DOMESTICO','0000000002'),
			('00003','Agua, Drenaje, Sanamiento','Migración',GETDATE(),'COMERCIAL','0000000001'),
			('00005','Agua, Drenaje, Sanamiento','Migración',GETDATE(),'INDUSTRIAL','0000000003'),
			('00007','Agua, Drenaje, Sanamiento','Migración',GETDATE(),'PUBLICO','0000000005'),
			('00009','Agua, Drenaje, Sanamiento','Migración',GETDATE(),'SERVICIOS','0000000006'),
			('00011','Agua, Drenaje, Sanamiento','Migración',GETDATE(),'MIXTO','0000000004'),
			('00013','Agua, Drenaje, Sanamiento','Migración',GETDATE(),'CONSTRUCCION','0000000007'),
			('00014','Agua','Migración',GETDATE(),'CONSTRUCCION','0000000007'),
			('00002','Agua','Migración',GETDATE(),'DOMESTICO','0000000002'),
			('00004','Agua','Migración',GETDATE(),'COMERCIAL','0000000001'),
			('00006','Agua','Migración',GETDATE(),'INDUSTRIAL','0000000003'),
			('00008','Agua','Migración',GETDATE(),'PUBLICO','0000000005'),
			('00010','Agua','Migración',GETDATE(),'SERVICIOS','0000000006'),
			('00012','Agua','Migración',GETDATE(),'MIXTO','0000000004');
-- ===========================================
-- ================  AREAS  ================== Listo
-- ===========================================

INSERT INTO CAT_AREAS(AREA_ID,NOMBRE,ESTATUS,USUARIO_CREO,FECHA_CREO,DEPENDENCIA_ID)
VALUES ('00000','COMERCIALIZACION','ACTIVO','MIGRACION',GETDATE(),'00010')

-- ===========================================
-- =============  GRUPOS ROLES  ============== Listo
-- ===========================================

INSERT INTO APL_GRUPOS_ROLES (GRUPO_ROLES_ID,NOMBRE,COMENTARIOS,USUARIO_CREO,FECHA_CREO)
VALUES 
	('00001','ADMINISTRADOR SISTEMA','ADMINISTRADOR','MIGRACION',GETDATE()),
	('00002','JEFE DEPARTAMENTO','JEFE DEPARTAMENTO','MIGRACION',GETDATE()),
	('00003','RECURSOS HUMANOS','DEPTO RH','MIGRACION',GETDATE()),
	('00004','EMPLEADO','EMPLEADO','MIGRACION',GETDATE())

-- ===========================================
-- ================  ROLES  ================== Listo
-- ===========================================

INSERT INTO APL_CAT_ROLES (ROL_ID,NOMBRE,DESCRIPCION,USUARIO_CREO,FECHA_CREO,GRUPO_ROLES_ID)
VALUES 
	('00001','JEFE DE SISTEMAS','','MIGRACION',GETDATE(),'00001'),
	('00002','Cajero','','MIGRACION',GETDATE(),'00004'),
	('00003','Supervisor Cajero','','MIGRACION',GETDATE(),'00002'),
	('00004','JEFE ATENCION USUARIOS','SON LAS OPCIONES PARA EL JEFE DE ATENCION USUARIOS','MIGRACION',GETDATE(),'00002')


-- ===========================================	
-- ===============  EMPLEADOS  =============== Listo
-- ===========================================

--SELECT * FROM CAT_EMPLEADOS
INSERT INTO CAT_EMPLEADOS (EMPLEADO_ID,DEPENDENCIA_ID,NO_EMPLEADO,APELLIDO_PATERNO,APELLIDO_MATERNO,NOMBRE,CALLE,COLONIA,CIUDAD,ESTADO,SEXO,ESTATUS,USUARIO_CREO,FECHA_CREO,NO_IMSS,PASSWORD,ROL_ID,Distrito_ID)
VALUES 
	('0000000001','00002','2020','GONZALEZ','ROSALES','FLORENCIO'		,'NA','NA','00001','00001','MASCULINO'	,'ACTIVO','MIGRACION',GETDATE(),'328170939687','2020','00001','00001'),
	('0000000002','00002','2021','VALADEZ','SALAZAR','MA. CONSUELO'		,'NA','NA','00001','00001','FEMENINO'	,'ACTIVO','MIGRACION',GETDATE(),'956215300683','2021','00001','00001'),
	('0000000003','00002','2022','GUERRERO','ZAMARRIPA','ABRAHAM'		,'NA','NA','00001','00001','MASCULINO'	,'ACTIVO','MIGRACION',GETDATE(),'730932718431','2022','00001','00001'),
	('0000000004','00002','2023','SANCHEZ','IMPERIAL','JOSE MANUEL'		,'NA','NA','00001','00001','MASCULINO'	,'ACTIVO','MIGRACION',GETDATE(),'304147039498','2023','00001','00001'),
	('0000000005','00002','2024','HERNANDEZ','GALLARDO','MIGUEL PABLO'	,'NA','NA','00001','00001','MASCULINO'	,'ACTIVO','MIGRACION',GETDATE(),'471574252694','2024','00001','00001'),
	('0000000006','00002','2025','CHAVEZ','LOPEZ','VICTOR'				,'NA','NA','00001','00001','MASCULINO'	,'ACTIVO','MIGRACION',GETDATE(),'289363063533','2025','00001','00001'),
	('0000000007','00002','2026','ALCOCER','DIAZ','RAFAEL'				,'NA','NA','00001','00001','MASCULINO'	,'ACTIVO','MIGRACION',GETDATE(),'902215525371','2026','00001','00001'),
	('0000000008','00008','2027','BECERRA','RAZO','MONICA'				,'NA','NA','00001','00001','FEMENINO'	,'ACTIVO','MIGRACION',GETDATE(),'812092478054','2027','00001','00001'),
	('0000000009','00008','2028','TOVAR','AVENDAÑO','MA. DE LOS ANGELES','NA','NA','00001','00001','FEMENINO'	,'ACTIVO','MIGRACION',GETDATE(),'797507564920','2028','00001','00001'),
	('0000000010','00008','2029','BARRON','MARTINEZ','MAYRA YEDID'		,'NA','NA','00001','00001','FEMENINO'	,'ACTIVO','MIGRACION',GETDATE(),'241086584258','2029','00001','00001'),
	('0000000011','00008','2030','AVILA','SALAZAR','SANDRA'				,'NA','NA','00001','00001','FEMENINO'	,'ACTIVO','MIGRACION',GETDATE(),'434529573466','2030','00001','00001'),
	('0000000012','00008','2031','AVILA','','MARTINA'					,'NA','NA','00001','00001','FEMENINO'	,'ACTIVO','MIGRACION',GETDATE(),'422811836150','2031','00001','00001'),
	('0000000013','00008','2032','CAMACHO','CAMACHO','CARMEN'			,'NA','NA','00001','00001','FEMENINO'	,'INACTIVO','MIGRACION',GETDATE(),'136416329033','2032','00001','00001'),
	('0000000014','00004','2033','CHICO','SANCHEZ','CELIA'				,'NA','NA','00001','00001','FEMENINO'	,'ACTIVO','MIGRACION',GETDATE(),'761231945369','2033','00001','00001'),
	('0000000015','00004','2034','SOLIS','GODINEZ','OLGA LIDIA'			,'NA','NA','00001','00001','FEMENINO'	,'ACTIVO','MIGRACION',GETDATE(),'219452023009','2034','00001','00001'),
	('0000000016','00004','2035','PINEDA','SAUCEDO','MARIBEL'			,'NA','NA','00001','00001','FEMENINO'	,'ACTIVO','MIGRACION',GETDATE(),'858086842946','2035','00001','00001'),
	('0000000017','00004','2036','BRIONES','BUENO','ANA ROSA'			,'NA','NA','00001','00001','FEMENINO'	,'ACTIVO','MIGRACION',GETDATE(),'850287959886','2036','00001','00001'),
	('0000000018','00004','2037','AVILA','SALAZAR','ANTONIA'			,'NA','NA','00001','00001','FEMENINO'	,'ACTIVO','MIGRACION',GETDATE(),'716301895485','2037','00001','00001'),
	('0000000019','00004','2038','PORRAS','DIOSDADO','VERONICA'			,'NA','NA','00001','00001','FEMENINO'	,'ACTIVO','MIGRACION',GETDATE(),'692650875577','2038','00001','00001'),
	('0000000020','00004','2039','MACIAS','ARAIZA','JOSE GERARDO'		,'NA','NA','00001','00001','MASCULINO'	,'ACTIVO','MIGRACION',GETDATE(),'592491969965','2039','00001','00001'),
	('0000000021','00011','2040','CARRILLO','RAMIREZ','ALBERTO'			,'NA','NA','00001','00001','MASCULINO'	,'ACTIVO','MIGRACION',GETDATE(),'269732817504','2040','00001','00001'),
	('0000000022','00011','2041','SALDAÑA','LEDESMA','LUIS GERARDO'		,'NA','NA','00001','00001','MASCULINO'	,'ACTIVO','MIGRACION',GETDATE(),'747841974618','2041','00001','00001'),
	('0000000023','00004','2042','LOBATO','LOPEZ','JOSE DE JESUS'		,'NA','NA','00001','00001','MASCULINO'	,'ACTIVO','MIGRACION',GETDATE(),'821161556748','2042','00001','00001'),
	('0000000024','00004','2043','SANDOVAL','GONZALEZ','IMELDA ARACELY'	,'NA','NA','00001','00001','FEMENINO'	,'ACTIVO','MIGRACION',GETDATE(),'860937890631','2043','00001','00001'),
	('0000000025','00004','2044','HERRERA','HERNANDEZ','MA. GUADALUPE'	,'NA','NA','00001','00001','FEMENINO'	,'ACTIVO','MIGRACION',GETDATE(),'395678909134','2044','00001','00001'),
	('0000000026','00018','2045','GOMEZ','GARCIA','LETICIA'				,'NA','NA','00001','00001','FEMENINO'	,'ACTIVO','MIGRACION',GETDATE(),'262664246355','2045','00001','00001'),
	('0000000027','00020','2046','LARA','LONA','JOSE LARA'				,'NA','NA','00001','00001','MASCULINO'	,'ACTIVO','MIGRACION',GETDATE(),'948004971755','2046','00001','00001'),
	('0000000028','00005','1010','ADMINISTRADOR','DEL','SISTEMA'		,'NA','NA','00001','00001','MASCULINO'	,'ACTIVO','MIGRACION',GETDATE(),'425453453232','Passw0rd','00001','00001'),
	('0000000042','00004','2060','GUERRA','GONZALEZ','IRENE'			,'NA','NA','00001','00001','FEMENINO'	,'ACTIVO','MIGRACION',GETDATE(),'969376788152','2060','00001','00001'),
	('0000000043','00004','2061','CORTES','GUERRERO','NANCY GEORGINA'	,'NA','NA','00001','00001','FEMENINO'	,'ACTIVO','MIGRACION',GETDATE(),'589322581557','2061','00001','00001'),
	('0000000044','00004','2062','ROCHA','PEREZ','CINTHYA'				,'NA','NA','00001','00001','FEMENINO'	,'ACTIVO','MIGRACION',GETDATE(),'125868631257','2062','00001','00001')

-- Nuevos Usuarios... Se requiere saber la dependencia a la que pertenecen
	
	-- conflicto al insertar lecturistas
INSERT INTO CAT_EMPLEADOS (EMPLEADO_ID,DEPENDENCIA_ID,NO_EMPLEADO,APELLIDO_PATERNO,APELLIDO_MATERNO,NOMBRE,CALLE,COLONIA,CIUDAD,ESTADO,SEXO,ESTATUS,USUARIO_CREO,FECHA_CREO,Distrito_ID)
	VALUES 
	('0000000029','00002','2047','AGUILAR','MONTERO','VICTOR MANUEL'	,'NA','NA','00001','00001','MASCULINO','ACTIVO','MIGRACION',GETDATE(),'00001'),
	('0000000030','00002','2048','CHOWELL','GOMEZ','GERARDO'			,'NA','NA','00001','00001','MASCULINO','ACTIVO','MIGRACION',GETDATE(),'00001'),
	('0000000031','00002','2049','DOMINGUEZ','YEBRA','LORENZO'			,'NA','NA','00001','00001','MASCULINO','ACTIVO','MIGRACION',GETDATE(),'00001'),
	('0000000032','00002','2050','FLORES','MORENO','JORGE'				,'NA','NA','00001','00001','MASCULINO','ACTIVO','MIGRACION',GETDATE(),'00001'),
	('0000000033','00002','2051','GONZALEZ','CRUZ','JESUS CONRADO'		,'NA','NA','00001','00001','MASCULINO','ACTIVO','MIGRACION',GETDATE(),'00001'),
	('0000000034','00002','2052','LUNA','GRANADOS','JOSE ENRIQUE'		,'NA','NA','00001','00001','MASCULINO','ACTIVO','MIGRACION',GETDATE(),'00001'),
	('0000000035','00002','2053','MARTINEZ','MORENO','RODOLFO'			,'NA','NA','00001','00001','MASCULINO','ACTIVO','MIGRACION',GETDATE(),'00001'),
	('0000000036','00002','2054','MARTINEZ','RICO','GONZALO'			,'NA','NA','00001','00001','MASCULINO','ACTIVO','MIGRACION',GETDATE(),'00001'),
	('0000000037','00002','2055','PRIETO','GAMEZ','JOSE ANTONIO'		,'NA','NA','00001','00001','MASCULINO','ACTIVO','MIGRACION',GETDATE(),'00001'),
	('0000000038','00002','2056','RANGEL','HERNANDEZ','FRANCISCO'		,'NA','NA','00001','00001','MASCULINO','ACTIVO','MIGRACION',GETDATE(),'00001'),
	('0000000039','00002','2057','RODRIGUEZ','ROCHA','JUAN PABLO'		,'NA','NA','00001','00001','MASCULINO','ACTIVO','MIGRACION',GETDATE(),'00001'),
	('0000000040','00002','2058','RUIZ','ROCHA','NORBERTO RAMIRO'		,'NA','NA','00001','00001','MASCULINO','ACTIVO','MIGRACION',GETDATE(),'00001'),
	('0000000041','00002','2059','VENEGAS','PATLAN','ALFREDO'			,'NA','NA','00001','00001','MASCULINO','ACTIVO','MIGRACION',GETDATE(),'00001'),
	('0000000045','00013','2063','CHAVEZ','HERNADEZ','JUANA ADRIANA'	,'NA','NA','00001','00001','FEMENINO','ACTIVO','MIGRACION',GETDATE(),'00002'),
	('0000000046','00013','2064','LEDESMA','PRIETO','JUAN REMEDIOS'		,'NA','NA','00001','00001','MACULINO','ACTIVO','MIGRACION',GETDATE(),'00002'),
	('0000000047','00013','2065','ORDUÑA','MORALES','MASSIEL ESTEFANIA'	,'NA','NA','00001','00001','FEMENINO','ACTIVO','MIGRACION',GETDATE(),'00002'),
	('0000000048','00005','2066','CHAVEZ','LOPEZ','MARIA DEL CARMEN'	,'NA','NA','00001','00001','FEMENINO','ACTIVO','MIGRACION',GETDATE(),'00003'),
	('0000000049','00005','2067','IBARRA','GOMEZ','MARIBEL'				,'NA','NA','00001','00001','FEMENINO','ACTIVO','MIGRACION',GETDATE(),'00003'),
	('0000000050','00018','2068','IBARRA','GOMEZ','LAURA ALICIA'		,'NA','NA','00001','00001','FEMENINO','ACTIVO','MIGRACION',GETDATE(),'00004'),
	('0000000051','00018','2069','AGUILERA','CAUDILLO','EVANGELINA'		,'NA','NA','00001','00001','FEMENINO','ACTIVO','MIGRACION',GETDATE(),'00004'),
	('0000000052','00016','2070','RODRIGEZ','MEDRANO','ANA BERTA'		,'NA','NA','00001','00001','FEMENINO','ACTIVO','MIGRACION',GETDATE(),'00004')

-----------------------------------------------------------------------------------------------------
--          MAPEO DE DATOS TABLA: GRUPOS CONCEPTOS DETALLES (ADECUACIONES)                         --
-----------------------------------------------------------------------------------------------------
--	NO SCRIPT AJEC:		03
--	REGISTROS MIGRADOS: 28
--	TIEMPO DE EJEC:		00.00.00

INSERT INTO Simapag_20161015.dbo.Cat_Cor_Grupos_Conceptos_Detalles
			(GRUPO_CONCEPTO_ID,CONCEPTO_ID)

			SELECT	SBC1.GRUPO_CONCEPTO_ID, 
						SBC2.Concepto_ID 
					AS CONCEPTO
			FROM	Simapag_20161015.dbo.Cat_Cor_Grupos_Conceptos 
					AS SBC1,
					Simapag_20161015.dbo.Cat_Cor_Conceptos_Cobros 
					AS SBC2 
			WHERE	SBC1.NOMBRE LIKE '%Drenaje%' 
			AND		(SBC2.Nombre = 'DRENAJE' 
			OR		 SBC2.Nombre = 'SANEAMIENTO')


			UNION

					/*CONCULTA PARA ASIGNACION DE AGUA Y ASIGNAR EL AGUA COMERCIAL*/

			SELECT	SBC1.GRUPO_CONCEPTO_ID, 
						CASE SBC1.giro_id 
							WHEN	'0000000001'	/*VALOR CORRESPONDIENTE AL ID DEL DEL GIRO COMERCIAL*/ 
							THEN	'00010'			/*VALOR CORRESPONDIENTE AL ID DEL CONCEPTO DE AGUA COMERCCIAL*/ 
							ELSE	SBC2.Concepto_ID 
						END
					AS CONCEPTO
			FROM	Simapag_20161015.dbo.Cat_Cor_Grupos_Conceptos 
					AS SBC1,
					Simapag_20161015.dbo.Cat_Cor_Conceptos_Cobros 
					AS SBC2 
			WHERE	SBC2.Nombre = 'CONSUMO AGUA'
			ORDER BY SBC1.GRUPO_CONCEPTO_ID
			--ORDER BY GC.GRUPO_CONCEPTO_ID
			
			
UPDATE Cat_Cor_Grupos_Conceptos_Detalles SET CONCEPTO_ID = '00010' 
	WHERE GRUPO_CONCEPTO_ID NOT IN ('00001','00002') AND CONCEPTO_ID = '00001';


-- ========================================
-- ===========  DEPARTAMENTOS  ============ Listo
-- ========================================

INSERT INTO CAT_COR_DEPARTAMENTOS (DEPARTAMENTO_ID,AREA_ID,NOMBRE_DEPARTAMENTO,USUARIO_CREO,FECHA_CREO)
VALUES('00000','00000','COMERICIALIZACION','MIGRACION',GETDATE())

-- ========================================
-- =============  DISTRITOS  ============== Listo
-- ========================================

INSERT INTO CAT_COR_DISTRITOS (DISTRITO_ID,NOMBRE,direccion,COMENTARIOS,ESTATUS,USUARIO_CREO,FECHA_CREO,Empleado_ID)
VALUES 
	('00000','DISTRITO 0',NULL,'DISTRITO CERO','ACTIVO','MIGRACION',GETDATE(),NULL),
	('00001','DEPARTAMENTO DE MEDICION','MEDICION','MEDICION','ACTIVO','MIGRACION',GETDATE(),'0000000021'),
	('00002','DEPARTAMENTO OPERACION HIDRAULICA','OPERACION HIDRAULICA','OPERACION HIDRAULICA','ACTIVO','MIGRACION',GETDATE(),'0000000046'),
	('00003','DEPARTAMENTO ADMINISTRATIVO','DEPARTAMENTO ADMINISTRATIVO','DEPARTAMENTO ADMINISTRATIVO','ACTIVO','MIGRACION',GETDATE(),'0000000049'),
	('00004','DEPARTAMENTO DIRECCION GENERAL','DIRECCION GENERAL','DIRECCION GENERAL','ACTIVO','MIGRACION',GETDATE(),'0000000052')
	
--SELECT * FROM Simapag.dbo.CAT_COR_DISTRITOS


-- ========================================
-- ============  LECTURISTAS  ============= Listo
-- ========================================

--SELECT * FROM Cat_Cor_Lecturistas
INSERT INTO Cat_Cor_Lecturistas (LECTURISTA_ID,EMPLEADO_ID,ESTATUS,CLAVE,NOMBRE,USUARIO_CREO,FECHA_CREO)
VALUES 
	('00001','0000000029','ACTIVO','01','AGUILAR MONTERO VICTOR MANUEL','MIGRACION',GETDATE()),
	('00002','0000000030','ACTIVO','02','CHOWELL GOMEZ GERARDO','MIGRACION',GETDATE()),
	('00003','0000000031','ACTIVO','03','DOMINGUEZ YEBRA LORENZO','MIGRACION',GETDATE()),
	('00004','0000000032','ACTIVO','04','FLORES MORENO JORGE','MIGRACION',GETDATE()),
	('00005','0000000033','ACTIVO','05','GONZALEZ CRUZ JESUS CONRADO','MIGRACION',GETDATE()),
	('00006','0000000034','ACTIVO','06','LUNA GRANADOS JOSE ENRIQUE','MIGRACION',GETDATE()),
	('00007','0000000035','ACTIVO','07','MARTINEZ MORENO RODOLFO','MIGRACION',GETDATE()),
	('00008','0000000036','ACTIVO','08','MARTINEZ RICO GONZALO','MIGRACION',GETDATE()),
	('00009','0000000037','ACTIVO','09','PRIETO GAMEZ JOSE ANTONIO','MIGRACION',GETDATE()),
	('00010','0000000038','ACTIVO','10','RANGEL HERNANDEZ FRANCISCO','MIGRACION',GETDATE()),
	('00011','0000000039','ACTIVO','11','RODRIGUEZ ROCHA JUAN PABLO','MIGRACION',GETDATE()),
	('00012','0000000040','ACTIVO','12','RUIZ ROCHA NORBERTO RAMIRO','MIGRACION',GETDATE()),
	('00013','0000000041','ACTIVO','13','VENEGAS PATLAN ALFREDO','MIGRACION',GETDATE())


-- ===========================================
-- =============  RUTAS REPARTO  ============= Listo
-- ===========================================

INSERT INTO Cat_Cor_Rutas_Reparto SELECT * FROM Simapag.dbo.Cat_Cor_Rutas_Reparto
-- OR
-- ARCHIVO: Tablas Para Exportar a SQL
--------------------------------------------------------------------------------------
--                  MAPEO DE DATOS TABLA: BRIGADAS (ADECUACIONES)                   --
--------------------------------------------------------------------------------------
-- NOTA: SE DEBE DE CORROBOAR QUE EL DISTRITO SEGUIRA SIENDO EL MISMO, EN DADO CASO NO
--		 FUERA DE ESA MANERA SE DEBERA HACER LA INSERCION CORRESPONDIENTE AL DISTRITO.

-- PD: EL DISTRITO QUE SE MUESTRA DEBAJO YA FUE MIGRADO.	

--	NO SCRIPT AJEC:		05
--	REGISTROS MIGRADOS: 04
--	TIEMPO DE EJEC:		00.00.00

INSERT INTO Simapag_20161015.dbo.Cat_Cor_Brigadas
		   (Brigada_ID,Distrito_ID,Empleado_ID,Nombre_Brigada,
		    Comentarios,Clave_Brigada,Usuario_Creo,Fecha_Creo)
		    VALUES
		    ('00001','00001','0000000004','LECTURA y REPARTO','LECTURA y REPARTO','1','MIGRACION',GETDATE()),
			('00002','00001','0000000006','MEDICION',' MEDICION','2','MIGRACION',GETDATE()),
			('00003','00001','0000000005','CORTE RECONEXIÓN','CORTE RECONEXIÓN','3','MIGRACION',GETDATE()),
			('00004','00001','0000000007','CONTRATOS','CONTRATOS','4','MIGRACION',GETDATE());
			
--------------------------------------------------INSERT INTO Simapag_20161015.dbo.CAT_COR_DISTRITOS 
--------------------------------------------------			(DISTRITO_ID,NOMBRE,DIRECCION,COMENTARIOS,ESTATUS,Empleado_ID,USUARIO_CREO,FECHA_CREO)
--------------------------------------------------			VALUES
--------------------------------------------------			('00001','DEPARTAMENTO DE MEDICIÓN','MEDICIÓN','MEDICIÓN','ACTIVO','00021','MIGRACION',GETDATE())
			


--------------------------------------------------UPDATE Simapag_20161015.dbo.Cat_Cor_Brigadas 
--------------------------------------------------			SET DISTRITO_ID = '00001'
--------------------------------------------------			WHERE DISTRITO_ID = '00000'
			

-- ===========================================
-- ===============  COLONIAS  ================ Listo
-- ===========================================
--SELECT * FROM Cat_Cor_Colonias
INSERT INTO Cat_Cor_Colonias (COLONIA_ID, TIPO_COLONIA_ID, ZONA_ID, DISTRITO_ID,
NOMBRE, CODIGO_POSTAL, DESCRIPCION, USUARIO_CREO, FECHA_CREO)
SELECT colonia_id,tipo_colonia_id,zona_id,distrito_id,nombre,codigo_postal,descripcion,usuario_creo,fecha_creo 
FROM Simapag.dbo.Cat_Cor_Colonias
-- OR
-- ARCHIVO: Tablas Para Exportar a SQL

-- ===========================================
-- =============  TIPOS FALLAS  ============== Listo
-- ===========================================

INSERT INTO CAT_COR_TIPOS_FALLAS SELECT * FROM Simapag.dbo.CAT_COR_TIPOS_FALLAS WHERE BRIGADA_ID <> '00005'
-- OR
-- ARCHIVO: Tablas Para Exportar a SQL

-- ===========================================
-- =========  ACTUALIZACION COLONIA  ========= Listo
-- ===========================================
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'SN') WHERE NOMBRE = RTRIM('AV LUCAS ALAMAN                         ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'ZONA CENTRO') WHERE NOMBRE = RTRIM('BARRIO ALAMEDA                          ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'ZONA CENTRO') WHERE NOMBRE = RTRIM('BARRIO DE SAN LUISITO                   ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'ZONA CENTRO') WHERE NOMBRE = RTRIM('BO EMBAJADORAS                          ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'ZONA DEL CARRIZO') WHERE NOMBRE = RTRIM('BO GAVILANES                            ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'MARFIL') WHERE NOMBRE = RTRIM('BO LAS PALOMAS                          ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'ZONA CENTRO') WHERE NOMBRE = RTRIM('BO SAN CAYETANO                         ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'ZONA CENTRO') WHERE NOMBRE = RTRIM('BOULEVARD GUANAJUATO                    ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'CAÑADA DE  BUSTOS') WHERE NOMBRE = RTRIM('CAÑADA DE BUSTOS                        ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'MARFIL') WHERE NOMBRE = RTRIM('CARR GTO J ROSAS                        ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'PIPILA') WHERE NOMBRE = RTRIM('CARR PAN PIPILA-P DE LA OLLA            ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'CERRO DEL CUARTO') WHERE NOMBRE = RTRIM('CERRO DE GUIJAS                         ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'MARFIL') WHERE NOMBRE = RTRIM('CERRO DE LA CAMPANA                     ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'YERBABUENA') WHERE NOMBRE = RTRIM('CERRO DE LAS CARRERAS                   ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'SN') WHERE NOMBRE = RTRIM('CJTO HAB SAN JUAN DE RAYAS              ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'MARFIL') WHERE NOMBRE = RTRIM('COL ARROYO VERDE                        ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'MARFIL') WHERE NOMBRE = RTRIM('COL BUROCRATA                           ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'ZONA CENTRO') WHERE NOMBRE = RTRIM('COL CALZ DE GPE                         ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'YERBABUENA') WHERE NOMBRE = RTRIM('COL CAMINERA NUEVO GUANAJUATO           ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'PUEBLITO DE ROCHA') WHERE NOMBRE = RTRIM('COL CAMINO A LAS MOMIAS                 ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'CATA') WHERE NOMBRE = RTRIM('COL CATA -  MELLADO                     ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'PUEBLITO DE ROCHA') WHERE NOMBRE = RTRIM('COL CERRO DE LA ALDANA                  ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'CERRO DE LOS LEONES') WHERE NOMBRE = RTRIM('COL CERRO DE LOS LEONES                 ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'ZONA CENTRO') WHERE NOMBRE = RTRIM('COL CERRO DE SAN MIGUEL                 ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'CERRO DEL CUARTO') WHERE NOMBRE = RTRIM('COL CERRO DEL CUARTO                    ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'ZONA CENTRO') WHERE NOMBRE = RTRIM('COL CERRO DEL GALLO                     ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'EL HORMIGUERO') WHERE NOMBRE = RTRIM('COL CERRO EL HORMIGUERO                 ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'CARRIZO') WHERE NOMBRE = RTRIM('COL CERRO TROZADO                       ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'CARRIZO') WHERE NOMBRE = RTRIM('COL EL CARRIZO                          ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'MARFIL') WHERE NOMBRE = RTRIM('COL EL COYOTE                           ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'MARFIL') WHERE NOMBRE = RTRIM('COL EL EDEN                             ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'PUEBLITO DE ROCHA') WHERE NOMBRE = RTRIM('COL EL ENCINO                           ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'MARFIL') WHERE NOMBRE = RTRIM('COL EL MEZQUITAL                        ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'PASTITA') WHERE NOMBRE = RTRIM('COL EL ZAPOTE                           ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'SN') WHERE NOMBRE = RTRIM('COL INDECO                              ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'INSURGENTES') WHERE NOMBRE = RTRIM('COL INSURGENTES                         ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'CATA') WHERE NOMBRE = RTRIM('COL LA GUALDRA                          ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'PUEBLITO DE ROCHA') WHERE NOMBRE = RTRIM('COL LA LUZ                              ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'PUEBLITO DE ROCHA') WHERE NOMBRE = RTRIM('COL LA LUZ II                           ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'CARRIZO') WHERE NOMBRE = RTRIM('COL LA VENADA                           ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'CARRIZO') WHERE NOMBRE = RTRIM('COL LA VENADA Y GAVILANES               ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'MARFIL') WHERE NOMBRE = RTRIM('COL LAS AGUILAS                         ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'MARFIL') WHERE NOMBRE = RTRIM('COL LAS BATEAS                          ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'MARFIL') WHERE NOMBRE = RTRIM('COL LAS FLORES                          ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'ZONA CENTRO') WHERE NOMBRE = RTRIM('COL LAS HUERTAS                         ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'MARFIL') WHERE NOMBRE = RTRIM('COL LAS TERESAS                         ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'MARFIL') WHERE NOMBRE = RTRIM('COL LINDAVISTA                          ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'MARFIL') WHERE NOMBRE = RTRIM('COL LOMA DE LOS SANTOS                  ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'ZONA CENTRO') WHERE NOMBRE = RTRIM('COL LOMA DE POZUELOS                    ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'VALENCIANA') WHERE NOMBRE = RTRIM('COL LOMAS DE VELENCIANA                 ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'YERBABUENA') WHERE NOMBRE = RTRIM('COL LOMAS DEL PADRE                     ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'ZONA CENTRO') WHERE NOMBRE = RTRIM('COL LOS PASTITOS                        ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'MARFIL') WHERE NOMBRE = RTRIM('COL LOS TUMULTOS                        ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'PUEBLITO DE ROCHA') WHERE NOMBRE = RTRIM('COL MANUEL LEAL                         ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'MARFIL') WHERE NOMBRE = RTRIM('COL MARFIL                              ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'MELLADO') WHERE NOMBRE = RTRIM('COL MELLADO                             ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'SN') WHERE NOMBRE = RTRIM('COL MEZQUITE MOCHO                      ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'CATA') WHERE NOMBRE = RTRIM('COL MIN DE CATA                         ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'VALENCIANA') WHERE NOMBRE = RTRIM('COL MIN DE VALENCIANA                   ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'CERRO DEL CUARTO') WHERE NOMBRE = RTRIM('COL MODELO                              ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'MUNICIPIO LIBRE') WHERE NOMBRE = RTRIM('COL MUNICIPIO LIBRE                     ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'NORIA ALTA') WHERE NOMBRE = RTRIM('COL NORIA ALTA                          ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'SAN ISIDRO') WHERE NOMBRE = RTRIM('COL NUEVO SAN ISIDRO                    ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'MARFIL') WHERE NOMBRE = RTRIM('COL PALOMAS II                          ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'ZONA CENTRO') WHERE NOMBRE = RTRIM('COL PASEO DE LA PRESA                   ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'PASTITA') WHERE NOMBRE = RTRIM('COL PASTITA                             ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'MARFIL') WHERE NOMBRE = RTRIM('COL PEÑITAS                             ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'PASTITA') WHERE NOMBRE = RTRIM('COL PEÑOLERA                            ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'MARFIL') WHERE NOMBRE = RTRIM('COL PILOTO                              ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'YERBABUENA') WHERE NOMBRE = RTRIM('COL POZO DEL PADRE                      ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'ZONA CENTRO') WHERE NOMBRE = RTRIM('COL POZUELOS                            ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'ZONA CENTRO') WHERE NOMBRE = RTRIM('COL PRESA DE LA OLLA                    ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'PUEBLITO DE ROCHA') WHERE NOMBRE = RTRIM('COL PRESA DE ROCHA                      ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'PUEBLITO DE ROCHA') WHERE NOMBRE = RTRIM('COL PRESA DE ROCHA DE ABAJO             ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'MARFIL') WHERE NOMBRE = RTRIM('COL RESIDENCIAL MARFIL I                ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'CATA') WHERE NOMBRE = RTRIM('COL SAN CLEMENTE                        ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'ZONA CENTRO') WHERE NOMBRE = RTRIM('COL SAN JAVIER                          ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'PUEBLITO DE ROCHA') WHERE NOMBRE = RTRIM('COL SANTA FE                            ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'PUEBLITO DE ROCHA') WHERE NOMBRE = RTRIM('COL SANTA FE II                         ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'ZONA CENTRO') WHERE NOMBRE = RTRIM('COL SANTA GERTRUDIS                     ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'YERBABUENA') WHERE NOMBRE = RTRIM('COL SERVIDOR AGRARIO                    ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'PUEBLITO DE ROCHA') WHERE NOMBRE = RTRIM('COL TRASL DEL PANTEON                   ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'YERBABUENA') WHERE NOMBRE = RTRIM('COL VILLANUEVA                          ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'MARFIL') WHERE NOMBRE = RTRIM('COL VILLAS CERVANTINAS                  ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'YERBABUENA') WHERE NOMBRE = RTRIM('COL YERBABUENA                          ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'AGUA ZARCA') WHERE NOMBRE = RTRIM('COM AGUA ZARCA                          ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'CAJONES') WHERE NOMBRE = RTRIM('COM CAJONES                             ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'CERRITO DEL ORO') WHERE NOMBRE = RTRIM('COM CERRITO DEL ORO                     ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'CIENEGA DEL PREDEGAL') WHERE NOMBRE = RTRIM('COM CIENEGA DEL PEDREGAL                ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'CUEVAS') WHERE NOMBRE = RTRIM('COM DE CUEVAS                           ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'CASTILLO') WHERE NOMBRE = RTRIM('COM EL CASTILLO                         ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'PUENTECILLAS') WHERE NOMBRE = RTRIM('COM EL MALUCO                           ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'ZANGARRO') WHERE NOMBRE = RTRIM('COM EL ZANGARRO                         ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'LA POZA') WHERE NOMBRE = RTRIM('COM LA POZA                             ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'TRINIDAD') WHERE NOMBRE = RTRIM('COM LA TRINIDAD                         ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'CAJONES') WHERE NOMBRE = RTRIM('COM NUEVO CAJONES                       ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'PASO DE PERULES') WHERE NOMBRE = RTRIM('COM PASO DE PERULES                     ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'PUENTECILLAS') WHERE NOMBRE = RTRIM('COM PUENTECILLAS                        ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'YERBABUENA') WHERE NOMBRE = RTRIM('COM RANCHO SAN ISIDRO                   ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'YERBABUENA') WHERE NOMBRE = RTRIM('COM RANCHO SOLANO                       ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'SAN FRANCISCO DEL CHAPIN') WHERE NOMBRE = RTRIM('COM SAN FRANCISCO DEL CHAPIN            ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'SAN JOSE GRACIA') WHERE NOMBRE = RTRIM('COM SAN JOSE DE GRACIA                  ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'SAN JOSE DEL CHAPIN') WHERE NOMBRE = RTRIM('COM SAN JOSE DEL CHAPIN                 ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'SAN JOSE DEL RODEO') WHERE NOMBRE = RTRIM('COM SAN JOSE DEL RODEO                  ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'SAN JUAN DEL RODEO') WHERE NOMBRE = RTRIM('COM SAN JUAN DEL RODEO                  ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'SAN VICENTE DE LA CRUZ') WHERE NOMBRE = RTRIM('COM SAN VICENTE DE LA CRUZ              ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'SANTA ANA') WHERE NOMBRE = RTRIM('COM SANTA ANA                           ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'SANTA TERESA') WHERE NOMBRE = RTRIM('COM SANTA TERESA                        ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'YERBABUENA') WHERE NOMBRE = RTRIM('COM YERBABUENA                          ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'EL MICROBIO') WHERE NOMBRE = RTRIM('COM. EL MICROBIO                        ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'CARBONERA') WHERE NOMBRE = RTRIM('COMUNIDAD CARBONERA                     ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'TEJABAN') WHERE NOMBRE = RTRIM('COMUNIDAD EL TEJABAN                    ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'ZONA CENTRO') WHERE NOMBRE = RTRIM('CONDOMINIO LA BUFA                      ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'MARFIL') WHERE NOMBRE = RTRIM('CONDOMINIO VILLAS MANCHEGAS             ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'YERBABUENA') WHERE NOMBRE = RTRIM('CONJ HAB SANTA FE                       ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'YERBABUENA') WHERE NOMBRE = RTRIM('CONJ HAB SANTA FE 3ERA SECCION          ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'YERBABUENA') WHERE NOMBRE = RTRIM('CONJ HABIT SANTA FE II                  ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'SN') WHERE NOMBRE = RTRIM('CONJ HABIT VISTA DEL PASEO              ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'SN') WHERE NOMBRE = RTRIM('CONJ PRIVILEGIOS DE LA VISTA            ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'CERVERA') WHERE NOMBRE = RTRIM('EJIDO DE CERVERA                        ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'YERBABUENA') WHERE NOMBRE = RTRIM('EJIDO DE YERBABUENA                     ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'CERVERA') WHERE NOMBRE = RTRIM('EJIDO SAN JOSE DE CERVERA               ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'SANTIAGUILLO') WHERE NOMBRE = RTRIM('EX HDA DE SANTIAGUILLO                  ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'ZONA CENTRO') WHERE NOMBRE = RTRIM('FRAC MOLINO DE SANTA GERTRUDIS          ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'YERBABUENA') WHERE NOMBRE = RTRIM('FRAC SOLIDARIDAD GUANAJUATENSE          ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'YERBABUENA') WHERE NOMBRE = RTRIM('FRACC ALHONDIGA                         ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'YERBABUENA') WHERE NOMBRE = RTRIM('FRACC ALHONDIGA II                      ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'PUENTECILLAS') WHERE NOMBRE = RTRIM('FRACC ARBOLEDAS                         ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'MARFIL') WHERE NOMBRE = RTRIM('FRACC ASTAUG                            ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'VALENCIANA') WHERE NOMBRE = RTRIM('FRACC BALCONES DE LA ESPERANZA          ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'YERBABUENA') WHERE NOMBRE = RTRIM('FRACC BALCONES DE SANTA FE');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'ZONA CENTRO') WHERE NOMBRE = RTRIM('FRACC CAMINO REAL SANTA FE              ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'CERVERA') WHERE NOMBRE = RTRIM('FRACC CAÑADA DE CERVERA                 ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'MARFIL') WHERE NOMBRE = RTRIM('FRACC CAÑADA DEL CONDE                  ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'SN') WHERE NOMBRE = RTRIM('FRACC CARTOGRAFOS                       ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'ZONA CENTRO') WHERE NOMBRE = RTRIM('FRACC CASA COLORADA                     ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'MARFIL') WHERE NOMBRE = RTRIM('FRACC COCALECAS                         ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'PUENTECILLAS') WHERE NOMBRE = RTRIM('FRACC COLONIAL GUANAJUATO               ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'YERBABUENA') WHERE NOMBRE = RTRIM('FRACC CUMBRES DE SANTA FE               ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'MARFIL') WHERE NOMBRE = RTRIM('FRACC CUPULAS                           ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'MARFIL') WHERE NOMBRE = RTRIM('FRACC CUPULAS 3RA SECCION               ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'MARFIL') WHERE NOMBRE = RTRIM('FRACC DEL ARTE                          ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'MARFIL') WHERE NOMBRE = RTRIM('FRACC DEL BOSQUE                        ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'CERRO DE LOS LEONES') WHERE NOMBRE = RTRIM('FRACC DIEMECKE                          ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'YERBABUENA') WHERE NOMBRE = RTRIM('FRACC EL CAMPANARIO                     ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'MARFIL') WHERE NOMBRE = RTRIM('FRACC EL CERRITO                        ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'YERBABUENA') WHERE NOMBRE = RTRIM('FRACC EL ESTABLO                        ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'MARFIL') WHERE NOMBRE = RTRIM('FRACC EL LAUREL                         ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'CERVERA') WHERE NOMBRE = RTRIM('FRACC EL MANANTIAL                      ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'MARFIL') WHERE NOMBRE = RTRIM('FRACC EX-HDA SANTA TERESA               ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'YERBABUENA') WHERE NOMBRE = RTRIM('FRACC GRANADITAS                        ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'YERBABUENA') WHERE NOMBRE = RTRIM('FRACC IMP VIV TRAB SCT                  ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'YERBABUENA') WHERE NOMBRE = RTRIM('FRACC INDEPENDENCIA                     ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'MARFIL') WHERE NOMBRE = RTRIM('FRACC JARDINES DE LA HACIENDA           ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'YERBABUENA') WHERE NOMBRE = RTRIM('FRACC LA NUEVA ESPAÑA                   ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'MARFIL') WHERE NOMBRE = RTRIM('FRACC LAS BIZNAGAS                      ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'MARFIL') WHERE NOMBRE = RTRIM('FRACC LAS TERRAZAS                      ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'YERBABUENA') WHERE NOMBRE = RTRIM('FRACC LAS TROJES                        ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'CERVERA') WHERE NOMBRE = RTRIM('FRACC LOMAS DE CERVERA                  ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'MARFIL') WHERE NOMBRE = RTRIM('FRACC LOMAS DE MARFIL I                 ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'MARFIL') WHERE NOMBRE = RTRIM('FRACC LOMAS DE MARFIL II                ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'ZONA CENTRO') WHERE NOMBRE = RTRIM('FRACC LOMAS DE ZARAGOZA                 ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'MARFIL') WHERE NOMBRE = RTRIM('FRACC LOS ALCALDES                      ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'MARFIL') WHERE NOMBRE = RTRIM('FRACC LOS PINITOS                       ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'MARFIL') WHERE NOMBRE = RTRIM('FRACC LOS PINOS                         ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'MARFIL') WHERE NOMBRE = RTRIM('FRACC MARFIL DORADO                     ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'YERBABUENA') WHERE NOMBRE = RTRIM('FRACC MARTIRES 22 DE ABRIL              ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'MARFIL') WHERE NOMBRE = RTRIM('FRACC MIN DE LA HDA                     ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'SN') WHERE NOMBRE = RTRIM('FRACC NUEVA ESPAÑA                      ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'ZONA CENTRO') WHERE NOMBRE = RTRIM('FRACC NUEVO GUANAJUATO                  ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'YERBABUENA') WHERE NOMBRE = RTRIM('FRACC PICACHOS                          ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'YERBABUENA') WHERE NOMBRE = RTRIM('FRACC POZO DEL PADRE                    ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'MARFIL') WHERE NOMBRE = RTRIM('FRACC PRESA DE LOS SANTOS               ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'MARFIL') WHERE NOMBRE = RTRIM('FRACC PRESAS DE GUANAJUATO              ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'MARFIL') WHERE NOMBRE = RTRIM('FRACC PRIVADA DEL REAL                  ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'YERBABUENA') WHERE NOMBRE = RTRIM('FRACC RANCHO EL SOLANO                  ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'MARFIL') WHERE NOMBRE = RTRIM('FRACC REAL DE MARFIL                    ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'SN') WHERE NOMBRE = RTRIM('FRACC RESIDENCIAL LIBERTAD              ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'ZONA CENTRO') WHERE NOMBRE = RTRIM('FRACC RESIDENCIAL SAN JAVIER            ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'YERBABUENA') WHERE NOMBRE = RTRIM('FRACC RINCONADAS DE GTO                 ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'ZONA CENTRO') WHERE NOMBRE = RTRIM('FRACC SAN JAVIER                        ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'YERBABUENA') WHERE NOMBRE = RTRIM('FRACC SANTA FE                          ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'CERVERA') WHERE NOMBRE = RTRIM('FRACC SR. DE VILLASECA                  ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'YERBABUENA') WHERE NOMBRE = RTRIM('FRACC TIRIO COMUNIDAD URBANA            ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'MARFIL') WHERE NOMBRE = RTRIM('FRACC TRES ESTRELLAS                    ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'ZONA CENTRO') WHERE NOMBRE = RTRIM('FRACC UNIVERSITARIO                     ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'CERVERA') WHERE NOMBRE = RTRIM('FRACC VALLE DE SAN JOSE                 ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'SN') WHERE NOMBRE = RTRIM('FRACC VILLA HERMOSA                     ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'CERVERA') WHERE NOMBRE = RTRIM('FRACC VILLAS DE GUANAJUATO              ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'SN') WHERE NOMBRE = RTRIM('FRACC VISTA DEL PASEO                   ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'MARFIL') WHERE NOMBRE = RTRIM('GLORIETA GTO-SILAO-J ROSAS              ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'ZONA CENTRO') WHERE NOMBRE = RTRIM('GRANJAS LA BUFA                         ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'MARFIL') WHERE NOMBRE = RTRIM('GTO-SILAO KM 5.5 MARFIL                 ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'SN') WHERE NOMBRE = RTRIM('MEZQUITAL                               ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'SN') WHERE NOMBRE = RTRIM('PANTEON                                 ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'PUENTECILLAS') WHERE NOMBRE = RTRIM('PRESA LA PURISIMA                       ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'PUEBLITO DE ROCHA') WHERE NOMBRE = RTRIM('PUEBLITO DE ROCHA                       ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'MARFIL') WHERE NOMBRE = RTRIM('RESIDENCIAL MARFIL                      ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'SN') WHERE NOMBRE = RTRIM('SAN JOSE DEL MONTECILLO                 ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'SAN NICOLAS DEL CHAPIN') WHERE NOMBRE = RTRIM('SAN NICOLAS DEL CHAPIN                  ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'CUEVAS') WHERE NOMBRE = RTRIM('SANTA CATARINA DE CUEVAS                ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'ZONA CENTRO') WHERE NOMBRE = RTRIM('UNIDAD ALHONDIGA                        ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'MARFIL') WHERE NOMBRE = RTRIM('VILLAHERMOSA MARFIL                     ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'ZONA CENTRO') WHERE NOMBRE = RTRIM('ZONA CENTRO                             ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'YERBABUENA') WHERE NOMBRE = RTRIM('ZONA YERBABUENA                         ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'CERVERA') WHERE NOMBRE = RTRIM('INDEPENDECIA                            ');
UPDATE Simapag_20161015.dbo.Cat_Cor_Colonias SET  ZONA_ID = (SELECT SBCA.ZONA_ID FROM  Simapag_20161015.dbo.CAT_COR_ZONAS AS SBCA WHERE  SBCA.DESCRIPCION = 'MARFIL') WHERE NOMBRE = RTRIM('MEZQUITAL                               ');


--------------------------------------------------------------------------------------
--               MAPEO DE DATOS TABLA: COLONIAS -CALLES (ADECUACIONES)              --
--------------------------------------------------------------------------------------
--	NO SCRIPT AJEC:			07
--	TIEMPO EJECUCION:		00:00:01
--	REGISTROS MIGRADOS:		4376

-- NOTA: LOS DATOS FUERON TOMADOS DE LA TABLA "PADRON", YA QUE ÉSTA CONTIENE INFROMACION
--		DE AMBAS.
--		ANTERIORMENTE SE HABIA GENERADO UNA SBCA APARA DETERMINAR LA COLONIA, DEBISO A SU
--		VALOR FALTANTE EN LOS REGISTROS.
--		ESTA ESTRUCTURA AMITE ESOS REGISTROS, POR LO QUE SE PODRA ADECUAR A SU NECESIDAD.

INSERT INTO Simapag_20161015.dbo.Cat_Cor_Calles_Colonias 
			(CALLE_COLONIA_ID, COLONIA_ID, CALLE_ID, VIALIDAD_ID,
			 COMENTARIOS, USUARIO_CREO, FECHA_CREO)

	SELECT 
			RIGHT('0000000000'+ LTRIM(RTRIM(STR(ROW_NUMBER() OVER(ORDER BY SBC4.COLONIA_ID, SBC4.CALLE_ID ASC )))),10 ) 
			AS ID,
			SBC4.COLONIA_ID,
			SBC4.CALLE_ID,
			SBC4.VIALIDAD_ID,
			SBC4.DESCRIPCION,
			SBC4.U_CREO,
			SBC4.F_CREO
	FROM
			(SELECT	DISTINCT
					--	RIGHT('0000000000'+ LTRIM(RTRIM(STR(ROW_NUMBER() OVER(ORDER BY SBC3.COLONIA_ID, SBC2.CALLE_ID ASC )))),10 ) 
					--AS ID,
					--(SELECT SBCA.COLONIA_ID FROM Simapag_20161015.dbo.Cat_Cor_Colonias AS SBCA WHERE SBCA.DESCRIPCION = SBC1.colonia) AS COLONIA,
					SBC3.COLONIA_ID,
					SBC2.CALLE_ID, 
					SBC2.VIALIDAD_ID,
						'CALLE-COLONIA'
					AS DESCRIPCION,
						'MIGRACION'
					AS U_CREO,
						GETDATE()
					AS F_CREO
					
			FROM	(SELECT	DISTINCT
							SBCA.ncolonia,
								CASE
									WHEN	ISNUMERIC(SBCA.calle) = 0
									THEN	(SELECT	TOP 1
													CASE
														WHEN	SBCA1.COMENTARIOS = '2479'
														THEN	'0284'
														WHEN	SBCA1.COMENTARIOS = '0439'
														THEN	'0438'
														WHEN	SBCA1.COMENTARIOS = '2564'
														THEN	'2537'
														WHEN	SBCA1.COMENTARIOS = '2770'
														THEN	'2765'
														WHEN	SBCA1.COMENTARIOS = '2081'
														THEN	'2080'
														ELSE	SBCA1.COMENTARIOS
													END		
											 FROM	Simapag_20161015.dbo.Cat_Cor_Calles
											 AS		SBCA1
											 WHERE	RTRIM(SBCA.ncalle) LIKE '%' + RTRIM(SBCA1.NOMBRE) + '%'
											 ORDER
											 BY		SBCA1.CALLE_ID)	
									WHEN	SBCA.calle = '2479'
									THEN	'0284'
									WHEN	SBCA.calle = '0439'
									THEN	'0438'
									WHEN	SBCA.calle = '2564'
									THEN	'2537'
									WHEN	SBCA.calle = '2770'
									THEN	'2765'
									WHEN	SBCA.calle = '2081'
									THEN	'2080'
									ELSE	SBCA.calle
								END
							AS CALLE,
								CASE
									WHEN	ISNUMERIC(SBCA.colonia) = 0
									THEN	(SELECT	TOP 1
													SBCA1.DESCRIPCION
											 FROM	Simapag_20161015.dbo.Cat_Cor_Colonias
											 AS		SBCA1
											 WHERE	RTRIM(REPLACE(SBCA.ncolonia, 'CONTRAPRESA DEL VENADO                  ', 'CJON CONTRA PRESA DEL VENADO            ')) LIKE '%' + RTRIM(SBCA1.NOMBRE) + '%'
											 ORDER
											 BY		SBCA1.COLONIA_ID)	
									ELSE	SBCA.colonia
								END
							AS COLONIA
					 FROM	Simapag_09_01_2016.dbo.padron
					 AS		SBCA)
			AS		SBC1

			INNER	JOIN

					Simapag_20161015.dbo.Cat_Cor_Calles
			AS		SBC2

			ON		SBC1.calle = SBC2.COMENTARIOS

			INNER	JOIN

					Simapag_20161015.dbo.Cat_Cor_Colonias
			AS		SBC3

			ON		SBC1.colonia = SBC3.DESCRIPCION )
		AS SBC4

--------------------------------------------------------------------------------------
--          MAPEO DE DATOS TABLA: COLONIAS - POBLACION (ADECUACIONES)               --
--------------------------------------------------------------------------------------
--	NO SCRIPT AJEC:			07
--	TIEMPO EJECUCION:		00:00:00
--	REGISTROS MANIPULADOS:	
--	REGISTROS MIGRADOS:		873

INSERT INTO Simapag_20161015.dbo.Cat_Cor_Colonia_Poblacion 
			(poblacion_id,colonia_id)

			SELECT	DISTINCT 
					SBC3.poblacion_id,
					SBC2.COLONIA_ID
			FROM	(SELECT	SBCA1.poblacion,
								CASE
									WHEN	SBCA1.colonia = ''
									THEN	(SELECT	SBCA.COLONIA_ID
											 FROM	Simapag_20161015.dbo.Cat_Cor_Colonias
											 AS		SBCA
											 WHERE	SBCA.NOMBRE = SBCA1.ncolonia)
									ELSE	SBCA1.colonia
								END	
							AS COLONIA
					 FROM	Simapag_09_01_2016.dbo.padron
					 AS		SBCA1) 
			AS		SBC1 

			INNER	JOIN
					
					Simapag_20161015.dbo.Cat_Cor_Colonias 
			AS		SBC2 

			ON		SBC2.DESCRIPCION = SBC1.colonia

			INNER	JOIN
					
					Simapag_20161015.dbo.Cat_cor_Poblacion 
			AS		SBC3 
			  
			ON		SBC3.clave_poblacion = SBC1.poblacion 

			--WHERE	SBC1.poblacion < 35 
			ORDER
			BY		SBC2.COLONIA_ID

-- ===========================================
-- ===============  TARIFAS  ================= Listo
-- ===========================================

--SELECT * FROM Cat_Cor_Tarifas
INSERT INTO Cat_Cor_Tarifas (Tarifa_ID,Cuota_ID,Giro_ID,Nombre,Abreviatura,Clave,Rango_Inicial,Rango_Final,Estatus,Usuario_Creo,Fecha_Creo)
VALUES 
	('00001','00002','0000000002','DOMESTICO'			,'DO','1',0,100,'ACTIVO','MIGRACION',GETDATE()),
	('00002','00002','0000000003','INDUSTRIAL'			,'IN','2',0,100,'ACTIVO','MIGRACION',GETDATE()),
	('00003','00001','0000000002','FIJA 1 STA.TERESA'	,'T1','3',0,0,	'ACTIVO','MIGRACION',GETDATE()),
	('00004','00001','0000000001','COMERCIAL STA.TERESA','SC','4',0,0,	'ACTIVO','MIGRACION',GETDATE()),
	('00005','00002','0000000002','ESCUELAS PUBLICAS'	,'EP','5',0,100,'ACTIVO','MIGRACION',GETDATE()),
	('00006','00002','0000000004','MIXTA'				,'MX','6',0,100,'ACTIVO','MIGRACION',GETDATE()),
	('00007','00002','0000000001','COMERCIAL Y DE SERV'	,'CS','7',0,100,'ACTIVO','MIGRACION',GETDATE()),
	('00008','00001','0000000007','AGUA EN BLOQUE'		,'AB','8',0,0,	'ACTIVO','MIGRACION',GETDATE()),
	('00009','00001','0000000005','SERVICIOS PUBLICOS'	,'PU','9',0,0,	'ACTIVO','MIGRACION',GETDATE()),
	('00010','00001','0000000004','MIXTA BASICA'		,'MB','10',0,0,	'ACTIVO','MIGRACION',GETDATE()),
	('00011','00001','0000000007','AGUA PARA CONSTRUCCI','AC','11',0,0,	'ACTIVO','MIGRACION',GETDATE())
	
INSERT INTO Cat_Cor_Tarifas(Tarifa_ID,Abreviatura,Nombre,Cuota_ID,Giro_ID,Clave,Rango_Inicial,Rango_Final,Estatus,Usuario_Creo,Fecha_Creo)
 VALUES
('00012','JM'  ,null,'00001','0000000001','1',0,100,'INACTIVO','MIGRACION',GETDATE()),
('00013','CO'  ,'COMERCIAL','00001','0000000001','1',0,100,'INACTIVO','MIGRACION',GETDATE()),
('00014','F1'  ,null,'00001','0000000001','1',0,100,'INACTIVO','MIGRACION',GETDATE()),
('00015','F2'  ,null,'00001','0000000001','1',0,100,'INACTIVO','MIGRACION',GETDATE()),
('00016','F3'  ,null,'00001','0000000001','1',0,100,'INACTIVO','MIGRACION',GETDATE()),
('00017','FE'  ,null,'00001','0000000001','1',0,100,'INACTIVO','MIGRACION',GETDATE()),
('00018','FS'  ,null,'00001','0000000001','1',0,100,'INACTIVO','MIGRACION',GETDATE()),
('00019','CE'  ,'EMPLEADO','00001','0000000001','1',0,100,'INACTIVO','MIGRACION',GETDATE()),
('00020','SM'  ,'S.MUNICIPALES','00001','0000000001','1',0,100,'INACTIVO','MIGRACION',GETDATE()),
('00021','EN'  ,'CUOTA EMPLEADO','00001','0000000001','1',0,100,'INACTIVO','MIGRACION',GETDATE()),
('00022','SF'  ,'S.FEDERALES','00001','0000000001','1',0,100,'INACTIVO','MIGRACION',GETDATE()),
('00023','T2'  ,'FIJA 2 STA.TERESA','00001','0000000001','1',0,100,'INACTIVO','MIGRACION',GETDATE()),
('00024','SC'  ,'COMERCIAL STA.TERESA','00001','0000000001','1',0,100,'INACTIVO','MIGRACION',GETDATE()),
('00025','SC'  ,'COMERCIAL STA.TERESA','00001','0000000001','1',0,100,'INACTIVO','MIGRACION',GETDATE()),
('00026','SE'  ,'S.ESPECIALES','00001','0000000001','1',0,100,'INACTIVO','MIGRACION',GETDATE()),
('00027','CS'  ,'COMERCIAL STA.TERESA','00001','0000000001','1',0,100,'INACTIVO','MIGRACION',GETDATE()),
('00028','C2'  ,'F.COMERCIAL 2','00001','0000000001','1',0,100,'INACTIVO','MIGRACION',GETDATE()),
('00029','C3'  ,'F.COMERCIAL 3','00001','0000000001','1',0,100,'INACTIVO','MIGRACION',GETDATE()),
('00030','T3'  ,'FIJA 3 STA.TERESA','00001','0000000001','1',0,100,'INACTIVO','MIGRACION',GETDATE()),
('00031','T4'  ,'FIJA 4 STA.TERESA','00001','0000000001','1',0,100,'INACTIVO','MIGRACION',GETDATE()),
('00032','T5'  ,'FIJA 5 STA.TERESA','00001','0000000001','1',0,100,'INACTIVO','MIGRACION',GETDATE()),
('00033','C1'  ,'F.COMERCIAL2','00001','0000000001','1',0,100,'INACTIVO','MIGRACION',GETDATE()),
('00034','GA'  ,'SERVICIO GANADERO','00001','0000000001','1',0,100,'INACTIVO','MIGRACION',GETDATE()),
('00035','ID'  ,'INMUEBLE DESHABITADO','00001','0000000001','1',0,100,'INACTIVO','MIGRACION',GETDATE()),
('00036','M1'  ,'MIXTO FIJO 1','00001','0000000001','1',0,100,'INACTIVO','MIGRACION',GETDATE()),
('00037','M2'  ,'MIXTO FIJO 2','00001','0000000001','1',0,100,'INACTIVO','MIGRACION',GETDATE()),
('00038','M3'  ,'MIXTO FIJO 3','00001','0000000001','1',0,100,'INACTIVO','MIGRACION',GETDATE())



-- ===========================================
-- ===========  TARIFAS DETALLES  ============ Listo
-- ===========================================

-- ERROR EN EL IDENTITY_INSERT
INSERT INTO Cat_Cor_Tarifas_Detalles (tarifa_id,tipo_costo,cantidad,año,enero,febrero,
	marzo,abril,mayo,junio,julio,agosto,septiembre,octubre,noviembre,diciembre,estatus)
SELECT tarifa_id,tipo_costo,cantidad,año,enero,febrero,
	marzo,abril,mayo,junio,julio,agosto,septiembre,octubre,noviembre,diciembre,estatus 
FROM Simapag.dbo.Cat_Cor_Tarifas_Detalles
-- OR
-- ARCHIVO: Tablas Para Exportar a SQL
UPDATE cat_cor_tarifas_detalles SET tipo_costo = replace(tipo_costo,' ','_')


-----------------------------------------------------------------------------------------------------
--                        MAPEO DE DATOS TABLA: USUARIOS  (ADECUACIONES)                           --
-----------------------------------------------------------------------------------------------------

-- NOTA: LA MIGRACION SE LLEVARÁ A CABO CON AQUELLOS REGISTROS QUE TENGAN RPU Y NO SE REPITAN
--		 - EXISTIRA LA FALTA DE INFROMACION EN DIVERSOS CAMPOS
--		 - SE ALTERARÁ EL CAMPO DE NOMBRE PARA LA ACEPTACION DE INFROMACION NULLA

-- ¡ SE AÑADIRA EL CAMPO RPUM EL CUAL DEBE DE SER ELIMINADO AL FINALIZAR LA MIGRACION !

--ALTER TABLE Simapag_Pruebas.dbo.Cat_Cor_Usuarios ALTER COLUMN	RFC			varchar	(20)	NULL
--ALTER TABLE Simapag_Pruebas.dbo.Cat_Cor_Usuarios ALTER COLUMN	CALLE_ID	char	(5)		NULL
--ALTER TABLE Simapag_Pruebas.dbo.Cat_Cor_Usuarios ALTER COLUMN	CALLE		varchar	(100)	NULL
--ALTER TABLE Simapag_Pruebas.dbo.Cat_Cor_Usuarios ALTER COLUMN	COLONIA		varchar	(100)	NULL
--ALTER TABLE Simapag_Pruebas.dbo.Cat_Cor_Usuarios ALTER COLUMN	NO_INTERIOR	varchar	(20)	NULL
--ALTER TABLE Simapag_Pruebas.dbo.Cat_Cor_Usuarios ALTER COLUMN	NO_INTERIOR	varchar	(20)	NULL

--ALTER TABLE Simapag_20161015.dbo.Cat_Cor_Usuarios ADD RPUM VARCHAR(12) NULL
--ALTER TABLE Simapag_20161015.dbo.Cat_Cor_Usuarios ALTER COLUMN NOMBRE VARCHAR(255) NULL


--ALTER TABLE Simapag_Pruebas.dbo.Cat_Cor_Usuarios ALTER COLUMN	RFC			varchar	(20)	NULL
--ALTER TABLE Simapag_Pruebas.dbo.Cat_Cor_Usuarios ALTER COLUMN	CALLE_ID	char	(5)		NULL
--ALTER TABLE Simapag_Pruebas.dbo.Cat_Cor_Usuarios ALTER COLUMN	CALLE		varchar	(100)	NULL
--ALTER TABLE Simapag_Pruebas.dbo.Cat_Cor_Usuarios ALTER COLUMN	COLONIA		varchar	(100)	NULL
--ALTER TABLE Simapag_Pruebas.dbo.Cat_Cor_Usuarios ALTER COLUMN	NO_INTERIOR	varchar	(20)	NULL
--ALTER TABLE Simapag_Pruebas.dbo.Cat_Cor_Usuarios ALTER COLUMN	NO_INTERIOR	varchar	(20)	NULL

--	NO SCRIPT AJEC:			08
--	TIEMPO EJECUCION:		00:00:19
--	REGISTROS MIGRADOS:		39867

INSERT INTO Simapag_20161015.dbo.Cat_Cor_Usuarios 
			(USUARIO_ID, ESTADO_ID, CIUDAD_ID, CALLE_ID, COLONIA_ID, PAIS, ESTATUS, NOMBRE, APELLIDO_PATERNO, 
			 APELLIDO_MATERNO, RFC, RAZON_SOCIAL, CALLE, COLONIA, NO_EXTERIOR, NO_INTERIOR, TELEFONO_CASA, CORREO_ELECTRONICO,
			 Domicilio_Facturacion, Colonia_Facturacion, CP_Facturacion, Ciudad_Facturacion, Estado_Facturacion, 
			 ciudad_fiscal_id, estado_fiscal_id, USUARIO_CREO, FECHA_CREO,RPUM)


			SELECT	DISTINCT
						RIGHT('0000000000'+ LTRIM(RTRIM(STR(ROW_NUMBER() OVER(ORDER BY C1.rpu, C1.cuenta, C1.fecha_alta ASC )))),10 ) 
					AS ID,
						'00001' 
					AS ESTADO_ID,
						'00001' 
					AS CIUDAD_ID,
						(SELECT SBCA.CALLE_ID
						 FROM	Simapag_20161015.dbo.Cat_Cor_Calles
						 AS		SBCA
						 WHERE	SBCA.COMENTARIOS = dbo.fOBTENER_OLD_CALLE(C1.calle, C1.ncalle))
					AS CALLLE, 
						CASE 
							WHEN	C1.colonia NOT LIKE '' 
							THEN	(SELECT top 1	SBCA.COLONIA_ID 
									 FROM	Simapag_20161015.dbo.Cat_Cor_Colonias 
									 AS		SBCA 
									 WHERE	RTRIM(SBCA.DESCRIPCION) = RTRIM(C1.colonia))
							
						END 
					AS COLONIA,
						'MEXICO'
					AS PAIS,
						'ACTIVO'
					AS ESTATUS,
						CASE				
							WHEN	C1.amaterno = ''
							AND		C1.nombre1 = ''
							AND		C1.apaterno = ''
							THEN	RTRIM(LTRIM(C1.nombre)) 
							
							WHEN	C1.nombre1 = ''
							AND		C1.amaterno LIKE 'A%'
							AND		(C1.amaterno <> 'A ENCARNACION'
							AND		C1.amaterno <> 'ALIANZA')
							THEN	RTRIM(LTRIM(C1.amaterno)) 
							
							WHEN	C1.nombre1 = ''
							AND		C1.amaterno LIKE 'B%'
							AND		(C1.amaterno NOT LIKE 'BA%'
							AND		C1.amaterno NOT LIKE 'B %')
							THEN	RTRIM(LTRIM(C1.amaterno)) 
											
							WHEN	C1.nombre1 = ''
							AND		C1.amaterno LIKE 'C%'
							AND		(C1.amaterno LIKE 'C %'
							OR		C1.amaterno LIKE 'CAN%'
							OR		C1.amaterno LIKE 'CARL%'
							OR		C1.amaterno LIKE 'CARM%'
							OR		C1.amaterno LIKE 'CAT%'
							OR		C1.amaterno LIKE 'CAY%'
							OR		C1.amaterno LIKE 'CEC%'
							OR		C1.amaterno LIKE 'CONC%'
							OR		C1.amaterno LIKE 'CR%')
							THEN	RTRIM(LTRIM(REPLACE(REPLACE(C1.amaterno, 'C ', ''), 'CRUZ ', '')))
							
							WHEN	C1.nombre1 = ''
							AND		C1.amaterno LIKE 'D%'
							AND		(C1.amaterno NOT LIKE 'DE %'
							AND		C1.amaterno NOT LIKE 'DEL %')
							THEN	RTRIM(LTRIM(C1.amaterno)) 
							
							WHEN	C1.nombre1 = ''
							AND		C1.amaterno LIKE 'E%'
							AND		(C1.amaterno NOT LIKE 'EU%'
							AND		C1.amaterno NOT LIKE 'EST%'
							AND		C1.amaterno NOT LIKE 'ERS%'
							AND		C1.amaterno NOT LIKE 'ELP%'
							AND		C1.amaterno NOT LIKE 'EL %'
							AND		C1.amaterno NOT LIKE 'ENRIQUEZ%')
							THEN	RTRIM(LTRIM(C1.amaterno)) 
							
							WHEN	C1.nombre1 = ''
							AND		C1.amaterno LIKE 'F%'
							AND		(C1.amaterno NOT LIKE 'FED%'
							AND		C1.amaterno NOT LIKE 'FREY%')
							THEN	RTRIM(LTRIM(C1.amaterno)) 
							
							WHEN	C1.nombre1 = ''
							AND		C1.amaterno LIKE 'G%'
							AND		(C1.amaterno NOT LIKE 'GEN%'
							AND		C1.amaterno NOT LIKE 'GOB%'
							AND		C1.amaterno NOT LIKE 'GUAN%')
							THEN	RTRIM(LTRIM(REPLACE(C1.amaterno, 'G ', '')))
							
							WHEN	C1.nombre1 = ''
							AND		C1.amaterno LIKE 'J%'
							AND		(C1.amaterno NOT LIKE 'JAI%'
							AND		C1.amaterno NOT LIKE 'JAS%'
							AND		C1.amaterno NOT LIKE 'JG%')
							THEN	RTRIM(LTRIM(REPLACE(C1.amaterno, 'J ', '')))
							
							WHEN	C1.nombre1 = ''
							AND		C1.amaterno LIKE 'L%'
							AND		(C1.amaterno NOT LIKE 'LA%'
							AND		C1.amaterno NOT LIKE 'LEG%'
							AND		C1.amaterno NOT LIKE 'LOP%'
							AND		C1.amaterno NOT LIKE '%GTO')
							THEN	RTRIM(LTRIM(C1.amaterno)) 
							
							WHEN	C1.nombre1 = ''
							AND		C1.amaterno LIKE 'M%'
							AND		(C1.amaterno  NOT LIKE '%CDS'
							AND		C1.amaterno  NOT LIKE '% PUB'
							AND		C1.amaterno  NOT LIKE '%NO'
							AND		C1.amaterno  NOT LIKE 'ME%'
							AND		C1.amaterno  NOT LIKE 'MO%'
							AND		C1.amaterno  NOT LIKE 'MU%')
							THEN	RTRIM(LTRIM(C1.amaterno)) 
							
							WHEN	C1.nombre1 = ''
							AND		C1.amaterno LIKE 'N%'
							THEN	RTRIM(LTRIM(REPLACE(C1.amaterno, 'N ', '')))
							
							WHEN	C1.nombre1 = ''
							AND		C1.amaterno LIKE 'O%'
							AND		C1.amaterno NOT LIKE 'OR%'
							THEN	RTRIM(LTRIM(C1.amaterno)) 
							
							WHEN	C1.nombre1 = ''
							AND		C1.amaterno LIKE 'P%'
							AND		(C1.amaterno  LIKE 'PA%'
							OR		C1.amaterno  LIKE '%RO'
							OR		C1.amaterno  LIKE 'PR%')
							THEN	RTRIM(LTRIM(C1.amaterno)) 
							
							WHEN	C1.nombre1 = ''
							AND		C1.amaterno LIKE 'R%'
							AND		C1.amaterno NOT LIKE 'REFO%'
							THEN	RTRIM(LTRIM(REPLACE(C1.amaterno, 'R ', '')))
							
							WHEN	C1.nombre1 = ''
							AND		C1.amaterno LIKE 'S%'
							AND		C1.amaterno NOT LIKE 'S U%'
							AND		(C1.amaterno LIKE '%NA'
							OR		C1.amaterno LIKE 'SALV%'
							OR		C1.amaterno LIKE 'SAR%'
							OR		C1.amaterno LIKE 'SERG%'
							OR		C1.amaterno LIKE 'S %')
							THEN	RTRIM(LTRIM(REPLACE(C1.amaterno, 'S ', '')))
							
							WHEN	C1.nombre1 = ''
							AND		C1.amaterno LIKE 'T%'
							AND		(C1.amaterno  NOT LIKE 'TA%'
							AND		C1.amaterno  NOT LIKE 'TEC%')
							THEN	RTRIM(LTRIM(C1.amaterno)) 
							
							WHEN	C1.nombre1 = ''
							AND		C1.amaterno LIKE 'V%'
							AND		(C1.amaterno NOT LIKE 'VIB%'
							AND		C1.amaterno  NOT LIKE 'VIG%')
							THEN	RTRIM(LTRIM(C1.amaterno)) 
							
							
							WHEN	C1.nombre1 = ''
							AND		C1.amaterno LIKE 'Y%'
							AND		C1.amaterno NOT LIKE 'Y %'
							THEN	RTRIM(LTRIM(C1.amaterno)) 
							
							ELSE	RTRIM(LTRIM(C1.nombre1)) 
						END
					AS NOMBRE, 
						CASE				
							WHEN	C1.amaterno = ''
							AND		C1.nombre1 = ''
							AND		C1.apaterno = ''
							THEN	RTRIM(LTRIM(C1.nombre)) 
							ELSE	RTRIM(LTRIM(C1.apaterno)) 
						END
					AS APATERNO, 
						CASE								
							WHEN	C1.amaterno = ''
							AND		C1.nombre1 = ''
							AND		C1.apaterno = ''
							THEN	C1.nombre
							
							WHEN	C1.amaterno = ''
							AND		C1.nombre1 = ''
							AND		C1.apaterno = ''
							THEN	''
							
							WHEN	C1.nombre1 = ''
							AND		C1.amaterno LIKE 'A%'
							AND		(C1.amaterno <> 'A ENCARNACION'
							AND		C1.amaterno <> 'ALIANZA')
							THEN	''
							
							WHEN	C1.nombre1 = ''
							AND		C1.amaterno LIKE 'B%'
							AND		(C1.amaterno NOT LIKE 'BA%'
							AND		C1.amaterno NOT LIKE 'B %')
							THEN	''
											
							WHEN	C1.nombre1 = ''
							AND		C1.amaterno LIKE 'C%'
							AND		(C1.amaterno LIKE 'C %'
							OR		C1.amaterno LIKE 'CAN%'
							OR		C1.amaterno LIKE 'CARL%'
							OR		C1.amaterno LIKE 'CARM%'
							OR		C1.amaterno LIKE 'CAT%'
							OR		C1.amaterno LIKE 'CAY%'
							OR		C1.amaterno LIKE 'CEC%'
							OR		C1.amaterno LIKE 'CONC%'
							OR		C1.amaterno LIKE 'CR%')
							THEN	''
							
							WHEN	C1.nombre1 = ''
							AND		C1.amaterno LIKE 'D%'
							AND		(C1.amaterno NOT LIKE 'DE %'
							AND		C1.amaterno NOT LIKE 'DEL %')
							THEN	''
							
							WHEN	C1.nombre1 = ''
							AND		C1.amaterno LIKE 'E%'
							AND		(C1.amaterno NOT LIKE 'EU%'
							AND		C1.amaterno NOT LIKE 'EST%'
							AND		C1.amaterno NOT LIKE 'ERS%'
							AND		C1.amaterno NOT LIKE 'ELP%'
							AND		C1.amaterno NOT LIKE 'EL %'
							AND		C1.amaterno NOT LIKE 'ENRIQUEZ%')
							THEN	''
							
							WHEN	C1.nombre1 = ''
							AND		C1.amaterno LIKE 'F%'
							AND		(C1.amaterno NOT LIKE 'FED%'
							AND		C1.amaterno NOT LIKE 'FREY%')
							THEN	''
							
							WHEN	C1.nombre1 = ''
							AND		C1.amaterno LIKE 'G%'
							AND		(C1.amaterno NOT LIKE 'GEN%'
							AND		C1.amaterno NOT LIKE 'GOB%'
							AND		C1.amaterno NOT LIKE 'GUAN%')
							THEN	''
							
							WHEN	C1.nombre1 = ''
							AND		C1.amaterno LIKE 'J%'
							AND		(C1.amaterno NOT LIKE 'JAI%'
							AND		C1.amaterno NOT LIKE 'JAS%'
							AND		C1.amaterno NOT LIKE 'JG%')
							THEN	''
							
							WHEN	C1.nombre1 = ''
							AND		C1.amaterno LIKE 'L%'
							AND		(C1.amaterno NOT LIKE 'LA%'
							AND		C1.amaterno NOT LIKE 'LEG%'
							AND		C1.amaterno NOT LIKE 'LOP%'
							AND		C1.amaterno NOT LIKE '%GTO')
							THEN	''
							
							WHEN	C1.nombre1 = ''
							AND		C1.amaterno LIKE 'M%'
							AND		(C1.amaterno  NOT LIKE '%CDS'
							AND		C1.amaterno  NOT LIKE '% PUB'
							AND		C1.amaterno  NOT LIKE '%NO'
							AND		C1.amaterno  NOT LIKE 'ME%'
							AND		C1.amaterno  NOT LIKE 'MO%'
							AND		C1.amaterno  NOT LIKE 'MU%')
							THEN	''
							
							WHEN	C1.nombre1 = ''
							AND		C1.amaterno LIKE 'N%'
							THEN	''
							
							WHEN	C1.nombre1 = ''
							AND		C1.amaterno LIKE 'O%'
							AND		C1.amaterno NOT LIKE 'OR%'
							THEN	''
							
							WHEN	C1.nombre1 = ''
							AND		C1.amaterno LIKE 'P%'
							AND		(C1.amaterno  LIKE 'PA%'
							OR		C1.amaterno  LIKE '%RO'
							OR		C1.amaterno  LIKE 'PR%')
							THEN	''
							
							WHEN	C1.nombre1 = ''
							AND		C1.amaterno LIKE 'R%'
							AND		C1.amaterno NOT LIKE 'REFO%'
							THEN	''
							
							WHEN	C1.nombre1 = ''
							AND		C1.amaterno LIKE 'S%'
							AND		C1.amaterno NOT LIKE 'S U%'
							AND		(C1.amaterno LIKE '%NA'
							OR		C1.amaterno LIKE 'SALV%'
							OR		C1.amaterno LIKE 'SAR%'
							OR		C1.amaterno LIKE 'SERG%'
							OR		C1.amaterno LIKE 'S %')
							THEN	''
							
							WHEN	C1.nombre1 = ''
							AND		C1.amaterno LIKE 'T%'
							AND		(C1.amaterno  NOT LIKE 'TA%'
							AND		C1.amaterno  NOT LIKE 'TEC%')
							THEN	''
							
							WHEN	C1.nombre1 = ''
							AND		C1.amaterno LIKE 'V%'
							AND		(C1.amaterno NOT LIKE 'VIB%'
							AND		C1.amaterno  NOT LIKE 'VIG%')
							THEN	''
							
							
							WHEN	C1.nombre1 = ''
							AND		C1.amaterno LIKE 'Y%'
							AND		C1.amaterno NOT LIKE 'Y %'
							THEN	''
							
							ELSE	RTRIM(LTRIM(C1.amaterno))
						END						
					AS APMATERNO,  		
					--AS NOMBRE_COMERCIAL,
					C1.rfc, 
						C1.nombref
					AS RAZON_SOCIAL,
							(SELECT TOP 1	SBCA.NOMBRE 
							 FROM	Simapag_20161015.dbo.Cat_Cor_Calles 
							 AS		SBCA 
							 WHERE	RTRIM(SBCA.COMENTARIOS) = RTRIM(C1.calle))
					AS NOMBRE_CALLE,
						(SELECT TOP 1	SBCA.NOMBRE 
						 FROM	Simapag_20161015.dbo.Cat_Cor_Colonias 
						 AS		SBCA 
						 WHERE	RTRIM(SBCA.DESCRIPCION) = RTRIM(C1.colonia))
					AS NOMBRE_COLONIA,
						DBO.fOBTENER_NUMERO_EXTERIORV3(C1.num_ext)
					AS NUM_EXT,
					C1.num_int,
						C1.telefono 
					AS TELL_CASA, 
						C1.email
					AS CORREO_ELECTRONICO,
						C1.callef
					AS DOMICILIO_FACT,
						C1.coloniaf
					AS COLONIA_FACT,
						C1.cpf
					AS CP_FACT,
						C1.ciudadf
					AS CUIDAD_FACT,
						C1.estadof
					AS ESTADO_FACAT,
					--nu_ext_fiscal
					--nu_int_fiscal
						'00001' 
					AS CIUDAD_FISCAL,
						'00001' 
					AS EDO_FISCAL,
						'MIGRACION' 
					AS U_CREO, 
						GETDATE()
					AS F_CREO,
					C1.RPU 
				

			FROM	Simapag_09_01_2016.dbo.padron 
			AS		C1
			WHERE	C1.rpu IS NOT NULL
			AND		C1.rpu <> ''
			ORDER 
			BY		ID
-- ===========================================
-- ================  PREDIOS  ================ listo
-- ===========================================

--CHECAR CAMPO CLAVE ENVIO

--SELECT Clave_Envio FROM Cat_Cor_Predios

--ALTER TABLE Cat_Cor_Predios
--alter COLUMN clave_envio char(2)

-- ARCHIVO: MIGRACION_PREDIOS

--SELECT Datos_Complementarios FROM Cat_Cor_Predios WHERE Datos_Complementarios LIKE '%"%'
UPDATE Cat_Cor_Predios SET Datos_Complementarios = REPLACE(Datos_Complementarios,'"','')

UPDATE Cat_Cor_Predios SET Fosa_Septica = 'SI' WHERE Fosa_Septica = '1'
UPDATE Cat_Cor_Predios SET Fosa_Septica = 'NO' WHERE Fosa_Septica = '0'
UPDATE Cat_Cor_Predios SET Descuento_Empleado = 'SI' WHERE Descuento_Empleado = '1'
UPDATE Cat_Cor_Predios SET Descuento_Empleado = 'NO' WHERE Descuento_Empleado = '0'
UPDATE Cat_Cor_Predios SET Subsidio = 'SI' WHERE Subsidio = '1'
UPDATE Cat_Cor_Predios SET Subsidio = 'NO' WHERE Subsidio = '0'

UPDATE Cat_Cor_Predios SET Aplica_Aportacion = 
(SELECT
 CASE 
	WHEN subsidio <> 0
	THEN 'NO'
	ELSE 'SI'
 END AS aportacion
 FROM Simapag_09_01_2016.dbo.padron 
 WHERE rpu = Cat_Cor_Predios.RPU)
-- ===========================================
-- ==========  PREDIOS - MEDIDORES  ========== Listo
-- ===========================================
--USE Simapag_res
--INSERT INTO Cat_Cor_Predios_Medidores (PREDIO_ID,MEDIDOR_ID,LECTURA_INICIAL,FECHA_INSTALACION,COLONIA_ID,CALLE_ID)
--SELECT --P.nummedidor,P.rpu,
--	(SELECT TOP 1 Pr.Predio_ID FROM Cat_Cor_Predios Pr WHERE P.rpu = Pr.RPU),
--	(SELECT TOP 1 M.MEDIDOR_ID FROM Cat_Cor_Medidores M WHERE M.NO_MEDIDOR = P.nummedidor),
--	0,
--	CASE
--		WHEN YEAR(P.fechainst)<1900 THEN '1991-01-01'
--		ELSE P.fechainst
--	END,		
--	(SELECT TOP 1 COLONIA_ID FROM Cat_Cor_Colonias Co WHERE Co.DESCRIPCION = P.colonia),
--	(SELECT TOP 1 CALLE_ID FROM Cat_Cor_Calles Ca WHERE Ca.COMENTARIOS = P.calle)
--FROM Simapag_09_01_2016.dbo.padron P 
--WHERE P.nummedidor <> '' AND P.rpu IN (SELECT Pr.RPU FROM Cat_Cor_Predios Pr WHERE P.rpu = Pr.RPU) 
--AND (SELECT TOP 1 M.MEDIDOR_ID FROM Cat_Cor_Medidores M WHERE M.NO_MEDIDOR = P.nummedidor) IS NOT NULL

--DELETE FROM Simapag_res.dbo.Cat_Cor_Predios_Medidores
--delete FROM Cat_Cor_Predios_Medidores
INSERT INTO Cat_Cor_Predios_Medidores--Simapag_20161015.dbo.Cat_Cor_Predios_Medidores 
	(PREDIO_ID,MEDIDOR_ID,LECTURA_INICIAL,FECHA_INSTALACION,COLONIA_ID,CALLE_ID)
SELECT 
	Pr.Predio_ID,
		(SELECT TOP 1 medidor_id FROM Cat_Cor_Medidores WHERE LTRIM(Pa.nummedidor) = NO_MEDIDOR)
	AS Medidor_ID,
	0 AS Lec_Inicial,
	CASE
		WHEN YEAR(Pa.fechainst)<1900 THEN '1991-01-01'
		ELSE Pa.fechainst
	END AS Fecha_inst,
	Pr.Colonia_ID,
	Pr.Calle_ID
FROM Simapag_09_01_2016.dbo.padron Pa JOIN Cat_Cor_Predios Pr
	ON Pa.rpu = Pr.RPU
WHERE Pa.nummedidor<>'' --AND (SELECT TOP 1 medidor_id FROM Cat_Cor_Medidores WHERE Pa.nummedidor = NO_MEDIDOR)IS NOT NULL


-- ============================================
-- ================  LECTURAS  ================ Listo 
-- ============================================

SET LANGUAGE 'Spanish'
INSERT INTO Simapag_20161015.dbo.Cat_Cor_Medidores_Lecturas_Detalles
			(Medidor_Detalle_ID, Predio_ID, No_Cuenta, Clave_Anomalia_ID_1,
			 Estatus, Facturado, Lectura, Lectura_Anterior, Lectura_Facturacion,
			 Consumo_Facturacion, Medidor_ID, Bimestre, Fecha_Lectura, Anio, No_Medidor,
			 Usuario_Creo, Fecha_Creo,Periodo_Inicial,Periodo_Final)

			SELECT	
					C1.ID,
					C1.PREDIO,
						CASE 
							WHEN	ISNUMERIC(C1.cuenta) = 1 
							THEN	CONVERT(NUMERIC,C1.cuenta)
						END
					AS CUENTA,
						CASE 
							WHEN	C1.anomalia NOT LIKE '' 
							THEN	(SELECT	TOP 1 
											SBCA.MOTIVO_NO_LECTURA_ID 
									 FROM	Simapag_20161015.dbo.Cat_Cor_Motivos_No_Lectura 
									 AS		SBCA 
									 WHERE	SBCA.CLAVE = C1.anomalia)
						 END
					AS MOTIVO_NO_LECTURA_ID,
						'APLICADA' 
					AS ESTATUS,
						CASE
							WHEN	 C1.fechalect LIKE '2016-10%'		-- <-- ES EL MES ACTUAL EN EL QUE NOS ENCONTRAMOS AL HACER LA MIGRACION 
							THEN	'NO'
							ELSE	'SI'
						END
					AS FACTURADO,
						CASE 
							WHEN	ISNUMERIC(C1.lectura) = 1 
							THEN	CONVERT(NUMERIC,C1.lectura)
						END
					AS LECTURA,
						CASE 
							WHEN	ISNUMERIC(C1.lecanterior) = 1 
							THEN	CONVERT(NUMERIC,C1.lecanterior)
						END
					AS LECTURA_ANTERIOR,
						CASE 
							WHEN	ISNUMERIC(C1.lectura) = 1 
							THEN	CONVERT(NUMERIC,C1.lectura)
						END
					AS LECTURA_FACTURACION,
						CASE 
							WHEN	ISNUMERIC(C1.consumo) = 1 
							THEN	CONVERT(NUMERIC,C1.consumo)				  
						END
					AS CONSUMO_FACTURACION,
						(SELECT		TOP 1 
									SBCA.MEDIDOR_ID 
						 FROM		Simapag_20161015.dbo.Cat_Cor_Predios_Medidores 
						 AS			SBCA 
						 WHERE		SBCA.PREDIO_ID = C1.PREDIO) 
					AS MEDIROR,	  	  
					     CASE
					         WHEN   ISDATE( LEFT(periodo, 10))=1 THEN
					                 MONTH( convert(datetime, LEFT(periodo, 10), 103))
					         ELSE
					            MONTH(dateadd(MONTH,-1,C1.fechalect))
					     END
					AS BIMESTRE,
                           fechalect
					AS FH_LECTURA,
						CASE 
							  WHEN   ISDATE( LEFT(periodo, 10))=1 THEN
					                  YEAR( convert(datetime, LEFT(periodo, 10), 103))
					         ELSE
					              YEAR(dateadd(MONTH,-1,C1.fechalect))
						END
					AS ANIO,
						(SELECT	SBCA.NO_MEDIDOR
						 FROM	Simapag_20161015.dbo.Cat_Cor_Medidores
						 AS		SBCA
						 WHERE	SBCA.MEDIDOR_ID = (SELECT	TOP	1
															SBCA2.MEDIDOR_ID
												   FROM		Simapag_20161015.dbo.Cat_Cor_Predios_Medidores
												   AS		SBCA2
												   WHERE	SBCA2.PREDIO_ID = C1.PREDIO))
					AS NO_MEDIDOR,
						'MIGRACION'
					U_CREO,
						GETDATE()
					F_CREO,
					CASE 
							  WHEN   ISDATE( LEFT(periodo, 10))=1 THEN
					                   convert(date, LEFT(periodo, 10), 103)
					         ELSE
					            dateadd(MONTH,-1,C1.fechalect)
				   END as [PERIODO_INICIAL],
				   	CASE 
							  WHEN   ISDATE( RIGHT(periodo, 10))=1 THEN
					                   convert(date, RIGHT(periodo, 10), 103)
					         ELSE
					            C1.fechalect
				   END as [PERIODO_FINAL]
					    
			FROM 
					(SELECT	 
								RIGHT('0000000000'+ LTRIM(RTRIM(STR(ROW_NUMBER() OVER(ORDER BY SBC1.fechalect, SBC1.rpu ASC )))),10 ) 
							AS ID,
								(SELECT	SBCA.Predio_ID 					   
								 FROM	Simapag_20161015.dbo.Cat_Cor_Predios 					   
								 AS		SBCA 					   
								 WHERE	SBCA.RPU = SBC1.rpu) 
							AS PREDIO, 
							SBC1.cuenta, 
							SBC1.anomalia, 
							SBC1.lectura, 
							SBC1.lecanterior, 
							SBC1.consumo, 
							SBC1.periodo, 
							SBC1.fechalect,
							SBC1.rpu
					 FROM	Simapag_09_01_2016.dbo.hislecturas 
					 AS		SBC1) 
			AS		C1
             --       WHERE C1.rpu='000030255165'
             --       ORDER by c1.fechalect DESC

--INSERT INTO Simapag_20161015.dbo.Cat_Cor_Medidores_Lecturas_Detalles
--			(Medidor_Detalle_ID, Predio_ID, No_Cuenta, Clave_Anomalia_ID_1,
--			 Estatus, Facturado, Lectura, Lectura_Anterior, Lectura_Facturacion,
--			 Consumo_Facturacion, Medidor_ID, Bimestre, Fecha_Lectura, Anio, No_Medidor,
--			 Usuario_Creo, Fecha_Creo,Periodo_Inicial,Periodo_Final)

--SELECT RIGHT('0000000000' + CAST(ROW_NUMBER() OVER(ORDER BY R.rpu) 
--		+(select isnull(max(Medidor_Detalle_ID), 0) from Simapag_20161015.dbo.Cat_Cor_Medidores_Lecturas_Detalles) AS VARCHAR(10)), 10),
--		P.Predio_ID,R.cuenta,null,'APLICADA','NO',R.lecactual,R.lecanterior,R.lecactual,R.consumo,
--		(SELECT TOP 1 SBCA.MEDIDOR_ID FROM Simapag_20161015.dbo.Cat_Cor_Predios_Medidores AS SBCA WHERE SBCA.PREDIO_ID = P.Predio_ID),
--		MONTH(dateadd(MONTH,-1,R.flecactual)),R.flecactual,year(dateadd(MONTH,-1,R.flecactual)),R.nummedidor,'MIGRACION',GETDATE(),
--		CASE WHEN   ISDATE( LEFT(periodo, 10))=1 THEN convert(date, LEFT(periodo, 10), 103)
--					         ELSE dateadd(MONTH,-1,R.flecactual) END,
--		CASE WHEN   ISDATE( RIGHT(periodo, 10))=1 THEN convert(date, RIGHT(periodo, 10), 103)
--					         ELSE R.flecactual END			         
--FROM Simapag_09_01_2016.dbo.recibos R JOIN Simapag_20161015.dbo.Cat_Cor_Predios P ON
--	R.rpu = P.rpu

--------------------------------------------------------------------------------------
--           MAPEO DE DATOS TABLA: ORDENES DE TRABAJO (ADECUACIONES)                --
--------------------------------------------------------------------------------------
--	NO SCRIPT AJEC:			10
--	TIEMPO EJECUCION:		00:00:33
--	REGISTROS MIGRADOS:		222365

--ALTER TABLE Simapag_20161015.dbo.OPE_COR_ORDENES_TRABAJO  ADD No_Suspension CHAR (10) NULL
--ALTER TABLE Simapag_20161015.dbo.OPE_COR_ORDENES_TRABAJO  ADD Pago_Reconexion BIT  NULL



INSERT INTO	Simapag_20161015.dbo.OPE_COR_ORDENES_TRABAJO
			(No_Orden_Trabajo, Folio, Distrito_ID, Fecha, Fecha_Trabajo, Fecha_Inicio, Hora_Inicio, Minutos_Inicio,
			 Fecha_Termino, 
			 Hora_Termino, Minutos_Termino, Telefono, Lectura, Bacheo, Brigada_ID, Empleado_ID,
			 Observaciones, Comentarios, Reporto, Tipo_Falla_ID, No_Cuenta, Estatus, Trabajo_Realizado, Usuario_ID, 
			 Predio_ID, Calle_ID, Calle_Referencia1_ID, Calle_Referencia2_ID, Colonia_ID)
			 
			 
			 SELECT	
						RIGHT('0000000000'+ LTRIM(RTRIM(STR(ROW_NUMBER() OVER(ORDER BY C1.folio ASC )))),10 ) 
					AS ID,
					C1.folio,
					'00001'
					AS DISTRITO_ID,
						CONVERT(DATE, C1.FECHA_CREACION)
					AS FECCHA_CREACION,	
						CONVERT(DATE, C1.FECHA_ATENCION)
					AS	FECHA_ATENCION,	
						CONVERT(DATE, C1.FECHA_ATENCION)
					AS FECHA_DE_INICIO,
					C1.HORA_INICIO,
					C1.MIN_INICIO,
						CONVERT(DATE, C1.FECHA_TERMINO)
					AS FECHA_TERMINO,
					C1.HORA_TERMINO,
					C1.MIN_TERMINO,
					C1.telefono,
					C1.lectura,
						'0' 
					AS BACHEO,
						'00002' 
					AS BRIGADA,
						'0000000021' 
					AS EMPLEADO,
						CASE
							WHEN	C1.OBSERVACIONES <> ''
							AND		C1.ORDEN <> ''
							THEN	'OBSVACIONES: ' + C1.OBSERVACIONES + ' / ORDEN: ' + C1.ORDEN
							
							WHEN	C1.OBSERVACIONES <> ''
							AND		C1.ORDEN = ''
							THEN	'OBSVACIONES: ' + C1.OBSERVACIONES
							
							WHEN	C1.OBSERVACIONES = ''
							AND		C1.ORDEN <> ''
							THEN	'ORDEN: ' + C1.ORDEN
							ELSE	''
						END			
					AS OBSERVACIONES,
						CASE
							WHEN	C1.ADICIONAL <> ''
							AND		C1.QUEJA <> ''
							THEN	'DIR: ' + C1.DOMICILIO + ' / ADICIONAL: ' + C1.ADICIONAL + ' / QUEJA: ' + C1.QUEJA
							
							WHEN	C1.ADICIONAL <> ''
							AND		C1.QUEJA = ''
							THEN	'DIR: ' + C1.DOMICILIO + ' / ADICIONAL: ' + C1.ADICIONAL 
							
							WHEN	C1.ADICIONAL = ''
							AND		C1.QUEJA <> ''
							THEN	'DIR: ' + C1.DOMICILIO + ' / QUEJA: ' + C1.QUEJA
							
							WHEN	C1.DOMICILIO <> ''
							THEN	'DIR: ' + C1.DOMICILIO
							
							ELSE	''
						END	
					AS COMENTARIOS,
						CASE
							WHEN	C1.REPORTO LIKE ''
							THEN	NULL
							ELSE	C1.REPORTO
						END
					AS REPORTO,
						CASE						
							WHEN	C1.COD_ORDEN = '84'
							THEN	'00084'
										
							WHEN	C1.COD_ORDEN = '68'
							THEN	'00068'
							
							WHEN	C1.COD_ORDEN = '85'
							OR		C1.COD_ORDEN IS NULL
							THEN	'00085'
							
							ELSE	(SELECT	TOP 1
											SBCA.TIPO_FALLA_ID
									 FROM	Simapag_20161015.dbo.CAT_COR_TIPOS_FALLAS
									 AS		SBCA
									 WHERE	SBCA.OBSERVACIONES = C1.COD_ORDEN
									 ORDER
									 BY		SBCA.TIPO_FALLA_ID DESC)
						END		
					AS	TIPO_FALLA,
						CASE
							WHEN	C1.cuenta LIKE '' 
							THEN	(SELECT	SBCA.No_Cuenta
									 FROM	Simapag_20161015.dbo.Cat_Cor_Predios 
									 AS		SBCA 
									 WHERE	SBCA.RPU = C1.rpu)
							ELSE	C1.cuenta
						END
					AS CUENTA,	
						CASE 
							WHEN	C1.atendida = 1 
							THEN	'TERMINADA'
							ELSE	'REGISTRADA'
						END
					AS ESTATUS,
						CASE 
							WHEN	C1.atendida = 1 
							THEN	'SI'
							ELSE	'NO'
						END
					AS TRABAJO_REALIZADO,
						(SELECT	SBCA.USUARIO_ID 
						 FROM	Simapag_20161015.dbo.Cat_Cor_Usuarios 
						 AS		SBCA 
						 WHERE	SBCA.RPUM = C1.rpu)
					AS USUARIO,							
						(SELECT	SBCA.Predio_ID 
						 FROM	Simapag_20161015.dbo.Cat_Cor_Predios 
						 AS		SBCA 
						 WHERE	SBCA.RPU = C1.rpu)
					AS PREDIO,						
						(SELECT	SBCA.Calle_ID 
						 FROM	Simapag_20161015.dbo.Cat_Cor_Predios 
						 AS		SBCA 
						 WHERE	SBCA.RPU = C1.rpu)
					AS CALLE,						
						(SELECT	SBCA.Calle_Referencia1_ID 
						 FROM	Simapag_20161015.dbo.Cat_Cor_Predios 
						 AS		SBCA 
						 WHERE	SBCA.RPU = C1.rpu)
					AS CALLE_REFE1,						
						(SELECT	SBCA.Calle_Referencia2_ID 
						 FROM	Simapag_20161015.dbo.Cat_Cor_Predios 
						 AS		SBCA 
						 WHERE	SBCA.RPU = C1.rpu)
					AS CALLE_REF2,						
						(SELECT	SBCA.Colonia_ID 
						 FROM	Simapag_20161015.dbo.Cat_Cor_Predios 
						 AS		SBCA 
						 WHERE	SBCA.RPU = C1.rpu)
					AS COLONIA
			FROM 
					(SELECT	DISTINCT
							SBC1.folio,
								SBC1.fecha
							AS FECHA_CREACION,
							SBC1.rpu,
							SBC1.cuenta,
							SBC1.colonia,
							SBC1.atendida,
							SBC1.telefono,
							SBC1.lectura,
								CASE
									WHEN	SBC1.atendida = 1
									AND		SBC1.fechaatencion >= SBC1.finicio 
									THEN	CONVERT(CHAR(10), SBC1.fechaatencion )
									
									WHEN	SBC1.atendida = 1
									AND		SBC1.finicio > SBC1.fechaatencion 
									THEN	CONVERT(CHAR(10), SBC1.finicio) 
									
									--ELSE	''
								END
							AS FECHA_ATENCION,
								CASE
									WHEN	SBC1.atendida = 1
									AND		SBC1.fechaatencion >= SBC1.finicio 
									THEN	CONVERT(CHAR(10), SBC1.fechaatencion )
									
									WHEN	SBC1.atendida = 1
									AND		SBC1.finicio > SBC1.fechaatencion 
									THEN	CONVERT(CHAR(10), SBC1.finicio) 
									
									--ELSE	''
								END
							AS FECHA_TERMINO,
								CASE	
									WHEN	RTRIM(LTRIM(SBC1.hinicio)) <> ':'
									THEN	LEFT(SBC1.hinicio, 2)
									ELSE	''
								END
							AS HORA_INICIO,
								CASE	
									WHEN	RTRIM(LTRIM(SBC1.hinicio)) <> ':'
									THEN	RIGHT(SBC1.hinicio, 2)
									ELSE	''
								END
							AS MIN_INICIO,
								CASE	
									WHEN	RTRIM(LTRIM(SBC1.hfin)) <> ':'
									THEN	LEFT(SBC1.hfin, 2)
									ELSE	''
								END
							AS HORA_TERMINO,
								CASE	
									WHEN	RTRIM(LTRIM(SBC1.hfin)) <> ':'
									THEN	RIGHT(SBC1.hfin, 2)
									ELSE	''
								END
							AS MIN_TERMINO,
								SBC1.nombre 
							AS REPORTO,
								RTRIM(RTRIM(SBC1.calle) + '  ' + RTRIM(SBC1.colonia))				
							AS	DOMICILIO,
								RTRIM(LTRIM(RTRIM(SBC1.queja1)) + SPACE(1) + LTRIM(RTRIM(SBC1.queja2)) + SPACE(1) + LTRIM(RTRIM(SBC1.queja3)) + SPACE(1) + LTRIM(RTRIM(SBC1.queja4)))				
							AS	QUEJA,
								RTRIM(RTRIM(SBC1.observacion1) + '  ' + RTRIM(SBC1.observacion2))
							AS	OBSERVACIONES,
								RTRIM(RTRIM(SBC1.orden1) + '  ' + RTRIM(SBC1.orden2) + '  ' + RTRIM(SBC1.orden3) + '  ' + RTRIM(SBC1.orden4) + '  ' + RTRIM(SBC1.orden5))
							AS	ORDEN,
								RTRIM(RTRIM(SBC1.adicional1) + '  ' + RTRIM(SBC1.adicional2) + '  ' + RTRIM(SBC1.adicional3))
							AS	ADICIONAL,
								CASE
									WHEN	LEFT(LTRIM(SBC1.codorden1 + SPACE(1) + SBC1.codorden2 + SPACE(1) + SBC1.codorden3 + SPACE(1) + SBC1.codorden4 + SPACE(1) + SBC1.codorden5), 2) <> ''
									THEN	LEFT(LTRIM(SBC1.codorden1 + SPACE(1) + SBC1.codorden2 + SPACE(1) + SBC1.codorden3 + SPACE(1) + SBC1.codorden4 + SPACE(1) + SBC1.codorden5), 2)
									
									WHEN	SBC1.orden1 <> ''
									AND		SBC1.orden1 NOT LIKE 'CANCELADO%'
									AND		SBC1.orden1 NOT LIKE 'USUARIO%'
									THEN	(SELECT	SBCA.codorden
											 FROM	Simapag_09_01_2016.dbo.catordenes
											 AS		SBCA
											 WHERE	SBCA.orden = SBC1.orden1)
											 
									WHEN	SBC1.orden2 <> ''
									THEN	(SELECT	SBCA.codorden
											 FROM	Simapag_09_01_2016.dbo.catordenes
											 AS		SBCA
											 WHERE	SBCA.orden = SBC1.orden2)
											 
									WHEN	SBC1.orden3 <> ''
									THEN	(SELECT	SBCA.codorden
											 FROM	Simapag_09_01_2016.dbo.catordenes
											 AS		SBCA
											 WHERE	SBCA.orden = SBC1.orden3)
											 
									WHEN	SBC1.destino = 'USUARIOS EN TRAMITE '
									OR		SBC1.queja1 LIKE 'USUARIOENTRAMITE%'
									THEN	'68'
									
									WHEN	SBC1.orden1 LIKE 'CANCELADO%'
									OR		SBC1.queja1 LIKE 'CANCELADO%'
									THEN	'84'
									
									WHEN	SBC1.queja1 LIKE '%SANCION%'
									OR		SBC1.queja2 LIKE '%SANCION%'
									OR		SBC1.queja3 LIKE '%SANCION%'
									OR		SBC1.queja4 LIKE '%SANCION%'
									THEN	'39'
									
									ELSE	'85'
								END
							AS COD_ORDEN
					FROM	(SELECT	DISTINCT *
							FROM	Simapag_09_01_2016.dbo.ordenes 
							AS		SBCA1
							WHERE	SBCA1.folio NOT IN (SELECT	DISTINCT
																SBCA.folio
														FROM	
																(SELECT		COUNT(folio) 
																		AS COUNT_FOLIO, 
																		folio, 
																		rpu
																 FROM	Simapag_09_01_2016.dbo.ordenes 
																 GROUP
																 BY		folio, rpu)
														AS		SBCA
														WHERE	COUNT_FOLIO > 1)
														
							UNION

							SELECT	DISTINCT *
							FROM	Simapag_09_01_2016.dbo.ordenes 
							AS		SBCA2
							WHERE	SBCA2.folio IN (SELECT	DISTINCT
																SBCA.folio
														FROM	
																(SELECT		COUNT(folio) 
																		AS COUNT_FOLIO, 
																		folio, 
																		rpu
																 FROM	Simapag_09_01_2016.dbo.ordenes 
																 GROUP
																 BY		folio, rpu)
														AS		SBCA
														WHERE	COUNT_FOLIO > 1)							
							AND		SBCA2.atendida = (SELECT	TOP 1
															SBCA.atendida
													FROM	Simapag_09_01_2016.dbo.ordenes
													AS		SBCA
													WHERE	SBCA.folio = SBCA2.folio
													ORDER	
													BY		SBCA.atendida DESC))						
					AS		SBC1)

			AS		C1 
			
------------------------------------------------------------------------------------
--                    MAPEO DE DATOS TABLA: LISTA SANCIONES	                     --
------------------------------------------------------------------------------------
--	NO SCRIPT AJEC:		11
--	REGISTROS MIGRADOS:	04
--	TIEMPO DE EJEC:		00.00.00


INSERT into Cat_Cor_Lista_Sanciones 
	(Descuento,Normal,Reincidir,Dias_Descuento,Fk_Conceptos_Cobro,Estatus,Comentarios,Usuario_Creo,Fecha_Creo,Fk_Tarifas)
SELECT Descuento,Normal,Reincidir,Dias_Descuento,Fk_Conceptos_Cobro,Estatus,Comentarios,Usuario_Creo,Fecha_Creo,Fk_Tarifas
FROM Simapag.dbo.Cat_Cor_Lista_Sanciones
			
			
			

			----------------------------------------------------------------------------------------------------------
----------------------------- SCRIPT PARA INSERTAR DETALLES DE SANCIONES ---------------------------------
----------------------------------------------------------------------------------------------------------

--NOTAS: Correr la aplicacion para migrar Sanciones (Casos 1 y 2)
-- Enseguida actualizar el folio e insertar detalles.
-- Si cambia el usuario creo corregirlo en este script tambien.

--USE Simapag_20161015

--UPDATE Ope_Cor_Sanciones SET Folio = REPLACE(Folio,'F','') WHERE Folio LIKE 'F%'
--UPDATE Ope_Cor_Sanciones SET Folio = REPLACE(Folio,'MANIPULACION','')WHERE Folio LIKE '%MANIPULACION%'

--INSERT INTO Ope_Cor_Detalles_Sanciones(Estatus,Fk_Sanciones,Fecha_Creo,Precio_Normal,Precio_Reincidir,Precio_Descuento,Reincidio,Concepto_Cobro_ID,
--	IVA_Normal,IVA_Reincidir,IVA_Descuento,Total_Normal,Total_Reincidir,Total_Descuento,Detalles_Lista_Sanciones_ID)
	
--	SELECT 
--			'ACTIVO'
--		AS Estatus,
--		Sanciones_ID,
--		Fecha_Creo,
--		0,0,0,
--		CASE
--			WHEN Usuario_Creo = 'Rose no' THEN 'NO'
--			ELSE 'SI'
--		END
--		AS Reincidio,
--			Observaciones
--		AS Concepto_cobro,
--		0,0,0,
--		0,0,0,
--		CASE
--			WHEN	RFC_S <> ''
--			THEN	(SELECT	SBCA.Sanciones_ID
--				 FROM	Cat_Cor_Lista_Sanciones
--				 AS		SBCA
--				 WHERE	SBCA.Fk_Conceptos_Cobro = Observaciones
--				 AND	SBCA.Fk_Tarifas = (SELECT	SBCA.GIRO_ID
--					   FROM		Cat_Cor_Giros
--					   AS		SBCA
--					   WHERE	SBCA.Clave = dbo.fCAMBIAR_TARIFA(RFC_S, 'G')))
--			ELSE	0
--		END
--		AS Lista_Sanciones
--	FROM Ope_Cor_Sanciones WHERE Usuario_Creo LIKE 'Rose%'
 
						            
-----------------------------------------------------------------------------------------------------------
----------                      MAPEO DE DATOS TABLA: SANCIONES   (ADECUACIONES                          --
-----------------------------------------------------------------------------------------------------------

----------	NO SCRIPT AJEC:		12
----------	REGISTROS MIGRADOS: 4360
----------	TIEMPO DE EJEC:		00.00.02



--------INSERT INTO Simapag_20161015.dbo.Ope_Cor_Sanciones
--------			(FOLIO, Rpu, Recibio, Nombre,Usuario_Creo,Fecha_Creo, Direccion, Estatus,
--------			 Observaciones, Fk_Predio, Dias_Descuento)

--------			SELECT	C1.folio,
--------					C1.rpu,
--------					C1.recibio,
--------					C1.nombre,
--------					'MIGRACION'
--------					AS U_CREO,
--------					C1.fecha
--------					AS F_CREO,
--------					C1.calle,
--------					--	RIGHT('000000000'+ LTRIM(RTRIM(STR(ROW_NUMBER() OVER(ORDER BY fecha, folio ASC)))), 10) 
--------					--AS ID,
--------						'PAGADO'
--------					AS ESTATUS,		
								
--------						CASE
--------							--		'CONEXION CLANDESTINA DE DRENAJE'
--------							WHEN    (ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') )LIKE '%CLA%'
--------							AND		(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%DR%'
--------							OR		(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%X DRENAJE%'
--------							OR		((ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%CON%'
--------							AND		 (ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%DR%')
							   
--------							THEN	'00036'		
							
--------							--		'TOMA CLANDESTINA DE AGUA POTABLE'
--------							WHEN	(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%TOMA%'
--------							OR		(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '% T %'
--------							OR		(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%"T%'
--------							OR		(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%ROB%'
--------							OR		(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%BASTE%'
--------							OR		((ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%NO T%'
--------							AND		 (ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%MED%')
--------							OR		((ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%CON%'
--------							AND		 (ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%TINACO%')
--------							OR		 (ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%CONTRATO%'
--------							OR		 (ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%T. C%'
--------							OR		((ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%ESTAR%'
--------							AND		 (ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '% CON%'
--------							OR		 (ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%DIRE%')
--------							OR		((ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '% CONECTAR%'
--------							AND		 (ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%M%')
--------							OR		 (ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%SIN MED%'
--------							OR		 (ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '% CONEXION%'			
--------							OR		 (ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%VARIAS C%'
--------							OR		((ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%MANGUE%'
--------							AND		 (ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '% CONE%')
--------							OR		((ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%MANGUE%'
--------							AND		 (ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%RED%')
--------							THEN	'00018'		
							
--------							--		'DERIVACIONES DE AGUA POTABLE'
--------							WHEN	(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%DER%'
--------							THEN	'00020'		
							
--------							--		'PASAR AGUA'
--------							WHEN	(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%SAR AG%'
--------							OR		(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%VAR AG%'
--------							OR		(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%CONST%'
--------							OR		(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%PASA%'
--------							THEN	'00022'		
							
--------							--		'MANIPULACION-DAÑOS DE MEDIDOR'
--------							WHEN	(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%INVERT%'
--------							OR		((ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%MANI%'
--------							AND		(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%MED%')
--------							OR		(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%MANIPUL%'
--------							OR		(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%VIO%'
--------							OR		((ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%ROMP%'
--------							AND		(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%SELL%'
--------							OR		(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%SELLO%')
--------							OR		(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%PERFOR%'
--------							OR		(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%DESTR%'
--------							OR		(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%RET%'
--------							OR		(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%DESCONECTAR%'
--------							OR		(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%INTERC%'
--------							OR		(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%REVE%'
--------							OR		(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%VOL%'
--------							OR		(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%HACER MO%'
--------							OR		((ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%MAN%'
--------							AND		(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%M%')
--------							OR		((ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%MEDIDOR%'
--------							AND		(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%BAJ%')
--------							THEN	'00024'
							
--------							--		'REUBICACION DE MEDIDOR'
--------							WHEN	(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%REUB%'
--------							OR		(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%MOVER%'
--------							OR		(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%CAMBIAR%'
--------							OR		(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%METER%'
--------							THEN	'00026' 
							
--------							--		'DAÑOS A LAS INSTALACIONES DE SIMAPAG (AGUA)'
--------							WHEN	(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%PROVOCAR%'
--------							OR		(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%DAÑO%'
--------							OR		(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%ROMPER T%'
--------							THEN	'00028'
							
--------							--		'DESPERDICIO DE AGUA'
--------							WHEN	(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%DESPE%'
--------							OR		(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%TIRAR A%'
--------							OR		(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%LAVAR%'
--------							OR		((ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%FUGA%'
--------							AND		(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) NOT LIKE '%PROVOCAR%')
--------							OR		(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%LLAVE AB%'
--------							THEN	'00030'
							
--------							--		'RECONEXION DE SERVICIO POR PERSONA AJENA AL ORGANISMO'
--------							WHEN	(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%REC%'
--------							OR		(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%ACT%'
--------							OR		(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%RER%'
--------							THEN	'00032'
							
--------							--		'DESCARGAR A LA VIA PUBLICA'
--------							WHEN	(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%DESCA%'
--------							OR		(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%DESE%'
--------							THEN	'00034'
							
							
--------							--WHEN	(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%%'
--------							--THEN	'DAÑOS A LAS INSTALACIONES DE SIMAPAG (DRENAJE)'
							
--------							--		'USO DISTINTO DEL AGUA Y/O DRENAJE PARA EL QUE FUE CONTRATADO'
--------							WHEN	(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%USO%'
--------							AND		(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%SERV%'	-- <-- PUEDE CAMBIAR
--------							THEN	'00040'
							
--------							--		'MANIPULACION DE INSTALACIONES HIDRAULICAS'
--------							WHEN	(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%MAN%'
--------							AND		((ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%HDR%'
--------							OR		(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%HI%')		-- <-- PUEDE CAMBIAR
--------							THEN	'00042' 
							
--------							--		'MANIPULACION DE INSTALACIONES SANITARIAS O DE DRENAJE'
--------							WHEN	((ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%TUBERIA%'
--------							AND		(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%MOV%')
--------							OR		((ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%OBST%'
--------							AND		(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%DR%')
--------							OR		((ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%MAN%'
--------							AND		(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%DRE%')
--------							THEN	'00044'
							
--------							--		'INSTALAR MECANISMOS DE SOLUCION A LA RED DE AGUA POTABLE'
--------							WHEN	(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%INSTALAR%'
--------							OR		(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%PUENTADO%'
--------							THEN	'00046'
							
--------							--WHEN	(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%%'
--------							--THEN	'USO DE AGUA TRATADA'
							
--------							--		'%NO PERMITIR LA REVISION-INSTALACION DE MEDIDOR Y DESCARGA%'
--------							WHEN	(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%PERMITIR%'
--------							OR		(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%OBSTRUIR%'
--------							THEN	'00050'
										
--------							--WHEN	(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%%'
--------							--THEN	'FRACCIONAMIENTOS SIN AUTORIZACION PAA OBRAS DE AGUA POTABELE'
							
--------							ELSE	'00024'
--------						END
--------					AS OBSERVACIONES,
--------						(SELECT	SBCA.Predio_ID
--------						 FROM	Simapag_20161015.dbo.Cat_Cor_Predios
--------						 AS		SBCA
--------						 WHERE	SBCA.RPU = C1.rpu)
--------					AS PREDIO,
--------						3
--------					AS DIAS_DESCUENTO
					
--------			FROM	(SELECT	DISTINCT *
--------					 FROM	Simapag_09_01_2016.dbo.sancion
--------					 WHERE	rpu <> '' 
--------					 AND (YEAR(fecha) > 2014      ----cuando sea pagado 
--------					 and rpu NOT IN
--------						(SELECT rpu FROM Simapag_09_01_2016.dbo.recibos WHERE sancion = 1)))
						
						 
--------					 --and rpu IN					-----cuando no 
--------					 --	(SELECT rpu FROM Simapag_09_01_2016.dbo.recibos WHERE sancion = 1))
--------						-------------*****************************************************************************************
--------						------------*****************************************************************************************
--------						--*****************************************************************************************
--------						--*****************************************************************************************
--------						--*****************************************************************************************
--------			AS		C1		 

--------			ORDER 
--------			BY C1.fecha, C1.folio ASC
			
-----------------------------------------------------------------------------------------------------------
----------                      MAPEO DE DATOS TABLA: SANCIONES   (ADECUACIONES                          --
-----------------------------------------------------------------------------------------------------------

----------	NO SCRIPT AJEC:		12
----------	REGISTROS MIGRADOS: 4360
----------	TIEMPO DE EJEC:		00.00.02



--------INSERT INTO Simapag_20161015.dbo.Ope_Cor_Sanciones
--------			(FOLIO, Rpu, Recibio, Nombre,Usuario_Creo,Fecha_Creo, Direccion, Estatus,
--------			 Observaciones, Fk_Predio, Dias_Descuento)

--------			SELECT	C1.folio,
--------					C1.rpu,
--------					C1.recibio,
--------					C1.nombre,
--------					'MIGRACION'
--------					AS U_CREO,
--------					C1.fecha
--------					AS F_CREO,
--------					C1.calle,
--------					--	RIGHT('000000000'+ LTRIM(RTRIM(STR(ROW_NUMBER() OVER(ORDER BY fecha, folio ASC)))), 10) 
--------					--AS ID,
--------						'PAGADO'
--------					AS ESTATUS,		
								
--------						CASE
--------							--		'CONEXION CLANDESTINA DE DRENAJE'
--------							WHEN    (ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') )LIKE '%CLA%'
--------							AND		(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%DR%'
--------							OR		(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%X DRENAJE%'
--------							OR		((ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%CON%'
--------							AND		 (ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%DR%')
							   
--------							THEN	'00036'		
							
--------							--		'TOMA CLANDESTINA DE AGUA POTABLE'
--------							WHEN	(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%TOMA%'
--------							OR		(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '% T %'
--------							OR		(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%"T%'
--------							OR		(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%ROB%'
--------							OR		(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%BASTE%'
--------							OR		((ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%NO T%'
--------							AND		 (ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%MED%')
--------							OR		((ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%CON%'
--------							AND		 (ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%TINACO%')
--------							OR		 (ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%CONTRATO%'
--------							OR		 (ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%T. C%'
--------							OR		((ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%ESTAR%'
--------							AND		 (ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '% CON%'
--------							OR		 (ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%DIRE%')
--------							OR		((ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '% CONECTAR%'
--------							AND		 (ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%M%')
--------							OR		 (ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%SIN MED%'
--------							OR		 (ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '% CONEXION%'			
--------							OR		 (ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%VARIAS C%'
--------							OR		((ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%MANGUE%'
--------							AND		 (ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '% CONE%')
--------							OR		((ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%MANGUE%'
--------							AND		 (ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%RED%')
--------							THEN	'00018'		
							
--------							--		'DERIVACIONES DE AGUA POTABLE'
--------							WHEN	(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%DER%'
--------							THEN	'00020'		
							
--------							--		'PASAR AGUA'
--------							WHEN	(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%SAR AG%'
--------							OR		(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%VAR AG%'
--------							OR		(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%CONST%'
--------							OR		(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%PASA%'
--------							THEN	'00022'		
							
--------							--		'MANIPULACION-DAÑOS DE MEDIDOR'
--------							WHEN	(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%INVERT%'
--------							OR		((ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%MANI%'
--------							AND		(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%MED%')
--------							OR		(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%MANIPUL%'
--------							OR		(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%VIO%'
--------							OR		((ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%ROMP%'
--------							AND		(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%SELL%'
--------							OR		(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%SELLO%')
--------							OR		(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%PERFOR%'
--------							OR		(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%DESTR%'
--------							OR		(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%RET%'
--------							OR		(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%DESCONECTAR%'
--------							OR		(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%INTERC%'
--------							OR		(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%REVE%'
--------							OR		(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%VOL%'
--------							OR		(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%HACER MO%'
--------							OR		((ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%MAN%'
--------							AND		(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%M%')
--------							OR		((ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%MEDIDOR%'
--------							AND		(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%BAJ%')
--------							THEN	'00024'
							
--------							--		'REUBICACION DE MEDIDOR'
--------							WHEN	(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%REUB%'
--------							OR		(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%MOVER%'
--------							OR		(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%CAMBIAR%'
--------							OR		(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%METER%'
--------							THEN	'00026' 
							
--------							--		'DAÑOS A LAS INSTALACIONES DE SIMAPAG (AGUA)'
--------							WHEN	(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%PROVOCAR%'
--------							OR		(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%DAÑO%'
--------							OR		(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%ROMPER T%'
--------							THEN	'00028'
							
--------							--		'DESPERDICIO DE AGUA'
--------							WHEN	(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%DESPE%'
--------							OR		(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%TIRAR A%'
--------							OR		(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%LAVAR%'
--------							OR		((ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%FUGA%'
--------							AND		(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) NOT LIKE '%PROVOCAR%')
--------							OR		(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%LLAVE AB%'
--------							THEN	'00030'
							
--------							--		'RECONEXION DE SERVICIO POR PERSONA AJENA AL ORGANISMO'
--------							WHEN	(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%REC%'
--------							OR		(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%ACT%'
--------							OR		(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%RER%'
--------							THEN	'00032'
							
--------							--		'DESCARGAR A LA VIA PUBLICA'
--------							WHEN	(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%DESCA%'
--------							OR		(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%DESE%'
--------							THEN	'00034'
							
							
--------							--WHEN	(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%%'
--------							--THEN	'DAÑOS A LAS INSTALACIONES DE SIMAPAG (DRENAJE)'
							
--------							--		'USO DISTINTO DEL AGUA Y/O DRENAJE PARA EL QUE FUE CONTRATADO'
--------							WHEN	(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%USO%'
--------							AND		(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%SERV%'	-- <-- PUEDE CAMBIAR
--------							THEN	'00040'
							
--------							--		'MANIPULACION DE INSTALACIONES HIDRAULICAS'
--------							WHEN	(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%MAN%'
--------							AND		((ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%HDR%'
--------							OR		(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%HI%')		-- <-- PUEDE CAMBIAR
--------							THEN	'00042' 
							
--------							--		'MANIPULACION DE INSTALACIONES SANITARIAS O DE DRENAJE'
--------							WHEN	((ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%TUBERIA%'
--------							AND		(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%MOV%')
--------							OR		((ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%OBST%'
--------							AND		(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%DR%')
--------							OR		((ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%MAN%'
--------							AND		(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%DRE%')
--------							THEN	'00044'
							
--------							--		'INSTALAR MECANISMOS DE SOLUCION A LA RED DE AGUA POTABLE'
--------							WHEN	(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%INSTALAR%'
--------							OR		(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%PUENTADO%'
--------							THEN	'00046'
							
--------							--WHEN	(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%%'
--------							--THEN	'USO DE AGUA TRATADA'
							
--------							--		'%NO PERMITIR LA REVISION-INSTALACION DE MEDIDOR Y DESCARGA%'
--------							WHEN	(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%PERMITIR%'
--------							OR		(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%OBSTRUIR%'
--------							THEN	'00050'
										
--------							--WHEN	(ISNULL( C1.inspeccion,'') + ISNULL( C1.observacion1,'') ) LIKE '%%'
--------							--THEN	'FRACCIONAMIENTOS SIN AUTORIZACION PAA OBRAS DE AGUA POTABELE'
							
--------							ELSE	'00024'
--------						END
--------					AS OBSERVACIONES,
--------						(SELECT	SBCA.Predio_ID
--------						 FROM	Simapag_20161015.dbo.Cat_Cor_Predios
--------						 AS		SBCA
--------						 WHERE	SBCA.RPU = C1.rpu)
--------					AS PREDIO,
--------						3
--------					AS DIAS_DESCUENTO
					
--------			FROM	(SELECT	DISTINCT *
--------					 FROM	Simapag_09_01_2016.dbo.sancion
--------					 WHERE	rpu <> '' 
--------					 --AND (YEAR(fecha) > 2014      ----cuando sea pagado 
--------					 --and rpu NOT IN
--------						--(SELECT rpu FROM Simapag_09_01_2016.dbo.recibos WHERE sancion = 1)))
						
						 
--------					 and rpu IN					-----cuando no 
--------					 	(SELECT rpu FROM Simapag_09_01_2016.dbo.recibos WHERE sancion = 1))
--------						-------------*****************************************************************************************
--------						------------*****************************************************************************************
--------						--*****************************************************************************************
--------						--*****************************************************************************************
--------						--*****************************************************************************************
--------			AS		C1		 

--------			ORDER 
--------			BY C1.fecha, C1.folio ASC

-----------------------------------------------------------------------------------------------------------
----------               MAPEO DE DATOS TABLA: DETALLES SANCIONES   (ADECUACIONES)                       --
-----------------------------------------------------------------------------------------------------------

----------	NO SCRIPT AJEC:		13
----------	REGISTROS MIGRADOS: 4360
----------	TIEMPO DE EJEC:		00.00.01


--------INSERT INTO Simapag_20161015.dbo.Ope_Cor_Detalles_Sanciones
--------			(Estatus, Observaciones, Fk_Sanciones, Precio_Normal, Precio_Reincidir, Precio_Descuento,
--------			 Reincidio, Concepto_Cobro_ID, IVA_Normal, IVA_Reincidir, IVA_Descuento, Total_Normal, Total_Reincidir,
--------			 Total_Descuento, Detalles_Lista_Sanciones_ID,Fecha_Creo)

--------SELECT		'ACTIVO'
--------		AS ESTATUS,
--------		SBC2.observacion1,
--------		SBC1.Sanciones_ID,
--------			SBC2.adeudo
--------		AS PR_NORMAL,
--------			SBC2.adeudo
--------		AS PR_REINCIDIR,
--------			SBC2.adeudo
--------		AS PR_DESCUENTO,
--------			CASE
--------				WHEN	SBC2.inspeccion LIKE '%REIN%'
--------				THEN	'SI'
--------				ELSE	'NO'
--------			END	
--------		AS REINCIDIO,
--------			SBC1.Observaciones
--------		AS CONCEPTO_COBRO,
--------			0.00
--------		AS IVA_NORMAL,
--------			0.00
--------		AS IVA_REINCIDIR,
--------			0.00
--------		AS IVA_DESCUENTO,
--------			--CASE
--------			--	WHEN	SBC2.inspeccion NOT LIKE '%REIN%'
--------			--	THEN	SBC2.adeudo
--------			--	ELSE	0.00
--------			--END
--------			SBC2.adeudo
--------		AS T_NORMAL,
--------			SBC2.adeudo
--------		AS T_RECINDIR,
--------			SBC2.adeudo
--------		AS T_DESCUENTO,		
--------			CASE
--------				WHEN	SBC2.tarifa <> ''
--------				THEN	(SELECT	SBCA.Sanciones_ID
--------						 FROM	Simapag_20161015.dbo.Cat_Cor_Lista_Sanciones
--------						 AS		SBCA
--------						 WHERE	SBCA.Fk_Conceptos_Cobro = SBC1.Observaciones
--------						 AND	SBCA.Fk_Giros = (SELECT	SBCA.GIRO_ID
--------											   FROM		Simapag_20161015.dbo.Cat_Cor_Giros
--------											   AS		SBCA
--------											   WHERE	SBCA.Clave = dbo.fCAMBIAR_TARIFA(SBC2.tarifa, 'G')))
--------				ELSE	0
--------			END
--------		AS LISTA_SANCIONES,
--------		SBC2.fecha
		
		
--------FROM	Simapag_20161015.dbo.Ope_Cor_Sanciones
--------AS		SBC1

--------INNER JOIN

--------		(SELECT	DISTINCT
--------				*
--------		 FROM	Simapag_09_01_2016.dbo.sancion)
--------AS		SBC2
--------ON		SBC1.FOLIO = SBC2.folio
--------AND		SBC1.Direccion = SBC2.calle
--------ORDER 
--------BY      SBC1.Sanciones_ID


go
USE				Simapag_20161015
EXEC			sp_rename 'Cat_Cor_Lista_Sanciones.Fk_Giros', 'Fk_Tarifas', 'COLUMN';

ALTER TABLE		Simapag_20161015.dbo.Cat_Cor_Lista_Sanciones ALTER COLUMN  Fk_Tarifas CHAR(10) NULL;

UPDATE Ope_Cor_Sanciones SET Codigo_Barras = cast(Sanciones_ID as VARCHAR(10)) + 'S'

---------------------------------------------
-- ************************** BASE DE DATOS A INSERTAR ************************** --

USE Simapag_20161015

-- ************************** ACTUALIZA ESTATUS ACTIVO ************************** -- 
---- Nota: este ya no

--UPDATE Ope_Cor_Sanciones SET Estatus = 'ACTIVO' WHERE Folio IN
--(
--SELECT s.folio
--from 
--	Simapag_09_01_2016.dbo.sancion s 
--	join (
--		SELECT 
--			rpu,
--			max(fecha)  fecha
--		from 
--			Simapag_09_01_2016.dbo.sancion 
--		WHERE  
--			rpu  in (SELECT rpu from Simapag_09_01_2016.dbo.recibos WHERE 
--				sancion =1) 
--		group by
--			rpu
--	) t1 on t1.rpu = s.rpu and t1.fecha = s.fecha
--WHERE  
--	s.rpu	in (SELECT rpu from Simapag_09_01_2016.dbo.recibos WHERE 
--		sancion =1)
---- and s.rpu = '000041222948'
-- and folio <> '567805678'
--)
--AND Rpu IN
--(
--SELECT s.rpu
--from 
--	Simapag_09_01_2016.dbo.sancion s 
--	join (
--		SELECT 
--			rpu,
--			max(fecha)  fecha
--		from 
--			Simapag_09_01_2016.dbo.sancion 
--		WHERE  
--			rpu  in (SELECT rpu from Simapag_09_01_2016.dbo.recibos WHERE 
--				sancion =1) 
--		group by
--			rpu
--	) t1 on t1.rpu = s.rpu and t1.fecha = s.fecha
--WHERE  
--	s.rpu	in (SELECT rpu from Simapag_09_01_2016.dbo.recibos WHERE 
--		sancion =1)
---- and s.rpu = '000041222948'
-- and folio <> '567805678'
--)
--AND Fecha_Creo IN
--(
--SELECT s.fecha
--from 
--	Simapag_09_01_2016.dbo.sancion s 
--	join (
--		SELECT 
--			rpu,
--			max(fecha)  fecha
--		from 
--			Simapag_09_01_2016.dbo.sancion 
--		WHERE  
--			rpu  in (SELECT rpu from Simapag_09_01_2016.dbo.recibos WHERE 
--				sancion =1) 
--		group by
--			rpu
--	) t1 on t1.rpu = s.rpu and t1.fecha = s.fecha
--WHERE  
--	s.rpu	in (SELECT rpu from Simapag_09_01_2016.dbo.recibos WHERE 
--		sancion =1)
---- and s.rpu = '000041222948'
-- and folio <> '567805678'
--)

-- ************************** INSERCION DE SANCIONES A RECIBOS_COBROS ************************** --

INSERT INTO Ope_Cor_Caj_Recibos_Cobros (RPU,CODIGO_BARRAS,RECIBOS_COBRAR,TOTAL_RECIBOS,PAGO_EFECTIVO,SALDO,CAMBIO,FECHA,
	USUARIO_CREO,FECHA_CREO,estado_recibo,importe_cobrado,total_iva_cobrado,tasa_iva_cobrado,total_cobrado_ajuste,
	NO_FACTURA,periodo)
SELECT Rpu,Codigo_Barras,1 as Recibos_cobrar,
	(SELECT TOP 1 Precio_normal FROM Ope_Cor_Detalles_Sanciones WHERE Fk_Sanciones = S.Sanciones_ID)as Total_Recibos,
	(SELECT TOP 1 Precio_normal FROM Ope_Cor_Detalles_Sanciones WHERE Fk_Sanciones = S.Sanciones_ID)as Pago_efectivo,
	0 as Saldo,0 as Cambio,S.Fecha_Creo,'MIGRACION'as U_creo,S.Fecha_Creo as F_creo,'ACTIVO'as Estado,
	(SELECT TOP 1 Precio_normal FROM Ope_Cor_Detalles_Sanciones WHERE Fk_Sanciones = S.Sanciones_ID)as Importe_cobrado,
	0 as Iva_cobrado,0 as tasa_iva,
	(SELECT TOP 1 Precio_normal FROM Ope_Cor_Detalles_Sanciones WHERE Fk_Sanciones = S.Sanciones_ID)as Total_ajuste,
	S.Sanciones_ID as No_factura_fk,
	S.Fecha_Creo as Periodo
FROM Ope_Cor_Sanciones S WHERE S.Estatus = 'PAGADO'

-- ************************* INSERCION DE SANCIONES A MOVIMIENTOS_COBROS ************************* --

INSERT INTO Ope_Cor_Caj_Movimientos_Cobros (NO_RECIBO,CONCEPTO_ID,IMPORTE,FECHA_MOVIMIENTO,
	Facturado,COMENTARIOS,USUARIO_CREO,FECHA_CREO,estado_concepto_cobro,impuesto,total,RPU)
SELECT
	(SELECT NO_RECIBO FROM Ope_Cor_Caj_Recibos_Cobros WHERE CAST(S.Sanciones_ID as VARCHAR(12)) = NO_FACTURA)as no_recibo_fk,
	(SELECT TOP 1 Concepto_Cobro_ID FROM Ope_Cor_Detalles_Sanciones WHERE Fk_Sanciones = S.Sanciones_ID)as Concepto_id,
	(SELECT TOP 1 Precio_normal FROM Ope_Cor_Detalles_Sanciones WHERE Fk_Sanciones = S.Sanciones_ID)as Importe,
	S.Fecha_Creo as Fecha_movimiento,'N'as Facturado,'Sancion'as Comentarios,'MIGRACION'as U_creo,S.Fecha_Creo as F_creo,
	'ACTIVO'as Estado_conc_cobr,0 as Impuesto,
	(SELECT TOP 1 Precio_normal FROM Ope_Cor_Detalles_Sanciones WHERE Fk_Sanciones = S.Sanciones_ID)as Total,
	S.Rpu
FROM Ope_Cor_Sanciones S WHERE S.Estatus = 'PAGADO'			

-----------------------------------------------------------------------------------------------------
--                  MAPEO DE DATOS TABLA: MOTIVOS CANCELACION (ADECUACIONES)                       --
-----------------------------------------------------------------------------------------------------

--	NO SCRIPT AJEC:		14
--	REGISTROS MIGRADOS: 11
--	TIEMPO DE EJEC:		00.00.00

INSERT INTO Simapag_20161015.dbo.Cat_Cor_Motivos_Cancelacion
			(Motivo_Cancelacion_Id, Motivo, Usuario_Creo, Fecha_Creo,estatus)

			SELECT		RIGHT('00000'+ LTRIM(RTRIM(STR(ROW_NUMBER() OVER(ORDER BY C2.motivo ASC )))),5 ) 
					AS ID,
					C2.MOTIVO,
						'MIGRACION'
					AS U_CREO,
						GETDATE()
					AS F_CREO,
						'ACTIVO'
					AS ESTATUS
			FROM	
					(SELECT	DISTINCT
								CASE 
									WHEN	C1.motivo LIKE 'AC.%'
									OR		C1.motivo LIKE 'ACTA%'
									THEN	'ACTA DE SESION ORDINARIA'
									
									WHEN	C1.motivo LIKE 'PRESCRIPCION F%'
									THEN	'PRESCRIPCIÓN FISCAL'
									
									WHEN	C1.motivo LIKE '% X %'
									OR		RTRIM(C1.motivo) LIKE '%PRESCRIPCIÓN'
									OR		RTRIM(motivo) LIKE '%PRESCRIPCIÒN'
									OR		RTRIM(C1.motivo) LIKE 'PRESCRIPCIÓN%'
									OR		RTRIM(C1.motivo) LIKE 'PRESCRIPCION%'
									THEN	'PRESCRIPCIÓN DE ADEUDO' 
									
									WHEN	C1.motivo LIKE 'SOLICITUD%'
									OR		C1.motivo LIKE 'A SOL%'
									OR		C1.motivo LIKE 'A PET%'
									OR		C1.motivo LIKE 'PET%'
									THEN	'SOLICITUD DEL USUARIO'
									
									WHEN	C1.motivo LIKE 'ACUERDO%'
									THEN	'ACUERDO CD SESION ORDINARIA'
									
									ELSE	C1.motivo
								END
							AS MOTIVO
					FROM
							(SELECT	convenio, rpu, causa, motivo
									--	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(motivo, 'DE ', 'DE '),'PRESCRIPCION','PRESCRIPCIÓN'),'POR ', ''),'CCHS',''),'DEUDOR','USUARIO') 
									--AS motivo
							FROM	Simapag_09_01_2016.dbo.cancadmvo

							UNION

							SELECT	convenio, rpu, causa, motivo
									--	REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(motivo, 'DE ', 'DE '),'PRESCRIPCION','PRESCRIPCIÓN'),'POR ', ''),'CCHS',''),'DEUDOR','USUARIO') 
									--AS motivo 
							FROM	Simapag_09_01_2016.dbo.cancpec)
					AS		C1)
			AS		C2

-- ============================================
-- ========  DOCUMENTOS ACREDITACION  ========= Listo
-- ============================================

INSERT INTO CAT_COR_DOCUMENTOS_ACREDITACION (DOCUMENTO_ACREDITACION_ID,DOCUMENTO_ACREDITACION,USUARIO_CREO,FECHA_CREO)
VALUES 
	(1,'Constancia de Alineamiento','MIGRACION',GETDATE()),
	(2,'Boleta predial (Último pago)','MIGRACION',GETDATE()),
	(3,'Credencial del INE','MIGRACION',GETDATE()),
	(4,'Constancia de Posicion Ejidal','MIGRACION',GETDATE())

-- ============================================
-- ==========  TIPOS PROPIETARIOS  ============ Listo
-- ============================================

INSERT INTO CAT_COR_TIPOS_PROPIETARIOS (TIPO_PROPIETARIO_ID,TIPO_PROPIETARIO,USUARIO_CREO,FECHA_CREO)
VALUES
	('00001','PROPIETARIO','MIGRACION',GETDATE()),
	('00002','CONYUGE','MIGRACION',GETDATE()),
	('00003','REPRESENTANTE LEGAL','MIGRACION',GETDATE()),
	('00004','GESTOR','MIGRACION',GETDATE()),
	('00005','ARRENDATARIO','MIGRACION',GETDATE()),
	('00006','DONATARIO','MIGRACION',GETDATE()),
	('00007','COMODATARIO','MIGRACION',GETDATE())

-- ============================================	
-- ========  ACTUALIZACION PRODUCTOS  ========= Listo
-- ============================================

UPDATE CAT_COM_PRODUCTOS SET NOMBRE = REPLACE(DESCRIPCION,'"','') -- NOMBRE Y DESCRIPCION QUITAR "
UPDATE CAT_COM_PRODUCTOS SET DESCRIPCION = REPLACE(DESCRIPCION,'"','')
UPDATE CAT_COM_PRODUCTOS SET IMPUESTO_ID = '00002' -- IMPUESTO 16%


-- ============================================
-- ===========  CABECERA REPORTES  ============ Listo
-- ============================================

INSERT INTO CAT_CABECERA_REPORTES (CABECERA_REPORTES_ID,NOMBRE_MODULO,NOMBRE_ORGANIZACION,LOGO_ORGANIZACION,ABREVIATURA_NOMBRE_ORGANIZACION,Nombre_Director_General)
VALUES(1,'COMERCIAL','Sistema Municipal de Agua Potable y Alcantarillado de Guanajuato','/imagenes/irapuato/logo_apas.jpg','SIMAPAG','ING. JOSE LARA LONA')


-- ============================================
-- ============  ROLES ESCRITORIO  ============ Listo
-- ============================================

INSERT INTO Apl_Cat_Roles_Escritorio (Rol_ID,Nombre,Usuario_Creo,Fecha_Creo,Estatus)
VALUES 
	('00001','Administrador','MIGRACION',GETDATE(),'ACTIVO'),
	('00002','Cajero','MIGRACION',GETDATE(),'ACTIVO'),
	('00003','Supervisor Cajero','MIGRACION',GETDATE(),'ACTIVO')
	
UPDATE CAT_EMPLEADOS set Rol_ID_Escritorio = '00001', Fecha_Caduca = '19/07/2017' where NO_EMPLEADO = 1010
	
--SELECT * FROM Apl_Cat_Roles_Escritorio

-- =============================================
-- ===========  ACCESOS ESCRITORIO  ============ Listo
-- =============================================

INSERT INTO Apl_Cat_Accesos_Escritorio SELECT * FROM Simapag.dbo.Apl_Cat_Accesos_Escritorio


-- =============================================
-- =============  COSTOS FACTORES  ============= Listo
-- =============================================

INSERT INTO Cat_Cor_Costos_Factores SELECT * FROM Simapag.dbo.Cat_Cor_Costos_Factores


-- =============================================
-- ================  SERVICIOS  ================ Listo
-- =============================================

--INSERT INTO Cat_Cor_Servicios SELECT * FROM Simapag_Pruebas.dbo.Cat_Cor_Servicios
INSERT INTO Cat_Cor_Servicios (SERVICIO_ID,NOMBRE,DESCRIPCION,USUARIO_CREO,FECHA_CREO)
VALUES 
	('00001','AGUA','AGUA','MIGRACION',GETDATE()),
	('00002','DRENAJE','DRENAJE INCLUYE SANEAMIENTO','MIGRACION',GETDATE()),
	('00003','AMBOS SERVICIOS','AGUA Y DRENAJE','MIGRACION',GETDATE()),
	('00004','NINGUNO','NO TIENE SERVICIO ALGUNO','MIGRACION',GETDATE())
	
	
-- =============================================
-- ===============  DESCUENTOS  ================ Listo
-- =============================================

INSERT INTO Cat_Cor_Descuentos_Anios (Descuento_Id,Nombre_Descuento,Descripcion_Descuento,Fecha_Inicio,Fecha_Termino,Prioridad,
	Porcentaje_Descuento,Autorizacion,Clasificacion,Concepto_Afecta)
VALUES
	('00001','DESCUENTO RECARGO','DESCUENTO RECARGO','01/01/2005','01/01/2018','1',	5,	'NO','SM','RECARGOS'),
	('00002','DESCUENTO RECARGO','DESCUENTO RECARGO','01/01/2005','01/01/2018','2',	10,	'NO','SM','RECARGOS'),
	('00003','DESCUENTO RECARGO','DESCUENTO RECARGO','01/01/2005','01/01/2018','3',	20,	'NO','SM','RECARGOS'),
	('00004','DESCUENTO RECARGO','DESCUENTO RECARGO','01/01/2005','01/01/2018','4',	25,	'NO','SM','RECARGOS'),
	('00005','DESCUENTO RECARGO','DESCUENTO RECARGO','01/01/2005','01/01/2018','5',	30,	'NO','SM','RECARGOS'),
	('00006','DESCUENTO RECARGO','DESCUENTO RECARGO','01/01/2005','01/01/2018','6',	40,	'NO','SM','RECARGOS'),
	('00007','DESCUENTO RECARGO','DESCUENTO RECARGO','01/01/2005','01/01/2018','7',	45,	'NO','SM','RECARGOS'),
	('00008','DESCUENTO RECARGO','DESCUENTO RECARGO','01/01/2005','01/01/2018','8',	50,	'NO','SM','RECARGOS'),
	('00009','DESCUENTO RECARGO','DESCUENTO RECARGO','01/01/2005','01/01/2018','9',	60,	'NO','SM','RECARGOS'),
	('00010','DESCUENTO RECARGO','DESCUENTO RECARGO','01/01/2005','01/01/2018','10',70,	'NO','SM','RECARGOS'),
	('00011','DESCUENTO RECARGO','DESCUENTO RECARGO','01/01/2005','01/01/2018','11',75,	'NO','SM','RECARGOS'),
	('00012','DESCUENTO RECARGO','DESCUENTO RECARGO','01/01/2005','01/01/2018','12',80,	'NO','SM','RECARGOS'),
	('00013','DESCUENTO RECARGO','DESCUENTO RECARGO','01/01/2005','01/01/2018','13',90,	'NO','SM','RECARGOS'),
	('00014','DESCUENTO RECARGO','DESCUENTO RECARGO','01/01/2005','01/01/2018','14',100,'NO','SM','RECARGOS')

-- ==============================================================================================
-- ==                        MIGRACION PARTE II (TABLAS DE USO INTERNO)                        ==
-- ==============================================================================================

	USE Simapag_20161015 -- <----- BD_DESTINO -----------------

-- ===========================================
-- ========  ACTUALIZACION SANCIONES  ========
-- ===========================================

-- ARCHIVO: Script_Actualizacion_Sanciones


-- ===========================================
-- ================  MODULOS  ================ Listo
-- ===========================================

--SELECT * from Simapag.dbo.APL_CAT_MODULOS
INSERT into APL_CAT_MODULOS (MODULO_ID,NOMBRE,USUARIO_CREO,FECHA_CREO)
VALUES ('00001','COMERCIALIZACION','MIGRACION',GETDATE())


-- ===========================================
-- ================  MENUS  ================== Listo
-- ===========================================

INSERT INTO APL_CAT_MENUS SELECT * from Simapag.dbo.APL_CAT_MENUS

-- ANEXAR AL EXCEL

-- ===========================================
-- ================  ACCESOS  ================ Listo
-- ===========================================

INSERT INTO APL_CAT_ACCESOS  SELECT * from Simapag.dbo.APL_CAT_ACCESOS

-- ANEXAR AL EXCEL

-- ===========================================
-- ===============  PANTALLAS  =============== Listo
-- ===========================================


SET IDENTITY_INSERT dbo.cat_cor_pantallas ON
INSERT INTO cat_cor_pantallas (id_pantalla,nombre_pantalla,estatus_pantalla,usuario_creo,fecha_creo)
VALUES 
	(1,'Frm_Ope_Cor_Consulta_Usuario','ACTIVO','MIGRACION',GETDATE()),
	(2,'Frm_Ope_Cor_Busqueda_Usuario','ACTIVO','MIGRACION',GETDATE())
SET IDENTITY_INSERT dbo.cat_cor_pantallas OFF


-- ===========================================
-- ===============  FUNCIONES  =============== Listo
-- ===========================================

INSERT INTO Cat_Cor_Funciones (Funcion_id,Nombre_funcion,Usuario_creo,Fecha_creo)
VALUES
	('00001','Cajero','MIGRACION',GETDATE()),
	('00002','Notificadores','MIGRACION',GETDATE()),
	('00003','CORTADORES','MIGRACION',GETDATE())


-- ===========================================
-- ===========  CATALOGO_BOTONES  ============ Listo
-- ===========================================

SET IDENTITY_INSERT dbo.cat_cor_catalogo_botones ON
--SELECT * from Simapag.dbo.cat_cor_catalogo_botones
INSERT INTO cat_cor_catalogo_botones (id_catalogo_botones,id_pantalla,identificador_botones,funcionalidad_boton,estatus_catalogo_botones,fecha_creo,usuario_creo)
VALUES
	(1,1,'A2','Me Permite dar de alta un evento','ACTIVO',GETDATE(),'MIGRACION'),
	(2,1,'A5','Me Permite Bloquear un Usuario','ACTIVO',GETDATE(),'MIGRACION'),
	(3,1,'A3','Me Permite Elaborar Ordenes de Trabajo','ACTIVO',GETDATE(),'MIGRACION'),
	(4,1,'A4','Visualiza las Suspenciones que Tiene un Usuario','ACTIVO',GETDATE(),'MIGRACION'),
	(5,1,'A7','Puedo Re Imprimir un Recibo Anual','ACTIVO',GETDATE(),'MIGRACION'),
	(6,1,'A11','Puedo Re Imprimir un Recibo De Facturación Actual','ACTIVO',GETDATE(),'MIGRACION'),
	(7,1,'A8','Emite Un Reporte De los Pagos Hechos','ACTIVO',GETDATE(),'MIGRACION'),
	(8,1,'A9','Emite Un Reporte De las Facturaciones Elaboradas al Usuario','ACTIVO',GETDATE(),'MIGRACION'),
	(9,1,'A12','Emite Un Reporte De las Ediciones Hechas al Predio del Usuario','ACTIVO',GETDATE(),'MIGRACION'),
	(10,1,'A13','Elabora Pagos Parciales','ACTIVO',GETDATE(),'MIGRACION'),
	(11,1,'A15','Emite Constacia de No Adeudo','ACTIVO',GETDATE(),'MIGRACION'),
	(12,1,'A1','Permite Refacturar','ACTIVO',GETDATE(),'MIGRACION'),
	(13,1,'btn_table_cancelar','Cancela un Convenio','ACTIVO',GETDATE(),'MIGRACION'),
	(14,1,'btn_imprimir_convenio','Imprime un Convenio','ACTIVO',GETDATE(),'MIGRACION'),
	(15,1,'btn_primer_pago_convenio','Imprime el Primer Pago','ACTIVO',GETDATE(),'MIGRACION'),
	(16,1,'BtnConvenio','Permite Hacer Pago de Mensualidades','ACTIVO',GETDATE(),'MIGRACION'),
	(17,1,'btn_imprimir_nota_cargo','Imprime Nota de Cargo','ACTIVO',GETDATE(),'MIGRACION'),
	(18,2,'btn_buscar_usuario','Me Permite Buscar Un Usuario','ACTIVO',GETDATE(),'MIGRACION'),
	(19,2,'btn_consultar_usuario','Me Permite Consultar Información Acerca del Usuario','ACTIVO',GETDATE(),'MIGRACION'),
	(20,2,'btn_editar_padron','Me Permite Editar Datos del Predio de un Usuario','ACTIVO',GETDATE(),'MIGRACION'),
	(21,2,'btn_exportar_excel','Me Permite Exportar a Excel los Datos del Usuario','ACTIVO',GETDATE(),'MIGRACION')
SET IDENTITY_INSERT dbo.cat_cor_catalogo_botones OFF


-- ===========================================
-- =============  ROLES_BOTONES  ============= Listo 
-- ===========================================

SET IDENTITY_INSERT dbo.ope_cor_roles_botones ON
INSERT INTO ope_cor_roles_botones (id_roles_botones,rol_id,id_catalogo_botones)
VALUES
	(1,'00001',18),
	(2,'00001',19),
	(3,'00001',20),
	(4,'00001',21),
	(5,'00001',12),
	(6,'00001',6),
	(7,'00001',9),
	(8,'00001',10),
	(9,'00001',11),
	(10,'00001',1),
	(11,'00001',3),
	(12,'00001',4),
	(13,'00001',2),
	(14,'00001',5),
	(15,'00001',7),
	(16,'00001',8),
	(17,'00001',14),
	(18,'00001',17),
	(19,'00001',15),
	(20,'00001',13),
	(21,'00001',16)
SET IDENTITY_INSERT dbo.ope_cor_roles_botones OFF


-- ===========================================
-- ==========  EMPLEADOS_FUNCIONES  ========== Listo
-- ===========================================

SET IDENTITY_INSERT dbo.Cat_Cor_Empleados_Funciones ON
INSERT INTO Cat_Cor_Empleados_Funciones (empleado_funciones_id,empleado_id,funcion_id,usuario_modifico,fecha_modifico,no_funcion)
VALUES
	(23,'0000000001','00001','MIGRACION',GETDATE(),NULL),
	(22,'0000000002','00001','MIGRACION',GETDATE(),1),
	(14,'0000000003','00002','MIGRACION',GETDATE(),NULL),
	(10,'0000000003','00003','MIGRACION',GETDATE(),1),
	(25,'0000000009','00001','MIGRACION',GETDATE(),NULL),
	(31,'0000000018','00001','MIGRACION',GETDATE(),NULL),
	(24,'0000000028','00001','MIGRACION',GETDATE(),NULL),
	(32,'0000000028','00002','MIGRACION',GETDATE(),NULL)
SET IDENTITY_INSERT dbo.Cat_Cor_Empleados_Funciones OFF

	
-- ===========================================
-- ======  ENCRIPTACION PASS EMPLEADOS  ====== Listo
-- ===========================================

--UPDATE CAT_EMPLEADOS SET NO_IMSS=abs(checksum(newid())) 

UPDATE CAT_EMPLEADOS SET PASSWORD = ENCRYPTBYPASSPHRASE(NO_IMSS, 
	CONVERT(VARCHAR(21), CONVERT(VARCHAR, PASSWORD))) --WHERE EMPLEADO_ID <> '0000000028'

--UPDATE CAT_EMPLEADOS set ROL_ID='00001'

--UPDATE CAT_EMPLEADOS SET PASSWORD = 'Passw0rd' WHERE EMPLEADO_ID = '0000000028'


-- ============================================
-- ================  FORMATOS  ================ Listo
-- ============================================

INSERT INTO OPE_COR_FORMATOS (Formato_ID,Nombre,Letra_Generales,Estilo_Generales,Tamaño_Generales,Usuario_Creo,Fecha_Creo)
VALUES ('00001','ReciboSM','Arial','Negrita',7,'MIGRACION',GETDATE())


-- ============================================
-- ===========  FORMATOS DETALLES  ============ Listo
-- ============================================

INSERT INTO OPE_COR_FORMATOS_DETALLES
VALUES
	('00001','Letras_Pequenas_Negritas','00001',10,1,1.0,'Arial Narrow','Negrita',	6),
	('00002','Letras_Pequenas',			'00001',10,1,1.0,'Arial Narrow','Normal',	6),
	('00003','Letras_Medianas_Negritas','00001',10,1,1.0,'Arial Narrow','Negrita',	8),
	('00004','Letras_Medianas',			'00001',10,1,1.0,'Arial Narrow','Normal',	8),
	('00005','Letras_Grandes_Negritas',	'00001',10,1,1.0,'Arial Narrow','Negrita',	10),
	('00006','Letras_Grandes',			'00001',10,1,1.0,'Arial Narrow','Normal',	10),
	('00007','Letras_Pequenas_Negritas','00001',10,1,1.0,'Arial Narrow','Negrita',	7),
	('00008','Letras_Pequenas',			'00001',10,1,1.0,'Arial Narrow','Normal',	7)
	
	
-- ============================================
-- ============  FORMATOS CAMPOS  ============= Listo
-- ============================================

--SELECT * FROM Simapag.dbo.OPE_COR_FORMATOS_CAMPOS

INSERT INTO OPE_COR_FORMATOS_CAMPOS
VALUES
	('00001','00005','00001','RPU_Arriba',11.0,1.5,10,'General','String'),
	('00002','00003','00001','RPU_Abajo',3.9,19.7,10,'General','String'),
	('00003','00005','00001','No_Cuenta_Arriba',11.2,1.9,10,'General','String'),
	('00004','00003','00001','No_Cuenta_Abajo',7.1,19.7,10,'General','String'),
	('00005','00001','00001','Nombre_Fecha_Limite_Pago',11.3,18.4,10,'General','String'),
	('00007','00003','00001','Usuario_Arriba',0.6,2.4,10,'General','String'),
	('00008','00001','00001','Usuario_Abajo',3.4,18.2,10,'General','String'),
	('00009','00003','00001','Colonia_Arriba',0.6,3.3,10,'General','String'),
	('00010','00002','00001','Colonia_Abajo',3.4,19.0,10,'General','String'),
	('00011','00003','00001','Direccion_Arriba',0.6,2.9,10,'General','String'),
	('00012','00002','00001','Direccion_Abajo',3.4,18.7,10,'General','String'),
	('00013','00002','00001','Codigo_Barras',4.5,20.0,10,'General','String'),
	('00014','00003','00001','Meses_Adeudo',13.0,12.5,10,'General','Int'),
	('00015','00003','00001','Adeudo',13.0,13.0,10,'General','Numerico'),
	('00016','00003','00001','Saldo_Favor',13.0,13.6,10,'General','Numerico'),
	('00017','00004','00001','Fecha_Emision',13.7,10.0,10,'General','Fecha'),
	('00018','00004','00001','Periodo_Facturacion',13.7,10.3,10,'General','String'),
	('00020','00004','00001','NO_MEDIDOR',10.7,2.4,10,'General','String'),
	('00021','00003','00001','Lectura_Anterior',6.1,9.8,10,'General','Int'),
	('00022','00003','00001','Lectura_Actual',6.1,10.1,10,'General','Int'),
	('00023','00003','00001','Consumo',6.1,10.4,10,'General','Int'),
	('00024','00004','00001','Fecha_Limite_Pago_Arriba',13.7,10.7,10,'General','Fecha'),
	('00025','00002','00001','Fecha_Limite_Pago_Abajo',13.0,18.8,10,'General','Fecha'),
	('00026','00004','00001','Mes_Facturado',12.3,9.5,10,'General','String'),
	('00027','00005','00001','Total_Mes',6.2,8.6,10,'General','Numerico'),
	('00028','00005','00001','Total_Pagar_Arriba',13.0,14.4,10,'General','Numerico'),
	('00029','00003','00001','Total_Pagar_Abajo',13.0,20.6,10,'General','Numerico'),
	('00030','00001','00001','Tipo_Recibo',5.5,90.0,10,'General','String'),
	('00031','00002','00001','Numero_Codigo_Barras',5.5,21.4,10,'General','String'),
	('00032','00005','00001','Nombre_RPU_Arriba',9.1,1.5,10,'General','String'),
	('00033','00003','00001','Nombre_RPU_Abajo',4.5,19.4,10,'General','String'),
	('00034','00005','00001','Nombre_Cuenta_Arriba',9.1,1.9,10,'General','String'),
	('00035','00003','00001','Nombre_Cuenta_Abajo',7.3,19.4,10,'General','String'),
	('00036','00003','00001','Nombre_Medidor',9.2,2.4,10,'General','String'),
	('00037','00003','00001','Nombre_Envio',12.1,2.4,10,'General','String'),
	('00038','00003','00001','Nombre_Tarifa',9.0,2.9,10,'General','String'),
	('00039','00003','00001','Nombre_Conceptos_Titulos',1.8,3.7,10,'General','String'),
	('00040','00008','00001','Nombre_Conceptos',0.8,5.7,10,'General','String'),
	('00041','00005','00001','Nombre_Total_Mes',1.0,8.6,10,'General','String'),
	('00042','00003','00001','Nombre_Datos_Fiscales_Uno',0.7,9.9,10,'General','String'),
	('00043','00003','00001','Nombre_Datos_Fiscales_Dos',6.8,10.2,10,'General','String'),
	('00044','00003','00001','Nombre_Datos_Fiscales_Tres',3.4,11.2,10,'General','String'),
	('00045','00003','00001','Nombre_Meses_Adeudo',10.4,12.0,10,'General','String'),
	('00046','00003','00001','Nombre_Adeudo_Anterior',10.4,12.6,10,'General','String'),
	('00047','00003','00001','Nombre_Saldo_Favor',10.8,13.3,10,'General','String'),
	('00048','00005','00001','Nombre_Total_Pagar_Arriba',10.5,14.0,10,'General','String'),
	('00049','00003','00001','Nombre_Total_Pagar_Abajo',11.3,20.3,10,'General','String'),
	('00050','00001','00001','Grafica',7.0,4.4,10,'General','String'),
	('00051','00008','00001','Conceptos',6.2,5.7,10,'General','String'),
	('00052','00004','00001','Codigo_Telecomm',13.7,11.4,10,'General','Int'),
	('00053','00004','00001','Fecha_Corte',13.7,11.0,10,'General','Fecha'),
	('00054','00002','00001','Aviso1',5.0,13.6,10,'General','String'),
	('00055','00003','00001','Aviso2',5.0,15.0,10,'General','String'),
	('00056','00005','00001','Nombre_Aviso',4.0,12.7,10,'General','String'),
	('00057','00005','00001','Nombre_Grafica',8.8,4.0,10,'General','String'),
	('00058','00008','00001','Datos_Fiscales',1.0,12.0,10,'General','String')


-- ============================================================================ --
-- ==========================  P A R A M E T R O S  =========================== -- listo
-- ============================================================================ --

INSERT INTO Cat_Cor_Parametros SELECT * FROM Simapag.dbo.Cat_Cor_Parametros
--VALUES 
--	 --Parametro_ID						--Porcentaje_IVa						--Porcentaje_Drenaje
--	('00001',							16,										20,	
--	 --Porcentaje_Saneamiento			--Ruta_Archivos_Lecturas				--Ruta_Archivo_Rutas
--	 14,								'RUTAS-LECTURAS\LECTURAS',				'RUTAS-LECTURAS\RUTAS',
--	 --Dias_Notificacion				--Porcentaje_Pago_Notificacion			--Tipo_Falla_Corte_ID
--	 5,									NULL,									'00006',
--	 --Tipo_Falla_Inspeccion_ID			--Usuario_Creo							--Fecha_Creo
--	 '00014',							'MIGRACION',							GETDATE(),
--	 --Usuario_Modifico					--Fecha_Modifico						--Porcentaje_Minimo_Pago_Parcial
--	 NULL,								NULL,									NULL,
--	 --Tipo_Falla_Reconexion			--Tipo_Falla_Reconexion_Cuadrilla		--Monto_Notificacion_Sfirma
--	 '00023',							'00024',								NULL,
--	 --Tipo_Falla_Suspension_Voluntaria	--Ruta_Imagenes							--Url_Imagenes
--	 NULL,								NULL,									NULL,
--	 --Usar_Fecha_Vencimiento			--Maximo_Meses_Adeudo					--Calculo_Recargos_Pozo_Propio
--	 NULL,								NULL,									NULL,
--	 --Tipo_Falla_Bacheo_ID				--Tipo_Falla_Escombro_ID				--Concepto_Rezagos_ID
--	 NULL,								NULL,									NULL,
--	 --Porcentaje_Solo_Drenaje			--Verificacion_Tecnica_ID				--Porcentaje_Minimo_Convenio_Pago_Inicial
--	 NULL,								NULL,									20,
--	 --Fecha_Inicio_Facturacion_Anual	--Limite_Anios_Cobro_Recargos			--Cantidad_Pego_Relevante
--	 NULL,								NULL,									10000.00,
--	 --Dia_Pago_Facturacion				--Conceptos_Recargos					--Concepto_Rezago
--	 NULL,								NULL,									NULL,
--	 --Cuenta_Organismo					--Operacion_Caja_Iusa_ID				--Operacion_Caja_Iusa_Local_ID
--	 NULL,								NULL,									NULL,
--	 --Porcentaje_Sugerido_Pago_Inicial	--Servicio_Corte_ID						--Fuente_Financiamiento_ID
--	 10,								NULL,									NULL,
--	 --Proyecto_Programa_ID				--Dependencia_ID						--Banco_ID
--	 NULL,								NULL,									NULL,
--	 --SMGV								--Pago_Cie								--Afectar_Presupuesto
--	 NULL,								NULL,									NULL,
--	 --Reportes_Cajas_Elaboro			--Reportes_Cajas_Reviso					--Reportes_Cajas_Vobo
--	 NULL,								NULL,									NULL,
--	 --Url_Imagen_Archivos				--Ruta_Imagen_Archivos					--Cuenta_Contable_Caja
--	 NULL,								'c:\\Expediente_electronico\\',			NULL,
--	 --Concepto_Poliza_Contable			--Concepto_Poliza_Presupestal			--Concepto_Agua
--	 NULL,								NULL,									'00001',
--	 --Concepto_Drenaje					--Concepto_Saneamiento					--Concepto_IVA
--	 '00002',							'00003',								'00014',
--	 --Concepto_Redondeo				--Concepto_Redondeo_Anterior|			--Porcentaje_Interes
--	 '00013',							'00155',								1.00,
--	 --Maximo_Mensualidades				--Concepto_Anticipo						--Concepto_Convenio
--	 12,								NULL,									NULL,
--	 --Caja_Internet_ID					--Cajero_Internet_ID					--Sucursal_Internet_ID
--	 NULL,								NULL,									NULL,
--	 --Concepto_Cruz_Roja				--Concepto_Bomberos						--Meses_Adeudo_Para_Congelar
--	 '00011',							'00012',								6,
--	 --Concepto_Reconexion_Susp_Linea	--Concepto_Reconexion_Susp_Cuadro		--Salario_Minimo
--	 '00105',							'00104',								NULL,
--	 --Porcentaje_Interes_Vencidos		--Tips_Falla_Corte_Efectivo_ID			--Concepto_Factibilidad
--	 2.00,								'00005',								NULL,
--	 --Concepto_Agua_Anticipo_ID		--Concepto_Drenaje_Anticipo_ID			--Concepto_Saneamiento_Anticipo_ID
--	 '00015',							'00016',								'00017',
--	 --Factor_Desglose_Anticipo_Dom		--Factor_Desglose_Anticipo_Com			--Concepto_Recargo_Agua_ID
--	 1.3944,							1.3249,									'00007',
--	 --Concepto_Recargo_Drenaje_ID		--Concepto_Recargo_Saneamiento_ID		--Concepto_Agua_Comercial
--	 '00008',							'00009',								'00010',
--	 --Concepto_Descuento_Empleados		--Porcentaje_Descuento_Empleados		--No_Intentos_acceso
--	 NULL,								80,										6,
--	 --No_Bloqueos_Temporales			--Minutos_Bloqueo_Temporal				--Concepto_Iva_Anticipo
--	 5,									456,									'00159',
--	 --Concepto_Descuento_Agua_Emple_ID	--Concepto_Descuento_Drenaje_Emple_ID	--Concepto_Descuento_Saneamiento_Emple_ID
--	 '00160',							'00161',								'00162',
--	 --Concepto_Rezago_Agua_ID			--Concepto_Rezago_Drenaje_ID			--Concepto_Rezago_Saneamiento
--	 '00004',							'00005',								'00006',
--	 --Porcentaje_Recargos				--Ruta_Pagina_Facturacion				
--	 2,									'http://172.16.0.97/SIAC_SIMAPAG_FE/Paginas/Paginas_Generales/Frm_Facturacion.aspx',
--	 --Concepto_interes_Saldo_Insoluto	--Concepto_Interes_Pagos_Varios			--Concepto_Descuento_Recargo_Agua
--	 '00143',							'00142',								'00163',
--	 --Concepto_Descuento_Recargos_Dren	--Descuento_Recargos_Saneamiento		--PrecioM3_Por_Alumno
--	 '00164',							'00165',								0.44,
--	 --Concepto_Material_ID
--	 '00138')

--DELETE from Cat_Cor_Parametros
--GO	
--SELECT * FROM Simapag.dbo.Cat_Cor_Parametros


-- ========================================================
-- ================  AGREGAR CAMPOS TEMP  ================= Listo
-- ========================================================

ALTER TABLE Ope_Cor_Facturacion_Recibos_Detalles
ADD Temp_Folio varchar(20) null

ALTER TABLE Ope_Cor_Caj_Movimientos_Cobros
ADD Temp_Folio varchar(20) null

-- SCRIPT DE RELACION DE TABLAS RECIBOS_COBROS -- MOVIMIENTOS_COBROS ------------

-------------------------------------------------------------------------------------------------

--=================================================
--				MIGRAR CONVENIOS!!
--=================================================

--------------------------------------------------------------------------------------------------------------






----- EJECUTAR APLICACION DE MIGRACION ----------------------------------------------------




--------------------------------------------------------------------------------------------------------------
--======================= R E L A C I O N - D E - P A G O S  ==========================--

UPDATE Ope_Cor_Caj_Movimientos_Cobros SET NO_RECIBO =  
(SELECT top 1 no_recibo from Ope_Cor_Caj_Recibos_Cobros where NO_FACTURA = Ope_Cor_Caj_Movimientos_Cobros.COMENTARIOS)
WHERE NO_RECIBO is null
		
UPDATE Ope_Cor_Caj_Movimientos_Cobros SET No_Movimiento_Facturacion = 
(SELECT TOP 1 No_Movimiento FROM Ope_Cor_Facturacion_Recibos_Detalles WHERE Concepto_ID =
	Ope_Cor_Caj_Movimientos_Cobros.CONCEPTO_ID AND temp_folio = 
		Ope_Cor_Caj_Movimientos_Cobros.Temp_Folio)
WHERE No_Movimiento_Facturacion is null
		
		
--- COMPROBACION ENLACE DE DETALLES ---
--SELECT DISTINCT CONCEPTO_ID FROM Ope_Cor_Caj_Movimientos_Cobros 
--	WHERE No_Movimiento_Facturacion IS NULL --AND USUARIO_CREO = 'migracion caso 2'


-- ========================= ACTUALIZA PERIODO DE RECIBOS COBROS =============================== --

UPDATE Ope_Cor_Caj_Recibos_Cobros SET periodo = (
SELECT
    right(min(LTRIM(Anio) + RIGHT('00' + Ltrim(Rtrim(Bimestre)),2)),2) + ' ' +left(min(LTRIM(Anio) + RIGHT('00' + Ltrim(Rtrim(Bimestre)),2)),4)  + ' - ' + 
    right(max(LTRIM(Anio) + RIGHT('00' + Ltrim(Rtrim(Bimestre)),2)),2) + ' ' +left(max(LTRIM(Anio) + RIGHT('00' + Ltrim(Rtrim(Bimestre)),2)),4)
FROM Ope_Cor_Facturacion_Recibos_Detalles
WHERE No_Movimiento IN (SELECT
    No_Movimiento_Facturacion
FROM Ope_Cor_Caj_Movimientos_Cobros
WHERE NO_RECIBO = Ope_Cor_Caj_Recibos_Cobros.NO_RECIBO)
) 
--WHERE USUARIO_CREO = 'MIGRACION CASO 2'


-- =====================  CAMBIA LA FECHA DE LA FACTURA ANTERIOR ( 2 FACTURAS )  ======================== --

UPDATE Ope_Cor_Facturacion_Recibos SET Fecha_Inicio_Periodo = DATEADD(MONTH,-1,Fecha_Inicio_Periodo) WHERE No_Recibo LIKE '%A'
UPDATE Ope_Cor_Facturacion_Recibos SET Fecha_Limite_Pago = DATEADD(MONTH,-1,Fecha_Limite_Pago) WHERE No_Recibo LIKE '%A'
UPDATE Ope_Cor_Facturacion_Recibos SET Fecha_Emision = DATEADD(MONTH,-1,Fecha_Emision) WHERE No_Recibo LIKE '%A'


-- ================================  ACTUALIZA CONCEPTOS ACTUALES  ====================================== --

UPDATE Ope_Cor_Facturacion_Recibos_Detalles SET Concepto = 'CONSUMO AGUA'
WHERE No_Factura_Recibo IN
(SELECT R.No_Factura_Recibo FROM Ope_Cor_Facturacion_Recibos R
	JOIN (SELECT RPU ,MAX(Fecha_Emision) fecha
		FROM Ope_Cor_Facturacion_Recibos
		GROUP BY RPU) R2
	ON R.RPU = R2.RPU AND R.Fecha_Emision = R2.fecha)
AND Concepto_ID = '00004' AND Impuesto = 0

UPDATE Ope_Cor_Facturacion_Recibos_Detalles SET Concepto_ID = '00001'
WHERE No_Factura_Recibo IN
(SELECT R.No_Factura_Recibo FROM Ope_Cor_Facturacion_Recibos R
	JOIN (SELECT RPU ,MAX(Fecha_Emision) fecha
		FROM Ope_Cor_Facturacion_Recibos
		GROUP BY RPU) R2
	ON R.RPU = R2.RPU AND R.Fecha_Emision = R2.fecha)
AND Concepto_ID = '00004' AND Impuesto = 0

UPDATE Ope_Cor_Facturacion_Recibos_Detalles SET Concepto = 'DRENAJE' 
WHERE No_Factura_Recibo IN
(SELECT R.No_Factura_Recibo FROM Ope_Cor_Facturacion_Recibos R
	JOIN (SELECT RPU ,MAX(Fecha_Emision) fecha
		FROM Ope_Cor_Facturacion_Recibos
		GROUP BY RPU) R2
	ON R.RPU = R2.RPU AND R.Fecha_Emision = R2.fecha)
AND Concepto_ID = '00005'

UPDATE Ope_Cor_Facturacion_Recibos_Detalles SET Concepto_ID = '00002' 
WHERE No_Factura_Recibo IN
(SELECT R.No_Factura_Recibo FROM Ope_Cor_Facturacion_Recibos R
	JOIN (SELECT RPU ,MAX(Fecha_Emision) fecha
		FROM Ope_Cor_Facturacion_Recibos
		GROUP BY RPU) R2
	ON R.RPU = R2.RPU AND R.Fecha_Emision = R2.fecha)
AND Concepto_ID = '00005'

UPDATE Ope_Cor_Facturacion_Recibos_Detalles SET Concepto = 'SANEAMIENTO'
WHERE No_Factura_Recibo IN
(SELECT R.No_Factura_Recibo FROM Ope_Cor_Facturacion_Recibos R
	JOIN (SELECT RPU ,MAX(Fecha_Emision) fecha
		FROM Ope_Cor_Facturacion_Recibos
		GROUP BY RPU) R2
	ON R.RPU = R2.RPU AND R.Fecha_Emision = R2.fecha)
AND Concepto_ID = '00006'

UPDATE Ope_Cor_Facturacion_Recibos_Detalles SET Concepto_ID = '00003'
WHERE No_Factura_Recibo IN
(SELECT R.No_Factura_Recibo FROM Ope_Cor_Facturacion_Recibos R
	JOIN (SELECT RPU ,MAX(Fecha_Emision) fecha
		FROM Ope_Cor_Facturacion_Recibos
		GROUP BY RPU) R2
	ON R.RPU = R2.RPU AND R.Fecha_Emision = R2.fecha)
AND Concepto_ID = '00006'

UPDATE Ope_Cor_Facturacion_Recibos_Detalles SET Concepto = 'AGUA COMERCIAL'
WHERE No_Factura_Recibo IN
(SELECT R.No_Factura_Recibo FROM Ope_Cor_Facturacion_Recibos R
	JOIN (SELECT RPU ,MAX(Fecha_Emision) fecha
		FROM Ope_Cor_Facturacion_Recibos
		GROUP BY RPU) R2
	ON R.RPU = R2.RPU AND R.Fecha_Emision = R2.fecha)
AND Concepto_ID = '00004' AND Impuesto > 0

UPDATE Ope_Cor_Facturacion_Recibos_Detalles SET Concepto_ID = '00010'
WHERE No_Factura_Recibo IN
(SELECT R.No_Factura_Recibo FROM Ope_Cor_Facturacion_Recibos R
	JOIN (SELECT RPU ,MAX(Fecha_Emision) fecha
		FROM Ope_Cor_Facturacion_Recibos
		GROUP BY RPU) R2
	ON R.RPU = R2.RPU AND R.Fecha_Emision = R2.fecha)
AND Concepto_ID = '00004' AND Impuesto > 0


-- ==================================  DETALLES PAGADOS  ======================================= --

UPDATE Ope_Cor_Facturacion_Recibos_Detalles SET Estatus = 'PAGADO' WHERE Total_Saldo = 0


-- ================================ BORRA CAMPOS TEMPORALES ==================================== --

ALTER TABLE Ope_Cor_Facturacion_Recibos_Detalles
DROP COLUMN temp_folio
ALTER TABLE Ope_Cor_Caj_Movimientos_Cobros
DROP COLUMN temp_folio


-- ============================ ACTUALIZACION DE RUTA REPARTO ID =============================== --

UPDATE Ope_Cor_Facturacion_Recibos SET Ruta_Reparto_ID = 
(SELECT Ruta_Reparto_ID FROM Cat_Cor_Predios WHERE RPU = Ope_Cor_Facturacion_Recibos.RPU)

-- ================================= BORRA FOLIOS DE SIMAPAG ================================= --

--UPDATE Ope_Cor_Facturacion_Recibos SET No_Recibo = ''
--UPDATE Ope_Cor_Caj_Recibos_Cobros SET NO_FACTURA = ''
----UPDATE Ope_Cor_Caj_Movimientos_Cobros SET COMENTARIOS = ''


-- ==================== COMPROBACION SALDO CRBOMB - ELIMINA SALDO CRBOMB ======================= --

--SELECT * FROM Ope_Cor_Facturacion_Recibos_Detalles 
--WHERE (Concepto_ID = '00011' OR Concepto_ID = '00012') AND Total_Saldo>0 AND Estatus = 'PAGADO'

UPDATE Ope_Cor_Facturacion_Recibos_Detalles SET Total_Saldo = 0 
WHERE (Concepto_ID = '00011' OR Concepto_ID = '00012') AND Total_Saldo >= 1 AND Estatus = 'pagado'


-- ============================================================================================= --

-- IGNORAR ESTO -- 
-- COMPROBACION DE RELACION PAGOS ANTIGUO --

--SELECT no_movimiento,CONCEPTO_ID,COMENTARIOS,
--(SELECT No_Movimiento from Ope_Cor_Facturacion_Recibos_Detalles where Concepto_ID = Ope_Cor_Caj_Movimientos_Cobros.CONCEPTO_ID
--	AND No_Factura_Recibo =
--	(SELECT TOP 1 No_Factura_Recibo from Ope_Cor_Facturacion_Recibos 
--		where No_Recibo = Ope_Cor_Caj_Movimientos_Cobros.COMENTARIOS)) as movimiento,
--(SELECT top 1 Concepto_ID from Ope_Cor_Facturacion_Recibos_Detalles 
--	where Concepto_ID = Ope_Cor_Caj_Movimientos_Cobros.CONCEPTO_ID) as concepto_id,
--(SELECT TOP 1 No_Factura_Recibo from Ope_Cor_Facturacion_Recibos 
--		where No_Recibo = Ope_Cor_Caj_Movimientos_Cobros.COMENTARIOS) as no_factura
--from Ope_Cor_Caj_Movimientos_Cobros




-- ***************************** RECORDAR EJECUTAR DESPUES DE FACTURACION *******************************
-- DETALLES DIVEROS
-- DIVERSO - EFECTIVO
-- DIVERSO - NO EFECTIVO
-- MIGRACION CORTES
-- MIGRACION INSPECCIONES
-- RECIBOS
-- HIS_RECIBOS
-- REINDEXAR
-- 2 TRIGGERS
			

INSERT INTO Cat_Cor_Tipo_Identificacion
(descripcion,usuarioCreo,fechaCreo,estatus)
VALUES('CREDENCIAL DEL INE','MIGRACION',GETDATE(),'ACTIVO')

INSERT INTO Cat_Cor_Tipo_Identificacion
(descripcion,usuarioCreo,fechaCreo,estatus)
VALUES('PASAPORTE','MIGRACION',GETDATE(),'ACTIVO')


INSERT INTO Cat_Cor_Tipo_Identificacion
(descripcion,usuarioCreo,fechaCreo,estatus)
VALUES('CARTILLA MILITAR','MIGRACION',GETDATE(),'ACTIVO')

INSERT INTO Cat_Cor_Tipo_Identificacion
(descripcion,usuarioCreo,fechaCreo,estatus)
VALUES('LICENCIA DE MANEJO','MIGRACION',GETDATE(),'ACTIVO')

	-----------------------no se ejecuto		
UPDATE Ope_Cor_Facturacion_Recibos
SET Medidor_Detalle_ID = (SELECT TOP 1 Medidor_Detalle_ID FROM Cat_Cor_Medidores_Lecturas_Detalles WHERE Predio_ID = Ope_Cor_Facturacion_Recibos.Predio_ID
 AND Anio = Ope_Cor_Facturacion_Recibos.Anio AND Bimestre = Ope_Cor_Facturacion_Recibos.Bimestre)
----